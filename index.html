    <!DOCTYPE html>
    <html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Labubu TBB Game - –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <style>
            .notification-enter {
                animation: slideInRight 0.3s ease-out;
            }
            .notification-exit {
                animation: fadeOut 0.3s ease-out;
            }
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
            .pet-bounce {
                animation: bounce 2s infinite;
            }
            .pet-sleep {
                animation: pulse 2s infinite;
            }
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
        </style>
    </head>
    <body class="bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen">

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notifications" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã -->
    <div class="max-w-lg mx-auto bg-gradient-to-b from-pink-100 to-purple-100 rounded-xl p-4 shadow-lg min-h-screen">
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –ø–æ–≥–æ–¥–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º -->
        <div class="text-center mb-4">
            <div class="flex justify-between items-center mb-2">
                <div class="text-sm" id="timeOfDay">‚òÄÔ∏è</div>
                <div class="text-center">
                    <h1 class="text-xl font-bold text-purple-800">üê∞ <span id="petNameDisplay">Labubu</span> Care</h1>
                    <div id="nameEditSection" class="hidden mt-2">
                        <input type="text" id="nameInput" class="text-sm px-2 py-1 border rounded" maxlength="15">
                        <div class="mt-1">
                            <button id="saveNameBtn" class="text-xs bg-blue-500 text-white px-2 py-1 rounded mr-1">‚úì</button>
                            <button id="cancelNameBtn" class="text-xs bg-gray-500 text-white px-2 py-1 rounded">‚úï</button>
                        </div>
                    </div>
                    <button id="editNameBtn" class="text-xs text-purple-600 hover:text-purple-800 mt-1">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è</button>
                </div>
                <div class="text-sm" id="weather">‚òÄÔ∏è</div>
            </div>
            <div class="flex justify-between text-xs">
                <span id="levelDisplay">Lv.1</span>
                <span id="moneyDisplay">üí∞100</span>
                <span id="expDisplay">‚≠ê0/100</span>
                <span id="ageDisplay">üéÇ0–¥</span>
                <button id="soundToggle" class="text-xs">üîä</button>
            </div>
            <div id="collaboratorsInfo" class="text-xs text-purple-600 mt-1 hidden"></div>
        </div>

        <!-- –ü–µ—Ä—Å–æ–Ω–∞–∂ Labubu —Å –∫—Ä–∞—Å–∏–≤–æ–π —Ä–∞–º–∫–æ–π —Å—Ç–∞—Ç—É—Å–∞ -->
        <div class="text-center mb-4 bg-white rounded-lg p-6 shadow" id="petContainer">
            <!-- –°—Ç–∞—Ç—É—Å –∏ —Ä–∞–º–∫–∞ -->
            <div class="mb-2" id="statusDisplay">
                <div class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold" id="statusBadge">
                    <span id="statusEmoji">üå±</span>
                    <span id="statusName" class="ml-1">–ù–æ–≤–∏—á–æ–∫</span>
                </div>
            </div>
            
            <div class="mb-4 relative inline-block" id="petFrame">
                <img id="petImage" src="https://i.pinimg.com/474x/49/b9/bc/49b9bc9d7961d675e91a963b192c16a9.jpg" alt="Labubu" class="w-32 h-32 mx-auto object-contain rounded-lg">
                
                <!-- –û–¥–µ–∂–¥–∞ -->
                <div class="absolute inset-0" id="outfitContainer"></div>
                
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã -->
                <div id="sleepIndicator" class="absolute -top-2 -right-2 text-lg animate-pulse hidden">üí§</div>
                <div id="moodIndicator" class="absolute -top-1 -left-1 text-sm"></div>
                <div id="criticalIndicator" class="absolute inset-0 bg-red-500 bg-opacity-20 rounded-full animate-pulse hidden"></div>
                
                <!-- –≠—Ñ—Ñ–µ–∫—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è -->
                <div id="eventEffect" class="absolute -inset-2 rounded-lg hidden"></div>
            </div>
            
            <div class="text-2xl mb-2" id="moodEmoji">üòä</div>
            <div class="text-sm text-gray-600 font-medium" id="moodStatus">–°—á–∞—Å—Ç–ª–∏–≤</div>
            <div class="text-xs text-purple-600 mt-1" id="evolutionStage">–ú–∞–ª—ã—à</div>
            <div id="currentOutfit" class="text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full mt-2 inline-block hidden"></div>
            <div class="text-xs text-gray-500 mt-1">üéÇ –í–æ–∑—Ä–∞—Å—Ç: <span id="ageText">0</span> –¥–Ω–µ–π</div>
            
            <!-- –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ -->
            <div id="activeEventDisplay" class="hidden mt-2 p-2 bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg border border-purple-300">
                <div class="text-xs font-bold text-purple-800">üé™ –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:</div>
                <div class="text-xs text-purple-700" id="activeEventText"></div>
            </div>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div id="gameMessage" class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-3 py-2 rounded mb-3 text-center text-xs hidden"></div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div class="mb-4 bg-white rounded-lg p-3 shadow">
            <div id="statsContainer"></div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="mb-3 bg-white rounded-lg p-1 shadow text-xs">
            <div class="grid grid-cols-5 gap-1 mb-1">
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors bg-purple-500 text-white whitespace-nowrap" data-tab="care">üîß –£—Ö–æ–¥</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="games">üéÆ –ò–≥—Ä—ã</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="shop">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="chests">üì¶ –°—É–Ω–¥—É–∫–∏</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="tasks">üìã –ó–∞–¥–∞–Ω–∏—è</button>
            </div>
            <div class="grid grid-cols-5 gap-1">
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="pets">üê∞ –ü–∏—Ç–æ–º—Ü—ã</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="friends">üë• –î—Ä—É–∑—å—è</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="achievements">üèÜ –ù–∞–≥—Ä–∞–¥—ã</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="status">üìä –°—Ç–∞—Ç—É—Å—ã</button>
                <button class="tab-btn py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap" data-tab="info">‚ÑπÔ∏è –ò–Ω—Ñ–æ</button>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        <div id="tabContent"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª –º–∏–Ω–∏-–∏–≥—Ä—ã -->
    <div id="miniGameModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4 max-h-96 overflow-y-auto">
            <h3 id="gameTitle" class="text-lg font-bold mb-4"></h3>
            <div id="gameContent"></div>
            <button id="cancelGameBtn" class="mt-4 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded w-full transition-colors">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <script>
    class LabubuCareGame {
        constructor() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–æ–π—Å—Ç–≤ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            this.stats = {
                hunger: 100, happiness: 100, cleanliness: 100,
                health: 100, energy: 100, sleep: 100
            };
            this.evolutionStages = {
                baby: { name: '–ú–∞–ª—ã—à', minAge: 0 },
                child: { name: '–†–µ–±–µ–Ω–æ–∫', minAge: 7 },
                teen: { name: '–ü–æ–¥—Ä–æ—Å—Ç–æ–∫', minAge: 30 },
                adult: { name: '–í–∑—Ä–æ—Å–ª—ã–π', minAge: 60 },
                elder: { name: '–ú—É–¥—Ä–µ—Ü', minAge: 100 }
            };
            this.skins = {
                default: { 
                    name: '–ë–∞–∑–æ–≤—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'common', 
                    chance: 50, 
                    image: 'https://i.ebayimg.com/images/g/yVoAAOSwiqJnxCvP/s-l1600.jpg',
                    color: '#DEB887'
                }
            };
            this.outfits = {
                default: { name: '–û–±—ã—á–Ω–∞—è –æ–¥–µ–∂–¥–∞', price: 0, emoji: 'üëï', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å' }
            };
            this.currentSkin = 'default';
            this.outfit = 'default';
            this.evolutionStage = 'baby';
            this.petName = 'Labubu';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            this.food = [
                { name: '–ü–µ—á–µ–Ω—å–µ', hunger: 20, price: 20, emoji: 'üç™', happiness: 5 },
                { name: '–§—Ä—É–∫—Ç—ã', hunger: 30, price: 35, emoji: 'üçé', health: 5 },
                { name: '–°—É—à–∏', hunger: 50, price: 65, emoji: 'üç£', happiness: 10 },
                { name: '–¢–æ—Ä—Ç', hunger: 40, happiness: 15, price: 75, emoji: 'üç∞' },
                { name: '–ú–æ—Ä–æ–∂–µ–Ω–æ–µ', hunger: 25, happiness: 20, price: 45, emoji: 'üç¶' },
                { name: '–ü–∏—Ü—Ü–∞', hunger: 60, price: 80, emoji: 'üçï', happiness: 10 },
                { name: '–í–∏—Ç–∞–º–∏–Ω—ã', health: 30, price: 95, emoji: 'üíä' },
                { name: '–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫', energy: 40, price: 55, emoji: '‚ö°' },
                { name: '–ë—É—Ä–≥–µ—Ä', hunger: 45, price: 50, emoji: 'üçî', happiness: 8 },
                { name: '–†—ã–±–∞', hunger: 35, health: 10, price: 45, emoji: 'üêü' },
                { name: '–°–∞–ª–∞—Ç', health: 15, cleanliness: 10, price: 40, emoji: 'ü•ó' },
                { name: '–ú–æ–ª–æ–∫–æ', hunger: 15, health: 8, price: 25, emoji: 'ü•õ' },
                // –ù–û–í–ê–Ø –ï–î–ê
                { name: '–®–æ–∫–æ–ª–∞–¥', hunger: 20, happiness: 25, price: 60, emoji: 'üç´' },
                { name: '–î–æ–Ω–∞—Ç', hunger: 30, happiness: 18, price: 55, emoji: 'üç©' },
                { name: '–ö—Ä—É–∞—Å—Å–∞–Ω', hunger: 35, happiness: 12, price: 70, emoji: 'ü•ê' },
                { name: '–¢–∞–∫–æ', hunger: 45, happiness: 15, price: 85, emoji: 'üåÆ' },
                { name: '–†–∞–º–µ–Ω', hunger: 55, health: 8, price: 90, emoji: 'üçú' },
                { name: '–°—Ç–µ–π–∫', hunger: 70, health: 15, price: 150, emoji: 'ü•©' },
                { name: '–õ–æ–±—Å—Ç–µ—Ä', hunger: 60, happiness: 30, price: 200, emoji: 'ü¶û' },
                { name: '–ò–∫—Ä–∞', hunger: 30, happiness: 40, price: 300, emoji: 'üç£' },
                { name: '–¢—Ä—é—Ñ–µ–ª—å', hunger: 25, happiness: 50, price: 500, emoji: 'üçÑ' },
                { name: '–≠–ª–∏–∫—Å–∏—Ä –∑–¥–æ—Ä–æ–≤—å—è', health: 50, energy: 20, price: 250, emoji: 'üß™' },
                { name: '–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –∫–∞–ø—Å—É–ª–∞', energy: 60, price: 180, emoji: 'üíä' },
                { name: '–í–æ–ª—à–µ–±–Ω–∞—è —è–≥–æ–¥–∞', hunger: 40, happiness: 30, health: 20, price: 400, emoji: 'ü´ê' },
                { name: '–ó–æ–ª–æ—Ç–æ–µ —è–±–ª–æ–∫–æ', hunger: 50, happiness: 35, health: 25, energy: 15, price: 600, emoji: 'üçé' },
                { name: '–ù–µ–∫—Ç–∞—Ä –±–æ–≥–æ–≤', hunger: 80, happiness: 60, health: 40, energy: 30, price: 1000, emoji: 'üçØ' }
            ];
            
            this.miniGames = [
                { id: 'memory', name: '–ú–µ–º–æ—Ä–∏', emoji: 'üß†', description: '–ó–∞–ø–æ–º–Ω–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', reward: { happiness: 25, experience: 20, money: 15 } },
                { id: 'reaction', name: '–†–µ–∞–∫—Ü–∏—è', emoji: '‚ö°', description: '–ù–∞–∂–º–∏ –∫–æ–≥–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è —Å–∏–≥–Ω–∞–ª', reward: { happiness: 20, experience: 15, money: 10 } },
                { id: 'math', name: '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', emoji: 'üî¢', description: '–†–µ—à–∏ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä', reward: { happiness: 30, experience: 25, money: 20 } },
                { id: 'puzzle', name: '–ü–∞–∑–ª', emoji: 'üß©', description: '–°–æ–±–µ—Ä–∏ —á–∏—Å–ª–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É', reward: { happiness: 35, experience: 30, money: 25 } },
                { id: 'quiz', name: '–í–∏–∫—Ç–æ—Ä–∏–Ω–∞', emoji: 'ü§î', description: '–û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å', reward: { happiness: 28, experience: 22, money: 18 } },
                { id: 'rhythm', name: '–†–∏—Ç–º', emoji: 'üéµ', description: '–ü–æ–≤—Ç–æ—Ä–∏ —Ä–∏—Ç–º', reward: { happiness: 40, experience: 25, money: 20 } },
                { id: 'treasure', name: '–ö–ª–∞–¥', emoji: 'üíé', description: '–ù–∞–π–¥–∏ —Å–æ–∫—Ä–æ–≤–∏—â–µ', reward: { happiness: 20, experience: 15, money: 35 } },
                { id: 'balance', name: '–ë–∞–ª–∞–Ω—Å', emoji: '‚öñÔ∏è', description: '–£–¥–µ—Ä–∂–∏ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ', reward: { happiness: 25, experience: 20, money: 15 } },
                { id: 'matching', name: '–ù–∞–π–¥–∏ –ø–∞—Ä—É', emoji: 'üÉè', description: '–ù–∞–π–¥–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏', reward: { happiness: 30, experience: 25, money: 22 } },
                { id: 'simon', name: '–°–∞–π–º–æ–Ω –≥–æ–≤–æ—Ä–∏—Ç', emoji: 'üéØ', description: '–ü–æ–≤—Ç–æ—Ä–∏ –∫–æ–º–∞–Ω–¥—ã –°–∞–π–º–æ–Ω–∞', reward: { happiness: 32, experience: 28, money: 25 } },
                { id: 'word', name: '–°–æ—Å—Ç–∞–≤—å —Å–ª–æ–≤–æ', emoji: 'üìù', description: '–°–æ—Å—Ç–∞–≤—å —Å–ª–æ–≤–æ –∏–∑ –±—É–∫–≤', reward: { happiness: 35, experience: 30, money: 28 } },
                { id: 'color', name: '–¶–≤–µ—Ç–Ω–∞—è –∏–≥—Ä–∞', emoji: 'üåà', description: '–£–≥–∞–¥–∞–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ü–≤–µ—Ç', reward: { happiness: 28, experience: 22, money: 18 } },
                { id: 'sequence', name: '–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', emoji: 'üî§', description: '–ù–∞–π–¥–∏ —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç', reward: { happiness: 33, experience: 27, money: 24 } },
                { id: 'target', name: '–ü–æ–ø–∞–¥–∏ –≤ —Ü–µ–ª—å', emoji: 'üéØ', description: '–ü–æ–ø–∞–¥–∏ –≤ –¥–≤–∏–∂—É—â—É—é—Å—è –º–∏—à–µ–Ω—å', reward: { happiness: 30, experience: 25, money: 20 } },
                { id: 'catch', name: '–ü–æ–π–º–∞–π –ø—Ä–µ–¥–º–µ—Ç', emoji: 'ü™£', description: '–ü–æ–π–º–∞–π –ø–∞–¥–∞—é—â–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã', reward: { happiness: 35, experience: 28, money: 26 } },
                { id: 'maze', name: '–õ–∞–±–∏—Ä–∏–Ω—Ç', emoji: 'üåÄ', description: '–ù–∞–π–¥–∏ –≤—ã—Ö–æ–¥ –∏–∑ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞', reward: { happiness: 40, experience: 35, money: 30 } },
                { id: 'code', name: '–í–∑–ª–æ–º–∞–π –∫–æ–¥', emoji: 'üîê', description: '–£–≥–∞–¥–∞–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥', reward: { happiness: 38, experience: 32, money: 28 } },
                { id: 'stack', name: '–°–æ–±–µ—Ä–∏ –±–∞—à–Ω—é', emoji: 'üèóÔ∏è', description: '–ü–æ—Å—Ç—Ä–æ–π –≤—ã—Å–æ–∫—É—é –±–∞—à–Ω—é', reward: { happiness: 36, experience: 30, money: 25 } },
                { id: 'speed', name: '–°–∫–æ—Ä–æ—Å—Ç—å', emoji: 'üí®', description: '–ù–∞–∂–º–∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ', reward: { happiness: 25, experience: 20, money: 15 } },
                { id: 'pattern', name: '–£–∑–æ—Ä', emoji: 'üé®', description: '–ü–æ–≤—Ç–æ—Ä–∏ —É–∑–æ—Ä', reward: { happiness: 34, experience: 28, money: 23 } }
            ];
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
            this.initializeData();
            
            // –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤ —Å—Ç–∞—Ç—É—Å–∞
            this.statusPoints = this.loadData('status_points', 0, 'number');
            
            // –ù–û–í–´–ï –°–ò–°–¢–ï–ú–´
            this.statusSystem = this.initializeStatusSystem();
            this.friendsSystem = this.initializeFriendsSystem();
            this.achievementsSystem = this.initializeAchievements();
            this.eventsSystem = this.initializeEvents();
            
            // –ó–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
            this.audioContext = null;
            this.soundEnabled = this.loadData('sound_enabled', true, 'boolean');
            
            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            this.activeTab = 'care';
            this.currentMiniGame = null;
            this.notifications = [];
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
            setTimeout(() => {
                this.updateDisplay();
            }, 50);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            this.init();
            this.startGameLoop();
            this.startNotificationTimer();
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            this.startAutoSave();
            
            // –ï—â–µ –æ–¥–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
            setTimeout(() => {
                this.updateDisplay();
                console.log('üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
            }, 1000);
        }
        
        async initializeData() {
            console.log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–µ—Ä–≤—ã–π –ª–∏ —ç—Ç–æ –∑–∞–ø—É—Å–∫
                this.isFirstTime = this.loadData('first_time_setup', true, 'boolean');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
                this.gameUserId = this.loadData('game_user_id', this.generateUserId(), 'string');
                this.telegramConnected = this.loadData('telegram_connected', false, 'boolean');
                this.telegramChatId = this.loadData('telegram_chat_id', '', 'string');
                
                // –°–∏—Å—Ç–µ–º–∞ —Ñ–æ–Ω–æ–≤ - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è backgrounds
                this.currentBackground = 'default';
                this.unlockedBackgrounds = ['default'];
                
                console.log('üíæ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...');
                
                // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ë–î
                const loadedFromDB = await this.loadFromDatabaseSync();
                
                if (loadedFromDB) {
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö');
                } else {
                    console.log('üì± –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤...');
                    
                    // –ï—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage
                    this.stats = this.loadData('shared_labubu_stats', {
                        hunger: 100, happiness: 100, cleanliness: 100,
                        health: 100, energy: 100, sleep: 100
                    });
                    
                    this.money = this.loadData('shared_labubu_money', 100, 'number');
                    this.outfit = this.loadData('shared_labubu_outfit', 'default', 'string');
                    this.level = this.loadData('shared_labubu_level', 1, 'number');
                    this.experience = this.loadData('shared_labubu_experience', 0, 'number');
                    this.age = this.loadData('shared_labubu_age', 0, 'number');
                    this.evolutionStage = this.loadData('shared_labubu_evolution', 'baby', 'string');
                    this.lastUpdate = this.loadData('shared_labubu_last_update', Date.now(), 'number');
                    this.lastNotification = this.loadData('shared_labubu_last_notification', Date.now(), 'number');
                    this.petName = this.loadData('shared_pet_name', 'Labubu', 'string');
                    this.isSleeping = this.loadData('shared_labubu_sleeping', false, 'boolean');
                    this.currentSkin = this.loadData('shared_current_skin', 'default', 'string');
                    this.unlockedSkins = this.loadData('shared_unlocked_skins', ['default']);
                    this.chestCount = this.loadData('shared_chest_count', 0, 'number');
                    this.friendsInvited = this.loadData('shared_friends_invited', 0, 'number');
                    this.lastChestLevel = this.loadData('shared_last_chest_level', 0, 'number');
                    
                    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î');
                }
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤ (–≤—Å–µ–≥–¥–∞ –∏–∑ localStorage –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
                this.pets = this.loadData('shared_labubu_pets', [
                    { 
                        id: 'pet1', 
                        name: this.petName, 
                        stats: this.stats, 
                        outfit: this.outfit, 
                        age: this.age, 
                        evolutionStage: this.evolutionStage,
                        currentSkin: this.currentSkin
                    }
                ]);
                this.activePetId = this.loadData('shared_active_pet_id', 'pet1', 'string');
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                this.validateGameData();
                
                console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:', error);
                this.resetToDefaults();
            }
            
            // –°–∏—Å—Ç–µ–º–∞ —Ñ–æ–Ω–æ–≤ –∏–≥—Ä—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π
            this.backgrounds = {
                // –û–ë–´–ß–ù–´–ï –§–û–ù–´ (Common)
                default: { name: '–û–±—ã—á–Ω—ã–π —Ñ–æ–Ω', price: 0, emoji: 'üé®', description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω', gradient: 'from-pink-100 via-purple-100 to-blue-100', rarity: 'common', chance: 0 },
                sunset: { name: '–ó–∞–∫–∞—Ç', price: 800, emoji: 'üåÖ', description: '–¢–µ–ø–ª—ã–π –∑–∞–∫–∞—Ç', gradient: 'from-orange-300 via-red-300 to-pink-300', rarity: 'common', chance: 15 },
                ocean: { name: '–û–∫–µ–∞–Ω', price: 1200, emoji: 'üåä', description: '–ì–ª—É–±–æ–∫–∏–µ –≤–æ–¥—ã', gradient: 'from-blue-300 via-cyan-300 to-teal-300', rarity: 'common', chance: 15 },
                forest: { name: '–õ–µ—Å', price: 1500, emoji: 'üå≤', description: '–ó–µ–ª–µ–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞', gradient: 'from-green-300 via-emerald-300 to-lime-300', rarity: 'common', chance: 15 },
                lavender: { name: '–õ–∞–≤–∞–Ω–¥–∞', price: 2000, emoji: 'üíú', description: '–ê—Ä–æ–º–∞—Ç–Ω—ã–µ –ø–æ–ª—è', gradient: 'from-purple-300 via-violet-300 to-indigo-300', rarity: 'common', chance: 15 },
                spring: { name: '–í–µ—Å–Ω–∞', price: 1800, emoji: 'üå±', description: '–°–≤–µ–∂–∞—è –∑–µ–ª–µ–Ω—å', gradient: 'from-lime-200 via-green-200 to-emerald-200', rarity: 'common', chance: 12 },
                winter: { name: '–ó–∏–º–∞', price: 2200, emoji: '‚ùÑÔ∏è', description: '–°–Ω–µ–∂–Ω–∞—è —Å–∫–∞–∑–∫–∞', gradient: 'from-blue-100 via-white to-gray-100', rarity: 'common', chance: 12 },
                
                // –†–ï–î–ö–ò–ï –§–û–ù–´ (Rare)
                cherry: { name: '–°–∞–∫—É—Ä–∞', price: 3500, emoji: 'üå∏', description: '–Ø–ø–æ–Ω—Å–∫–∞—è –∫—Ä–∞—Å–æ—Ç–∞', gradient: 'from-pink-300 via-rose-300 to-red-300', rarity: 'rare', chance: 12 },
                galaxy: { name: '–ì–∞–ª–∞–∫—Ç–∏–∫–∞', price: 5000, emoji: 'üåå', description: '–ó–≤–µ–∑–¥–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ—Ä—ã', gradient: 'from-purple-900 via-blue-900 to-indigo-900', rarity: 'rare', chance: 10 },
                aurora: { name: '–°–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ', price: 6000, emoji: 'üåà', description: '–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ', gradient: 'from-green-400 via-blue-400 to-purple-400', rarity: 'rare', chance: 8 },
                volcano: { name: '–í—É–ª–∫–∞–Ω', price: 7000, emoji: 'üåã', description: '–û–≥–Ω–µ–Ω–Ω–∞—è –ª–∞–≤–∞', gradient: 'from-red-600 via-orange-500 to-yellow-400', rarity: 'rare', chance: 8 },
                deep_sea: { name: '–ì–ª—É–±–∏–Ω—ã –æ–∫–µ–∞–Ω–∞', price: 7500, emoji: 'üêô', description: '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥–ª—É–±–∏–Ω—ã', gradient: 'from-blue-900 via-teal-800 to-cyan-900', rarity: 'rare', chance: 7 },
                crystal: { name: '–ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π', price: 8000, emoji: 'üíé', description: '–°–≤–µ—Ä–∫–∞—é—â–∏–µ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã', gradient: 'from-cyan-300 via-blue-300 to-purple-300', rarity: 'rare', chance: 6 },
                
                // –õ–ï–ì–ï–ù–î–ê–†–ù–´–ï –§–û–ù–´ (Legendary)
                golden: { name: '–ó–æ–ª–æ—Ç–æ–π', price: 12000, emoji: '‚ú®', description: '–†–æ—Å–∫–æ—à–Ω–æ–µ –∑–æ–ª–æ—Ç–æ', gradient: 'from-yellow-400 via-amber-400 to-orange-400', rarity: 'legendary', chance: 5 },
                rainbow: { name: '–†–∞–¥—É–∂–Ω—ã–π', price: 15000, emoji: 'üåà', description: '–í—Å–µ —Ü–≤–µ—Ç–∞ —Å–ø–µ–∫—Ç—Ä–∞', gradient: 'from-red-400 via-yellow-400 via-green-400 via-blue-400 to-purple-400', rarity: 'legendary', chance: 4 },
                phoenix: { name: '–§–µ–Ω–∏–∫—Å', price: 18000, emoji: 'üî•', description: '–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ –∏–∑ –ø–µ–ø–ª–∞', gradient: 'from-red-500 via-orange-400 to-yellow-300', rarity: 'legendary', chance: 3 },
                moonlight: { name: '–õ—É–Ω–Ω—ã–π —Å–≤–µ—Ç', price: 20000, emoji: 'üåô', description: '–°–µ—Ä–µ–±—Ä–∏—Å—Ç–æ–µ —Å–∏—è–Ω–∏–µ', gradient: 'from-gray-700 via-blue-800 to-indigo-900', rarity: 'legendary', chance: 3 },
                enchanted: { name: '–ó–∞—á–∞—Ä–æ–≤–∞–Ω–Ω—ã–π', price: 22000, emoji: 'üßö', description: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –ª–µ—Å', gradient: 'from-purple-600 via-pink-500 to-green-400', rarity: 'legendary', chance: 2 },
                
                // –ú–ò–§–ò–ß–ï–°–ö–ò–ï –§–û–ù–´ (Mythic)
                cosmic: { name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π', price: 35000, emoji: 'üöÄ', description: '–ë–µ—Å–∫—Ä–∞–π–Ω–∏–π –∫–æ—Å–º–æ—Å', gradient: 'from-black via-purple-900 to-blue-900', rarity: 'mythic', chance: 1.5 },
                divine: { name: '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π', price: 50000, emoji: 'üëë', description: '–°–∏—è–Ω–∏–µ –±–æ–≥–æ–≤', gradient: 'from-white via-yellow-200 to-gold', rarity: 'mythic', chance: 1 },
                void: { name: '–ü—É—Å—Ç–æ—Ç–∞', price: 75000, emoji: 'üåë', description: '–ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç—å–º–∞', gradient: 'from-black via-gray-900 to-purple-900', rarity: 'mythic', chance: 0.8 },
                celestial: { name: '–ù–µ–±–µ—Å–Ω—ã–π', price: 100000, emoji: '‚≠ê', description: '–ó–≤–µ–∑–¥–Ω–∞—è –∫–æ—Ä–æ–Ω–∞', gradient: 'from-indigo-800 via-blue-600 to-cyan-400', rarity: 'mythic', chance: 0.5 },
                temporal: { name: '–í—Ä–µ–º–µ–Ω–Ω–æ–π', price: 150000, emoji: '‚è≥', description: '–ò—Å–∫–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏', gradient: 'from-purple-800 via-pink-600 to-orange-400', rarity: 'mythic', chance: 0.3 },
                infinity: { name: '–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å', price: 250000, emoji: '‚àû', description: '–ó–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è', gradient: 'from-gray-900 via-purple-800 via-blue-700 via-teal-600 to-green-500', rarity: 'mythic', chance: 0.1 },
                
                // –í–°–ï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–û–ù–´ (33 –®–¢–£–ö–ò –í–°–ï–ì–û)
                autumn: { name: '–û—Å–µ–Ω—å', price: 2500, emoji: 'üçÇ', description: '–ó–æ–ª–æ—Ç–∞—è –æ—Å–µ–Ω—å', gradient: 'from-yellow-600 via-orange-500 to-red-500', rarity: 'common', chance: 12 },
                spring: { name: '–í–µ—Å–Ω–∞', price: 1800, emoji: 'üå±', description: '–°–≤–µ–∂–∞—è –∑–µ–ª–µ–Ω—å', gradient: 'from-lime-200 via-green-200 to-emerald-200', rarity: 'common', chance: 12 },
                winter: { name: '–ó–∏–º–∞', price: 2200, emoji: '‚ùÑÔ∏è', description: '–°–Ω–µ–∂–Ω–∞—è —Å–∫–∞–∑–∫–∞', gradient: 'from-blue-100 via-white to-gray-100', rarity: 'common', chance: 12 },
                tropical: { name: '–¢—Ä–æ–ø–∏–∫–∏', price: 4000, emoji: 'üå∫', description: '–†–∞–π—Å–∫–∏–µ —Ç—Ä–æ–ø–∏–∫–∏', gradient: 'from-green-400 via-blue-400 to-cyan-300', rarity: 'rare', chance: 12 },
                desert: { name: '–ü—É—Å—Ç—ã–Ω—è', price: 4500, emoji: 'üèúÔ∏è', description: '–ü–µ—Å—á–∞–Ω—ã–µ –¥—é–Ω—ã', gradient: 'from-yellow-500 via-orange-400 to-red-400', rarity: 'rare', chance: 12 },
                deep_sea: { name: '–ì–ª—É–±–∏–Ω—ã –æ–∫–µ–∞–Ω–∞', price: 7500, emoji: 'üêô', description: '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥–ª—É–±–∏–Ω—ã', gradient: 'from-blue-900 via-teal-800 to-cyan-900', rarity: 'rare', chance: 12 },
                crystal: { name: '–ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π', price: 8000, emoji: 'üíé', description: '–°–≤–µ—Ä–∫–∞—é—â–∏–µ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã', gradient: 'from-cyan-300 via-blue-300 to-purple-300', rarity: 'rare', chance: 12 },
                volcano: { name: '–í—É–ª–∫–∞–Ω', price: 7000, emoji: 'üåã', description: '–û–≥–Ω–µ–Ω–Ω–∞—è –ª–∞–≤–∞', gradient: 'from-red-600 via-orange-500 to-yellow-400', rarity: 'rare', chance: 12 },
                mountain: { name: '–ì–æ—Ä—ã', price: 3200, emoji: 'üèîÔ∏è', description: '–ó–∞—Å–Ω–µ–∂–µ–Ω–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã', gradient: 'from-gray-400 via-blue-300 to-white', rarity: 'rare', chance: 12 },
                space: { name: '–û—Ç–∫—Ä—ã—Ç—ã–π –∫–æ—Å–º–æ—Å', price: 6500, emoji: 'üåå', description: '–ë–µ—Å–∫—Ä–∞–π–Ω–∏–µ –∑–≤–µ–∑–¥—ã', gradient: 'from-black via-purple-900 to-indigo-900', rarity: 'rare', chance: 12 },
                moonlight: { name: '–õ—É–Ω–Ω—ã–π —Å–≤–µ—Ç', price: 20000, emoji: 'üåô', description: '–°–µ—Ä–µ–±—Ä–∏—Å—Ç–æ–µ —Å–∏—è–Ω–∏–µ', gradient: 'from-gray-700 via-blue-800 to-indigo-900', rarity: 'legendary', chance: 12 },
                enchanted: { name: '–ó–∞—á–∞—Ä–æ–≤–∞–Ω–Ω—ã–π', price: 22000, emoji: 'üßö', description: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –ª–µ—Å', gradient: 'from-purple-600 via-pink-500 to-green-400', rarity: 'legendary', chance: 12 },
                phoenix: { name: '–§–µ–Ω–∏–∫—Å', price: 18000, emoji: 'üî•', description: '–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ –∏–∑ –ø–µ–ø–ª–∞', gradient: 'from-red-500 via-orange-400 to-yellow-300', rarity: 'legendary', chance: 12 },
                mystical: { name: '–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π', price: 25000, emoji: 'üîÆ', description: '–ú–∞–≥–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è', gradient: 'from-purple-800 via-blue-700 to-indigo-800', rarity: 'legendary', chance: 12 },
                neon: { name: '–ù–µ–æ–Ω–æ–≤—ã–π', price: 30000, emoji: 'üí°', description: '–ö–∏–±–µ—Ä –±—É–¥—É—â–µ–µ', gradient: 'from-pink-500 via-cyan-400 to-purple-500', rarity: 'legendary', chance: 12 },
                underwater: { name: '–ü–æ–¥–≤–æ–¥–Ω—ã–π –º–∏—Ä', price: 16000, emoji: 'üê†', description: '–ö–æ—Ä–∞–ª–ª–æ–≤—ã–µ —Ä–∏—Ñ—ã', gradient: 'from-teal-400 via-blue-500 to-cyan-600', rarity: 'legendary', chance: 12 },
                steampunk: { name: '–°—Ç–∏–º–ø–∞–Ω–∫', price: 28000, emoji: '‚öôÔ∏è', description: '–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π –º–∏—Ä', gradient: 'from-amber-600 via-orange-700 to-red-800', rarity: 'legendary', chance: 12 },
                candy: { name: '–ö–æ–Ω—Ñ–µ—Ç–Ω—ã–π', price: 14000, emoji: 'üç≠', description: '–°–ª–∞–¥–∫–∏–π —Ä–∞–π', gradient: 'from-pink-300 via-purple-300 to-blue-300', rarity: 'legendary', chance: 12 },
                void: { name: '–ü—É—Å—Ç–æ—Ç–∞', price: 75000, emoji: 'üåë', description: '–ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç—å–º–∞', gradient: 'from-black via-gray-900 to-purple-900', rarity: 'mythic', chance: 12 },
                temporal: { name: '–í—Ä–µ–º–µ–Ω–Ω–æ–π', price: 150000, emoji: '‚è≥', description: '–ò—Å–∫–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏', gradient: 'from-purple-800 via-pink-600 to-orange-400', rarity: 'mythic', chance: 12 },
                matrix: { name: '–ú–∞—Ç—Ä–∏—Ü–∞', price: 85000, emoji: 'üíª', description: '–¶–∏—Ñ—Ä–æ–≤–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å', gradient: 'from-green-900 via-green-700 to-black', rarity: 'mythic', chance: 12 },
                apocalypse: { name: '–ê–ø–æ–∫–∞–ª–∏–ø—Å–∏—Å', price: 95000, emoji: 'üí•', description: '–ö–æ–Ω–µ—Ü —Å–≤–µ—Ç–∞', gradient: 'from-red-900 via-orange-800 to-black', rarity: 'mythic', chance: 12 },
                paradise: { name: '–†–∞–π', price: 120000, emoji: '‚òÅÔ∏è', description: '–ù–µ–±–µ—Å–Ω–æ–µ –±–ª–∞–∂–µ–Ω—Å—Ç–≤–æ', gradient: 'from-white via-blue-200 to-yellow-200', rarity: 'mythic', chance: 12 },
                nightmare: { name: '–ö–æ—à–º–∞—Ä', price: 110000, emoji: 'üëª', description: '–¢–µ–º–Ω—ã–µ —Å–Ω—ã', gradient: 'from-purple-900 via-black to-red-900', rarity: 'mythic', chance: 12 },
                
                // –ù–û–í–´–ï –ü–†–ò–ö–û–õ–¨–ù–´–ï –§–û–ù–´ (–¥–æ–±–∞–≤–ª—è–µ–º –µ—â–µ 9 —à—Ç—É–∫)
                kawaii: { name: '–ö–∞–≤–∞–π–Ω—ã–π', price: 12000, emoji: 'üíñ', description: '–ú–∏–ª—ã–µ —Å–µ—Ä–¥–µ—á–∫–∏ –∏ –∑–≤–µ–∑–¥–æ—á–∫–∏', gradient: 'from-pink-200 via-purple-200 to-blue-200', rarity: 'legendary', chance: 12 },
                graffiti: { name: '–ì—Ä–∞—Ñ—Ñ–∏—Ç–∏', price: 15000, emoji: 'üé®', description: '–£–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ', gradient: 'from-orange-400 via-red-500 to-purple-600', rarity: 'legendary', chance: 12 },
                holographic: { name: '–ì–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π', price: 65000, emoji: '‚ú®', description: '–ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∞—è—Å—è –≥–æ–ª–æ–≥—Ä–∞–º–º–∞', gradient: 'from-cyan-300 via-purple-400 to-pink-400', rarity: 'mythic', chance: 12 },
                retro: { name: '–†–µ—Ç—Ä–æ', price: 8500, emoji: 'üìº', description: '–í–∏–Ω—Ç–∞–∂ 80-—Ö', gradient: 'from-purple-600 via-pink-500 to-orange-400', rarity: 'rare', chance: 12 },
                jungle: { name: '–î–∂—É–Ω–≥–ª–∏', price: 5200, emoji: 'ü¶ú', description: '–¢—Ä–æ–ø–∏—á–µ—Å–∫–∏–µ –∑–∞—Ä–æ—Å–ª–∏', gradient: 'from-green-600 via-lime-500 to-yellow-400', rarity: 'rare', chance: 12 },
                arctic: { name: '–ê—Ä–∫—Ç–∏–∫–∞', price: 7800, emoji: 'üêß', description: '–õ–µ–¥—è–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ—Ä—ã', gradient: 'from-blue-200 via-cyan-300 to-white', rarity: 'rare', chance: 12 },
                sakura: { name: '–¶–≤–µ—Ç–µ–Ω–∏–µ —Å–∞–∫—É—Ä—ã', price: 9500, emoji: 'üå∏', description: '–Ø–ø–æ–Ω—Å–∫–∞—è –≤–µ—Å–Ω–∞', gradient: 'from-pink-200 via-rose-300 to-red-200', rarity: 'rare', chance: 12 },
                cybercity: { name: '–ö–∏–±–µ—Ä—Å–∏—Ç–∏', price: 45000, emoji: 'üèôÔ∏è', description: '–ì–æ—Ä–æ–¥ –±—É–¥—É—â–µ–≥–æ', gradient: 'from-blue-600 via-purple-700 to-pink-800', rarity: 'mythic', chance: 12 },
                dimension: { name: '–î—Ä—É–≥–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ', price: 200000, emoji: 'üåÄ', description: '–ó–∞ –≥—Ä–∞–Ω—å—é —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏', gradient: 'from-indigo-900 via-purple-800 via-pink-700 via-orange-600 to-yellow-500', rarity: 'mythic', chance: 12 },
                
                // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–û–ù–´ –¥–æ 33 —à—Ç—É–∫ (–¥–æ–±–∞–≤–ª—è–µ–º –µ—â–µ 8)
                pastel: { name: '–ü–∞—Å—Ç–µ–ª—å–Ω—ã–π', price: 1600, emoji: 'üåà', description: '–ù–µ–∂–Ω—ã–µ –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞', gradient: 'from-pink-200 via-purple-200 to-blue-200', rarity: 'common', chance: 12 },
                mountain: { name: '–ì–æ—Ä—ã', price: 3200, emoji: 'üèîÔ∏è', description: '–ó–∞—Å–Ω–µ–∂–µ–Ω–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã', gradient: 'from-gray-400 via-blue-300 to-white', rarity: 'rare', chance: 12 },
                space: { name: '–û—Ç–∫—Ä—ã—Ç—ã–π –∫–æ—Å–º–æ—Å', price: 6500, emoji: 'üåå', description: '–ë–µ—Å–∫—Ä–∞–π–Ω–∏–µ –∑–≤–µ–∑–¥—ã', gradient: 'from-black via-purple-900 to-indigo-900', rarity: 'rare', chance: 12 },
                steampunk: { name: '–°—Ç–∏–º–ø–∞–Ω–∫', price: 28000, emoji: '‚öôÔ∏è', description: '–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π –º–∏—Ä', gradient: 'from-amber-600 via-orange-700 to-red-800', rarity: 'legendary', chance: 12 },
                candy: { name: '–ö–æ–Ω—Ñ–µ—Ç–Ω—ã–π', price: 14000, emoji: 'üç≠', description: '–°–ª–∞–¥–∫–∏–π —Ä–∞–π', gradient: 'from-pink-300 via-purple-300 to-blue-300', rarity: 'legendary', chance: 12 },
                kawaii: { name: '–ö–∞–≤–∞–π–Ω—ã–π', price: 12000, emoji: 'üíñ', description: '–ú–∏–ª—ã–µ —Å–µ—Ä–¥–µ—á–∫–∏ –∏ –∑–≤–µ–∑–¥–æ—á–∫–∏', gradient: 'from-pink-200 via-purple-200 to-blue-200', rarity: 'legendary', chance: 12 },
                graffiti: { name: '–ì—Ä–∞—Ñ—Ñ–∏—Ç–∏', price: 15000, emoji: 'üé®', description: '–£–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ', gradient: 'from-orange-400 via-red-500 to-purple-600', rarity: 'legendary', chance: 12 },
                holographic: { name: '–ì–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π', price: 65000, emoji: '‚ú®', description: '–ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∞—è—Å—è –≥–æ–ª–æ–≥—Ä–∞–º–º–∞', gradient: 'from-cyan-300 via-purple-400 to-pink-400', rarity: 'mythic', chance: 12 }
            };

            // –ü–û–°–õ–ï –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è backgrounds –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ–Ω–æ–≤
            this.currentBackground = this.loadData('current_background', 'default', 'string');
            this.unlockedBackgrounds = this.loadData('unlocked_backgrounds', ['default'], 'array');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
            this.unlockedFrames = this.loadData('unlocked_frames', ['default'], 'array');
            this.currentFrame = this.loadData('current_frame', 'default', 'string');
            // –ê–ö–°–ï–°–°–£–ê–†–´ –£–ë–†–ê–ù–´ –ò–ó –ò–ì–†–´

            // –°–∫–∏–Ω—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Å —Ä–µ–¥–∫–æ—Å—Ç—è–º–∏ –∏ —à–∞–Ω—Å–∞–º–∏
            this.skins = {
                default: { 
                    name: '–ë–∞–∑–æ–≤—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'common', 
                    chance: 30, 
                    image: 'https://i.ebayimg.com/images/g/yVoAAOSwiqJnxCvP/s-l1600.jpg',
                    color: '#DEB887'
                },
                pink: { 
                    name: '–†–æ–∑–æ–≤—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'rare', 
                    chance: 15, 
                    image: 'https://i.postimg.cc/8s8qs9Sv/photo-2025-06-29-05-15-51.jpg',
                    color: '#FFB6C1'
                },
                orange: { 
                    name: '–û—Ä–∞–Ω–∂–µ–≤—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'rare', 
                    chance: 15, 
                    image: 'https://i.postimg.cc/C5n3hYWY/photo-2025-06-29-05-16-06.jpg',
                    color: '#FFA500'
                },
                blue: { 
                    name: '–ì–æ–ª—É–±–æ–π –õ–∞–±—É–±—É', 
                    rarity: 'rare', 
                    chance: 14, 
                    image: 'https://i.postimg.cc/QNBC97DN/photo-2025-06-29-05-16-17.jpg',
                    color: '#87CEEB'
                },
                purple: { 
                    name: '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'rare', 
                    chance: 12, 
                    image: 'https://i.postimg.cc/76PxzfKW/purple-labubu.jpg',
                    color: '#9370DB'
                },
                green: { 
                    name: '–ó–µ–ª–µ–Ω—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'rare', 
                    chance: 12, 
                    image: 'https://i.postimg.cc/2y8PzDnm/green-labubu.jpg',
                    color: '#32CD32'
                },
                rainbow: { 
                    name: '–†–∞–¥—É–∂–Ω—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'legendary', 
                    chance: 6, 
                    image: 'https://i.postimg.cc/SQwsW-KQ6/photo-2025-06-29-05-16-29.jpg',
                    color: '#FF69B4'
                },
                cosmic: { 
                    name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –õ–∞–±—É–±—É', 
                    rarity: 'legendary', 
                    chance: 4, 
                    image: 'https://i.postimg.cc/5NxQz8Vh/cosmic-labubu.jpg',
                    color: '#191970'
                },
                cyber: { 
                    name: '–ö–∏–±–µ—Ä–ø–∞–Ω–∫ –õ–∞–±—É–±—É', 
                    rarity: 'legendary', 
                    chance: 4, 
                    image: 'https://i.postimg.cc/28Kx5RDQ/cyber-labubu.jpg',
                    color: '#00FFFF'
                },
                golden: { 
                    name: '–ó–æ–ª–æ—Ç–æ–π –õ–∞–±—É–±—É', 
                    rarity: 'mythic', 
                    chance: 2, 
                    image: 'https://i.postimg.cc/wTLBFd3S/photo-2025-06-29-05-16-38.jpg',
                    color: '#FFD700'
                },
                diamond: { 
                    name: '–ê–ª–º–∞–∑–Ω—ã–π –õ–∞–±—É–±—É', 
                    rarity: 'mythic', 
                    chance: 1, 
                    image: 'https://i.postimg.cc/DZzK8xN4/diamond-labubu.jpg',
                    color: '#B9F2FF'
                }
            };



            // –†–ê–ú–ö–ò –í–û–ö–†–£–ì –õ–ê–ë–£–ë–£ –° –®–ê–ù–°–û–ú 2%
            this.frames = {
                // –ü—Ä–æ—Å—Ç—ã–µ —Ä–∞–º–∫–∏
                wooden: { name: '–î–µ—Ä–µ–≤—è–Ω–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-4 border-yellow-800 bg-gradient-to-r from-yellow-700 to-yellow-900', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è —Ä–∞–º–∫–∞', rarity: 'rare' },
                silver: { name: '–°–µ—Ä–µ–±—Ä—è–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-4 border-gray-400 bg-gradient-to-r from-gray-300 to-gray-500 shadow-xl', description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è —Å–µ—Ä–µ–±—Ä—è–Ω–∞—è —Ä–∞–º–∫–∞', rarity: 'rare' },
                bronze: { name: '–ë—Ä–æ–Ω–∑–æ–≤–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-4 border-yellow-600 bg-gradient-to-r from-yellow-500 to-orange-600', description: '–ê–Ω—Ç–∏—á–Ω–∞—è –±—Ä–æ–Ω–∑–æ–≤–∞—è —Ä–∞–º–∫–∞', rarity: 'rare' },
                
                // –î—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏
                golden: { name: '–ó–æ–ª–æ—Ç–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-yellow-400 bg-gradient-to-r from-yellow-400 to-yellow-600 shadow-2xl animate-pulse', description: '–†–æ—Å–∫–æ—à–Ω–∞—è –∑–æ–ª–æ—Ç–∞—è —Ä–∞–º–∫–∞', rarity: 'legendary' },
                platinum: { name: '–ü–ª–∞—Ç–∏–Ω–æ–≤–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-gray-200 bg-gradient-to-r from-gray-100 to-gray-300 shadow-2xl', description: '–†–∞–º–∫–∞ –∏–∑ —á–∏—Å—Ç–æ–π –ø–ª–∞—Ç–∏–Ω—ã', rarity: 'legendary' },
                diamond: { name: '–ê–ª–º–∞–∑–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-8 border-blue-200 bg-gradient-to-r from-blue-100 to-cyan-200 shadow-2xl animate-pulse ring-4 ring-blue-300', description: '–°–≤–µ—Ä–∫–∞—é—â–∞—è –∞–ª–º–∞–∑–Ω–∞—è —Ä–∞–º–∫–∞', rarity: 'mythic' },
                
                // –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Ä–∞–º–∫–∏
                fire: { name: '–û–≥–Ω–µ–Ω–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-red-500 bg-gradient-to-r from-red-400 to-orange-500 shadow-2xl animate-pulse', description: '–ü—ã–ª–∞—é—â–∞—è –º–∞–≥–∏—á–µ—Å–∫–∞—è —Ä–∞–º–∫–∞', rarity: 'legendary', effect: 'fire' },
                ice: { name: '–õ–µ–¥—è–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-blue-300 bg-gradient-to-r from-blue-200 to-cyan-300 shadow-2xl', description: '–ú–æ—Ä–æ–∑–Ω–∞—è –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–º–∫–∞', rarity: 'legendary', effect: 'ice' },
                lightning: { name: '–ú–æ–ª–Ω–∏–µ–≤–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-purple-400 bg-gradient-to-r from-purple-300 to-indigo-400 shadow-2xl animate-pulse', description: '–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–º–∫–∞', rarity: 'mythic', effect: 'lightning' },
                
                // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä–∞–º–∫–∏
                rainbow: { name: '–†–∞–¥—É–∂–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-8 bg-gradient-to-r from-red-400 via-yellow-400 via-green-400 via-blue-400 to-purple-400 shadow-2xl animate-pulse', description: '–ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∞—è—Å—è –≤—Å–µ–º–∏ —Ü–≤–µ—Ç–∞–º–∏', rarity: 'mythic', effect: 'rainbow' },
                cosmic: { name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-8 border-indigo-900 bg-gradient-to-r from-indigo-900 via-purple-800 to-blue-900 shadow-2xl animate-pulse', description: '–ò–∑ –≥–ª—É–±–∏–Ω –∫–æ—Å–º–æ—Å–∞', rarity: 'mythic', effect: 'cosmic' },
                divine: { name: '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-10 border-yellow-300 bg-gradient-to-r from-yellow-200 via-white to-yellow-200 shadow-2xl animate-pulse ring-6 ring-yellow-400 ring-opacity-75', description: '–ë–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–Ω–∞—è –±–æ–≥–∞–º–∏ —Ä–∞–º–∫–∞', rarity: 'mythic', effect: 'divine' },
                
                // –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–º–∫–∏
                nature: { name: '–ü—Ä–∏—Ä–æ–¥–Ω–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-green-500 bg-gradient-to-r from-green-400 to-lime-500 shadow-xl', description: '–£–∫—Ä–∞—à–µ–Ω–∞ –ª–∏—Å—Ç—å—è–º–∏ –∏ —Ü–≤–µ—Ç–∞–º–∏', rarity: 'legendary' },
                tech: { name: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-6 border-cyan-400 bg-gradient-to-r from-cyan-300 to-blue-400 shadow-xl animate-pulse', description: '–§—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω', rarity: 'legendary' },
                ancient: { name: '–î—Ä–µ–≤–Ω—è—è —Ä–∞–º–∫–∞', chance: 2, style: 'border-8 border-amber-600 bg-gradient-to-r from-amber-500 to-yellow-700 shadow-2xl', description: '–†–µ–ª–∏–∫–≤–∏—è –¥—Ä–µ–≤–Ω–∏—Ö —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π', rarity: 'mythic' }
            };

            // –†–µ–¥–∫–æ—Å—Ç–∏
            this.rarities = {
                common: { name: '–û–±—ã—á–Ω–∞—è', color: '#888888', emoji: '‚ö™' },
                rare: { name: '–†–µ–¥–∫–∞—è', color: '#4A90E2', emoji: 'üîµ' },
                legendary: { name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è', color: '#FF6B35', emoji: 'üü†' },
                mythic: { name: '–ú–∏—Ñ–∏—á–µ—Å–∫–∞—è', color: '#FFD700', emoji: 'üü°' }
            };

            // –≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç–∞–¥–∏–∏
            this.evolutionStages = {
                baby: { name: '–ú–∞–ª—ã—à', minAge: 0 },
                child: { name: '–†–µ–±–µ–Ω–æ–∫', minAge: 7 },
                teen: { name: '–ü–æ–¥—Ä–æ—Å—Ç–æ–∫', minAge: 30 },
                adult: { name: '–í–∑—Ä–æ—Å–ª—ã–π', minAge: 60 },
                elder: { name: '–ú—É–¥—Ä–µ—Ü', minAge: 100 }
            };
            
            // –°–∏—Å—Ç–µ–º–∞ —Ñ–æ–Ω–æ–≤ –∏–≥—Ä—ã - –í–°–ï 33 –§–û–ù–ê (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
            this.backgrounds = {
                // –û–ë–´–ß–ù–´–ï –§–û–ù–´ (9 —à—Ç—É–∫)
                default: { name: '–û–±—ã—á–Ω—ã–π —Ñ–æ–Ω', price: 0, emoji: 'üé®', description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω', gradient: 'from-pink-100 via-purple-100 to-blue-100', rarity: 'common', chance: 12 },
                sunset: { name: '–ó–∞–∫–∞—Ç', price: 800, emoji: 'üåÖ', description: '–¢–µ–ø–ª—ã–π –∑–∞–∫–∞—Ç', gradient: 'from-orange-300 via-red-300 to-pink-300', rarity: 'common', chance: 12 },
                ocean: { name: '–û–∫–µ–∞–Ω', price: 1200, emoji: 'üåä', description: '–ì–ª—É–±–æ–∫–∏–µ –≤–æ–¥—ã', gradient: 'from-blue-300 via-cyan-300 to-teal-300', rarity: 'common', chance: 12 },
                forest: { name: '–õ–µ—Å', price: 1500, emoji: 'üå≤', description: '–ó–µ–ª–µ–Ω–∞—è –ø—Ä–∏—Ä–æ–¥–∞', gradient: 'from-green-300 via-emerald-300 to-lime-300', rarity: 'common', chance: 12 },
                lavender: { name: '–õ–∞–≤–∞–Ω–¥–∞', price: 2000, emoji: 'üíú', description: '–ê—Ä–æ–º–∞—Ç–Ω—ã–µ –ø–æ–ª—è', gradient: 'from-purple-300 via-violet-300 to-indigo-300', rarity: 'common', chance: 12 },
                autumn: { name: '–û—Å–µ–Ω—å', price: 2500, emoji: 'üçÇ', description: '–ó–æ–ª–æ—Ç–∞—è –æ—Å–µ–Ω—å', gradient: 'from-yellow-600 via-orange-500 to-red-500', rarity: 'common', chance: 12 },
                spring: { name: '–í–µ—Å–Ω–∞', price: 1800, emoji: 'üå±', description: '–°–≤–µ–∂–∞—è –∑–µ–ª–µ–Ω—å', gradient: 'from-lime-200 via-green-200 to-emerald-200', rarity: 'common', chance: 12 },
                winter: { name: '–ó–∏–º–∞', price: 2200, emoji: '‚ùÑÔ∏è', description: '–°–Ω–µ–∂–Ω–∞—è —Å–∫–∞–∑–∫–∞', gradient: 'from-blue-100 via-white to-gray-100', rarity: 'common', chance: 12 },
                pastel: { name: '–ü–∞—Å—Ç–µ–ª—å–Ω—ã–π', price: 1600, emoji: 'üåà', description: '–ù–µ–∂–Ω—ã–µ –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞', gradient: 'from-pink-200 via-purple-200 to-blue-200', rarity: 'common', chance: 12 },
                
                // –†–ï–î–ö–ò–ï –§–û–ù–´ (8 —à—Ç—É–∫)
                cherry: { name: '–°–∞–∫—É—Ä–∞', price: 3500, emoji: 'üå∏', description: '–Ø–ø–æ–Ω—Å–∫–∞—è –∫—Ä–∞—Å–æ—Ç–∞', gradient: 'from-pink-300 via-rose-300 to-red-300', rarity: 'rare', chance: 12 },
                galaxy: { name: '–ì–∞–ª–∞–∫—Ç–∏–∫–∞', price: 5000, emoji: 'üåå', description: '–ó–≤–µ–∑–¥–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ—Ä—ã', gradient: 'from-purple-900 via-blue-900 to-indigo-900', rarity: 'rare', chance: 12 },
                aurora: { name: '–°–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ', price: 6000, emoji: 'üåà', description: '–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ', gradient: 'from-green-400 via-blue-400 to-purple-400', rarity: 'rare', chance: 12 },
                tropical: { name: '–¢—Ä–æ–ø–∏–∫–∏', price: 4000, emoji: 'üå∫', description: '–†–∞–π—Å–∫–∏–µ —Ç—Ä–æ–ø–∏–∫–∏', gradient: 'from-green-400 via-blue-400 to-cyan-300', rarity: 'rare', chance: 12 },
                desert: { name: '–ü—É—Å—Ç—ã–Ω—è', price: 4500, emoji: 'üèúÔ∏è', description: '–ü–µ—Å—á–∞–Ω—ã–µ –¥—é–Ω—ã', gradient: 'from-yellow-500 via-orange-400 to-red-400', rarity: 'rare', chance: 12 },
                volcano: { name: '–í—É–ª–∫–∞–Ω', price: 7000, emoji: 'üåã', description: '–û–≥–Ω–µ–Ω–Ω–∞—è –ª–∞–≤–∞', gradient: 'from-red-600 via-orange-500 to-yellow-400', rarity: 'rare', chance: 12 },
                crystal: { name: '–ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π', price: 8000, emoji: 'üíé', description: '–°–≤–µ—Ä–∫–∞—é—â–∏–µ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã', gradient: 'from-cyan-300 via-blue-300 to-purple-300', rarity: 'rare', chance: 12 },
                retro: { name: '–†–µ—Ç—Ä–æ', price: 8500, emoji: 'üìº', description: '–í–∏–Ω—Ç–∞–∂ 80-—Ö', gradient: 'from-purple-600 via-pink-500 to-orange-400', rarity: 'rare', chance: 12 },
                
                // –õ–ï–ì–ï–ù–î–ê–†–ù–´–ï –§–û–ù–´ (8 —à—Ç—É–∫)
                golden: { name: '–ó–æ–ª–æ—Ç–æ–π', price: 12000, emoji: '‚ú®', description: '–†–æ—Å–∫–æ—à–Ω–æ–µ –∑–æ–ª–æ—Ç–æ', gradient: 'from-yellow-400 via-amber-400 to-orange-400', rarity: 'legendary', chance: 12 },
                rainbow: { name: '–†–∞–¥—É–∂–Ω—ã–π', price: 15000, emoji: 'üåà', description: '–í—Å–µ —Ü–≤–µ—Ç–∞ —Å–ø–µ–∫—Ç—Ä–∞', gradient: 'from-red-400 via-yellow-400 via-green-400 via-blue-400 to-purple-400', rarity: 'legendary', chance: 12 },
                phoenix: { name: '–§–µ–Ω–∏–∫—Å', price: 18000, emoji: 'üî•', description: '–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ –∏–∑ –ø–µ–ø–ª–∞', gradient: 'from-red-500 via-orange-400 to-yellow-300', rarity: 'legendary', chance: 12 },
                moonlight: { name: '–õ—É–Ω–Ω—ã–π —Å–≤–µ—Ç', price: 20000, emoji: 'üåô', description: '–°–µ—Ä–µ–±—Ä–∏—Å—Ç–æ–µ —Å–∏—è–Ω–∏–µ', gradient: 'from-gray-700 via-blue-800 to-indigo-900', rarity: 'legendary', chance: 12 },
                enchanted: { name: '–ó–∞—á–∞—Ä–æ–≤–∞–Ω–Ω—ã–π', price: 22000, emoji: 'üßö', description: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –ª–µ—Å', gradient: 'from-purple-600 via-pink-500 to-green-400', rarity: 'legendary', chance: 12 },
                mystical: { name: '–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π', price: 25000, emoji: 'üîÆ', description: '–ú–∞–≥–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è', gradient: 'from-purple-800 via-blue-700 to-indigo-800', rarity: 'legendary', chance: 12 },
                neon: { name: '–ù–µ–æ–Ω–æ–≤—ã–π', price: 30000, emoji: 'üí°', description: '–ö–∏–±–µ—Ä –±—É–¥—É—â–µ–µ', gradient: 'from-pink-500 via-cyan-400 to-purple-500', rarity: 'legendary', chance: 12 },
                underwater: { name: '–ü–æ–¥–≤–æ–¥–Ω—ã–π –º–∏—Ä', price: 16000, emoji: 'üê†', description: '–ö–æ—Ä–∞–ª–ª–æ–≤—ã–µ —Ä–∏—Ñ—ã', gradient: 'from-teal-400 via-blue-500 to-cyan-600', rarity: 'legendary', chance: 12 },
                
                // –ú–ò–§–ò–ß–ï–°–ö–ò–ï –§–û–ù–´ (8 —à—Ç—É–∫)
                cosmic: { name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π', price: 35000, emoji: 'üöÄ', description: '–ë–µ—Å–∫—Ä–∞–π–Ω–∏–π –∫–æ—Å–º–æ—Å', gradient: 'from-black via-purple-900 to-blue-900', rarity: 'mythic', chance: 12 },
                divine: { name: '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π', price: 50000, emoji: 'üëë', description: '–°–∏—è–Ω–∏–µ –±–æ–≥–æ–≤', gradient: 'from-white via-yellow-200 to-gold', rarity: 'mythic', chance: 12 },
                void: { name: '–ü—É—Å—Ç–æ—Ç–∞', price: 75000, emoji: 'üåë', description: '–ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç—å–º–∞', gradient: 'from-black via-gray-900 to-purple-900', rarity: 'mythic', chance: 12 },
                celestial: { name: '–ù–µ–±–µ—Å–Ω—ã–π', price: 100000, emoji: '‚≠ê', description: '–ó–≤–µ–∑–¥–Ω–∞—è –∫–æ—Ä–æ–Ω–∞', gradient: 'from-indigo-800 via-blue-600 to-cyan-400', rarity: 'mythic', chance: 12 },
                temporal: { name: '–í—Ä–µ–º–µ–Ω–Ω–æ–π', price: 150000, emoji: '‚è≥', description: '–ò—Å–∫–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏', gradient: 'from-purple-800 via-pink-600 to-orange-400', rarity: 'mythic', chance: 12 },
                infinity: { name: '–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å', price: 250000, emoji: '‚àû', description: '–ó–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è', gradient: 'from-gray-900 via-purple-800 via-blue-700 via-teal-600 to-green-500', rarity: 'mythic', chance: 12 },
                matrix: { name: '–ú–∞—Ç—Ä–∏—Ü–∞', price: 85000, emoji: 'üíª', description: '–¶–∏—Ñ—Ä–æ–≤–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å', gradient: 'from-green-900 via-green-700 to-black', rarity: 'mythic', chance: 12 },
                dimension: { name: '–î—Ä—É–≥–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ', price: 200000, emoji: 'üåÄ', description: '–ó–∞ –≥—Ä–∞–Ω—å—é —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏', gradient: 'from-indigo-900 via-purple-800 via-pink-700 via-orange-600 to-yellow-500', rarity: 'mythic', chance: 12 }
            };

            // –ü–û–°–õ–ï –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è backgrounds –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ–Ω–æ–≤
            this.currentBackground = this.loadData('current_background', 'default', 'string');
            this.unlockedBackgrounds = this.loadData('unlocked_backgrounds', ['default'], 'array');

            // –û–¥–µ–∂–¥–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Ü–µ–Ω)
            this.outfits = {
                default: { name: '–û–±—ã—á–Ω–∞—è –æ–¥–µ–∂–¥–∞', price: 0, emoji: 'üëï', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å' },
                cool: { name: '–ö—Ä—É—Ç—ã–µ –æ—á–∫–∏', price: 250, emoji: 'üòé', description: '–°—Ç–∏–ª—å–Ω—ã–µ —Å–æ–ª–Ω—Ü–µ–∑–∞—â–∏—Ç–Ω—ã–µ –æ—á–∫–∏', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KSpKRVjlm_RkhxVD4pXaJKygJJeOPjjgOlWbpRgLbnB1ZAO5p2dI-3YatEnIOYiZrhL4x169H5PeSeCNLrbN_LiHgjnez_1qMHbXtpbKZonuSv1JEMfsyTE_jWk2Vjwkx9DxVzVrbYcaGEY3CKCNbfm0DqyqQCicS8hmea6djC7V05F=s1024' },
                cute: { name: '–ú–∏–ª–∞—è —à–∞–ø–æ—á–∫–∞-–∑–∞–π—á–∏–∫', price: 300, emoji: 'üê∞', description: '–û—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –±–µ–ª–∞—è —à–∞–ø–æ—á–∫–∞ —Å —Ä–æ–∑–æ–≤—ã–º–∏ —É—à–∫–∞–º–∏', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KTBWk5FaVqg5TSheRJrx-E3Ht5wFhgTePYiIpXHsPyJUaC1pywPfkORca_wqkOOCA_8MgfmxeJjKIIgN79qVpZmvjO6DT2U4Djaf9RO5kdXT7Y37WaDe27Snmq8xV9n6kIrvooV0ukvmwKHjU5IwSkuB7v7aZUW-FbO9EHWcvFTIxMY-g=s1024' },
                artist: { name: '–•—É–¥–æ–∂–Ω–∏–∫', price: 380, emoji: 'üé®', description: '–ë–µ—Ä–µ—Ç –∏ –ø–∞–ª–∏—Ç—Ä–∞ —Ö—É–¥–æ–∂–Ω–∏–∫–∞' },
                summer: { name: '–õ–µ—Ç–Ω—è—è –ø–∞–Ω–∞–º–∞', price: 500, emoji: 'üëí', description: '–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–æ–ª–Ω—Ü–∞ –≤ –∂–∞—Ä–∫–∏–µ –¥–Ω–∏', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KQgNY3oPaKq-vJXjqtKJhwoKBgt5rHdjiTq7FSl987ybzI3bnqyqEZliWC6n1k_YWtItJfQNjLu5ZcOheY9IUSTB5eoHuGKqoBu3HtCCn0pcimU1FsxfZKjdZ6dW-gMU6qVKPPAfeTa9-dgIn97icgGJyx5N3s-FwgRq5B525IWj_oNWw=s1024' },
                pirate: { name: '–ü–∏—Ä–∞—Ç—Å–∫–∏–π –∫–æ—Å—Ç—é–º', price: 500, emoji: 'üè¥‚Äç‚ò†Ô∏è', description: '–§–ª–∞–≥ –∏ –ø–æ–≤—è–∑–∫–∞ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –º–æ—Ä—Å–∫–æ–≥–æ —Ä–∞–∑–±–æ–π–Ω–∏–∫–∞', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KTqA1YhFzadswfIqFeTFATGNWcVmql50yfSGR14sxF3P_7fA51t61z9O_ElOyuBffWnyEP4uFz70PvgU0UFiXiYv83KqIeQr45k0r4FdFhb0yqWCa2ULVO0DPUanQNk8B4ROzTQGmHwO6-p5dkt8uD0yfrk6P7_DOd7jvVYx27V56CjLg=s1024' },
                formal: { name: '–î–µ–ª–æ–≤–æ–π –∫–æ—Å—Ç—é–º', price: 1500, emoji: 'ü§µ', description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π —á–µ—Ä–Ω—ã–π –∫–æ—Å—Ç—é–º —Å –≥–∞–ª—Å—Ç—É–∫–æ–º', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KSeqdykkIdnGZHfOH14tCALa06aMF9P6d9Sw0rm7WeTi1NR-nW-0C4x231qu8Zts6k-Jnxg16chpirg1zJFbt7wjgHf3Wo6DQYdth3uXsQeeM8B0bdfsfoxXMLCwUHjQ4JgzFxFqRApcbPf5MYgsGj5pORBo_pAj1K0LHVhXMX6xMSEQQ=s1024' },
                winter: { name: '–ó–∏–º–Ω—è—è –∫—É—Ä—Ç–∫–∞', price: 2000, emoji: 'üß•', description: '–¢–µ–ø–ª–∞—è –∫—É—Ä—Ç–∫–∞ –¥–ª—è —Ö–æ–ª–æ–¥–Ω–æ–π –ø–æ–≥–æ–¥—ã', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KTxCEBZrsAcaOt8mt4LjcLthFQZ2lhlrIZTcwekzMR3ODS-7V-y_m7c-_yFdPd-hCb9i08p3fW0vCajAEdJkip67TQJw0rsP09l5c49ZyG_rBEsv2io9mW2msQJsli2hr7kv2kRopjHwdbN8hVyDVCoX7yBTzkkXxygobNfvPx1uqTp=s1024' },
                school: { name: '–®–∫–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞', price: 3000, emoji: 'üéí', description: '–ê–∫–∫—É—Ä–∞—Ç–Ω–∞—è —à–∫–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å —Ä—é–∫–∑–∞—á–∫–æ–º', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KSzueH3-hMtM7lA2WveRFgZV9iCXa0D5N9Z8Vw9AAR_mLgCyE6zTrqu6BABMCTH80UkFmp-vmBh0Cr7ZlDw7Lq-UttAyk21eli4s9rRagGFYjxeQESpOyAQXL9CSCPtGawNsaBfta6Wa_g7pku3LgMzEv6SzWSYs1UzxoJ9tJcQV2pr=s1024' },
                knight: { name: '–†—ã—Ü–∞—Ä—å', price: 3000, emoji: '‚öîÔ∏è', description: '–î–æ—Å–ø–µ—Ö–∏ –∏ –º–µ—á —Ö—Ä–∞–±—Ä–æ–≥–æ —Ä—ã—Ü–∞—Ä—è', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KQEyf89ZUfFdb4fEyslGacR2ovpuyvcMZ-2bBZNsjz6M3GboPgvXfVYSnJAarf5-kmyKBphmBLdZL63T4JlUTb1-IdxnLTjNTC-vMkNoj4heCd7LVeQWQ-47m5g-cOgDo75-3eLrKC9roxWbeHbtAgRJl3tRgA2jd0FBOXi-GqZqV3J3w=s1024' },
                chef: { name: '–ö–æ—Å—Ç—é–º –ø–æ–≤–∞—Ä–∞', price: 4000, emoji: 'üë®‚Äçüç≥', description: '–ë–µ–ª—ã–π –∫–æ–ª–ø–∞–∫ –∏ —Ñ–∞—Ä—Ç—É–∫ —à–µ—Ñ-–ø–æ–≤–∞—Ä–∞', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KRAnLRL68CsnxJmlEhhul-fAzzg0wyNCnUd_IYARXgWj1m9mDqKeOVJy4e59Fwpz86mPm43o5IjyKxS7wEXPHVh626clvIWqEVAtrmmm7dgL-XopAKZ1YRujxo4ZBJbMjiSJ_sD2FwU1_nthVxma-b1Uut01G8839lnChFiagdPIsqjkQ=s1024' },
                superhero: { name: '–°—É–ø–µ—Ä–≥–µ—Ä–æ–π', price: 4500, emoji: 'ü¶∏', description: '–ü–ª–∞—â –∏ –º–∞—Å–∫–∞ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –≥–µ—Ä–æ—è', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KT-a_UoSupy-qHI_hWHRFiSG1i_9VeWgkZDicgclAVN_VHcGZy0oMTtQYzI_LivmJS7w_MM0PIslsYPPhSgwIZhQwdIq3eYkAhKxtNxtx0NKEjmucGdKxLetlYZZC6sZwoJxMBOhGyL49rjiF4ZKnSGBqavOq6EaxZUhYYBekqKFgZu=s1024' },
                doctor: { name: '–î–æ–∫—Ç–æ—Ä', price: 4800, emoji: 'üë®‚Äç‚öïÔ∏è', description: '–ë–µ–ª—ã–π —Ö–∞–ª–∞—Ç –∏ —Å—Ç–µ—Ç–æ—Å–∫–æ–ø', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KSVy9I1VlEurY9loVBGFCv5A7ydPo1u5iMtuyVSql4t4SATcmjUsn8deyd1wVd7B_Eb1RXkb0ig_Wok-qf6tE3RFjxrfzOSB8wYvL03UOJ4A6By6BQv0M6IEWZ0XOX9vL0VP_1kgkxg5iZhnR_GIxm38rrIJPTUHFnhrPrU-njScGl1dg=s1024' },
                ninja: { name: '–ö–æ—Å—Ç—é–º –Ω–∏–Ω–¥–∑—è', price: 5000, emoji: 'ü•∑', description: '–°–µ–∫—Ä–µ—Ç–Ω–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç–∏', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KRshrrG8dFl75oR5qhzwIbpryxVJm5O8JyV17jwiybRyM2y5uotp52ANgD0AdevW_ZcWb1LrrMsdUeTHBUJ-tn8UZgA4BsRc7AI5CLstqTPYm9Ndb0eJRZhN1hfeUhRms8DP6LO2kKSPkZHSwEPYOFK2kBWm7-mmKALA7w8iWua8rTh=s1024' },
                detective: { name: '–î–µ—Ç–µ–∫—Ç–∏–≤', price: 5000, emoji: 'üïµÔ∏è', description: '–ü–ª–∞—â –∏ —à–ª—è–ø–∞ —Å—ã—â–∏–∫–∞', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KTue-dtDhus0c5YaMD8XV9cM5RoZE_vv8hpx0XE6td8Rnf2S-XcR8I2O3gX_I-cknpK80NXU6vJ14RUY-j9w6-w4o4OfGXKaALMV-YEKugOVlyi5nNrPTQB-YKgkzS2Rxv2P-Hqui9vuXZmQVxP9Qf2tlEbKI8Va7-B_bsRbJ11XcBBhw=s1024' },
                wizard: { name: '–ö–æ—Å—Ç—é–º –≤–æ–ª—à–µ–±–Ω–∏–∫–∞', price: 5500, emoji: 'üßô', description: '–ú–∞–≥–∏—á–µ—Å–∫–∞—è —à–ª—è–ø–∞ —Å–æ –∑–≤–µ–∑–¥–∞–º–∏', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KQPxv5r4tIYWRApKphxhkgxvnGKQM3xsq4M3aXc0geAPt-2vndpdQsdIj8NRVBWgKdMidAYute_I8JJm0ODHTBNQaJiocoUFom3YDGKQ8OVooO5DRr6FnrnXGQNeKxte5OkiBp0oSLIJJj5gLx4FSnqzIrX2gWgFz-4trg_FY9wwko_=s1024' },
                astronaut: { name: '–ö–æ—Å–º–æ–Ω–∞–≤—Ç', price: 6000, emoji: 'üë®‚ÄçüöÄ', description: '–°–∫–∞—Ñ–∞–Ω–¥—Ä –¥–ª—è –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KT324-72aIqf_NQFi9Tnsm9RzZ1AMnpOiazs-OFBLsEscgjEI9veiZtGCKxmQk3colgJi1PMqB_eMay5IMKIz6PNNMi7EQ0TBZpBo7wL8txaVuxYXUhXtKUsrw7tmyT_aO5RFDQJWqxCihIvzMxa64kcSOD6zzyFXFbZLZGCIvnRkggxQ=s1024' },
                dancer: { name: '–¢–∞–Ω—Ü–æ—Ä', price: 9000, emoji: 'üíÉ', description: '–Ø—Ä–∫–∏–π –∫–æ—Å—Ç—é–º –¥–ª—è —Ç–∞–Ω—Ü–µ–≤', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KQ1bWEIPopeYlRuCPeUOosampl8EutcqIbnPK8lFvkeqjxJW3_WJnqNouxj_V8rT8CpbIL1qquBwojfG7jXpGnpK6_gN881tPaFJVTaEeTbumY1RQI25STXm7xOo7aX_GplQe8czmFNvmmoyTIdUo8728z2C0fn09vYSiZnah0Z2zJb=s1024' },
                vampire: { name: '–í–∞–º–ø–∏—Ä', price: 9999, emoji: 'üßõ', description: '–ß–µ—Ä–Ω—ã–π –ø–ª–∞—â —Å –∫—Ä–∞—Å–Ω–æ–π –ø–æ–¥–∫–ª–∞–¥–∫–æ–π', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KSuo6SXblej9rDGQ8LILADG9BLIwAjJ4E2YLtjshoZUuodp0PuVPENbbyrkcpbzkZv3d7hvN1h8FBnqxoo1L-3X3ehM1TNmCv6REelZ5qgFQgwCczuogCjCvrO1RhZEY_QTA44gBkzOuU0DsRgsWALWmatt0SEkQSlW-gX1pCE28q7eTw=s1024' },
                princess: { name: '–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞', price: 10000, emoji: 'üë∏', description: '–†–æ—Å–∫–æ—à–Ω–æ–µ –ø–ª–∞—Ç—å–µ —Å —Ç–∏–∞—Ä–æ–π', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KT4Tt1J4Ad-O_QldsJl73yIYw2kiZytty5vsBTyRFyvDwq97eF62z6tZX4btNnDdy7vC1OiD-yz6hyGf_D4zzkFUZIx8ztfjmAALzJwveorga1bVO2z6awSb7B6bHBcjA3ElV1VqtYwbH8XGP39uVttD2NGXRxmCAKbxNyqhwmGBttx=s1024' },
                angel: { name: '–ê–Ω–≥–µ–ª', price: 14000, emoji: 'üëº', description: '–ë–µ–ª—ã–µ –∫—Ä—ã–ª—å—è –∏ –Ω–∏–º–±', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KSVmpstfVgB8mEks0YIUTCbhnziSNQu2lnWaN_czBj4obZG1n1OcLstyYdCGRYIRqkZ73KQb780aNr-E-Ntn-QC-AD0wGE-q1nl-Qn2r59f4YmPNf6L-GqacgaCRLB-Y9rXuFfJaFIVRsKPYV2UW4zfDfAGzhwp9Vc59TukY2RF7If-_A=s1024' },
                robot: { name: '–†–æ–±–æ—Ç', price: 20000, emoji: 'ü§ñ', description: '–ú–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –∫–æ—Å—Ç—é–º –±—É–¥—É—â–µ–≥–æ', image: 'https://lh3.googleusercontent.com/gg-dl/AJfQ9KRydl7aa74Zq_cG1QWNF0soJHjskQIeTDTjzGT-Bktd9uAxlZmiQy-xEn2DmyeC_YdApcJhIhvq6-z4Mx6P-7if4kAjiMIn6kvNao3Yt59wCR6jjeZy4tnFTT2_GpJhhdNlG6GwlS9g1pn0_mrCs42iLOXH3GXHiH0BjFnlrvki7QZ_QA=s1024' }
            };
            

        }
        
        loadData(key, defaultValue, type = 'auto') {
            try {
                const saved = localStorage.getItem(key);
                
                if (saved === null || saved === undefined) {
                    return defaultValue;
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
                switch (type) {
                    case 'string':
                        return saved;
                        
                    case 'number':
                        const num = parseFloat(saved);
                        return isNaN(num) ? defaultValue : num;
                        
                    case 'boolean':
                        return saved === 'true';
                        
                    case 'auto':
                    default:
                        try {
                            return JSON.parse(saved);
                        } catch (parseError) {
                            console.warn(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –∫–ª—é—á–∞ ${key}:`, parseError);
                            return defaultValue;
                        }
                }
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–ª—é—á–∞ ${key}:`, error);
                return defaultValue;
            }
        }
        
        saveData() {
            try {
                console.log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã...');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                this.lastUpdate = Date.now();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
                this.updateActivePet();
                
                // –ü–†–ò–û–†–ò–¢–ï–¢: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
                this.saveToDatabaseAsync().then(success => {
                    if (success) {
                        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)');
                    } else {
                        console.log('‚ö†Ô∏è –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –≤ localStorage');
                    }
                });
                
                // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ localStorage –∫–∞–∫ –∫—ç—à
                this.saveToLocalStorage();
                
                // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
                this.createBackup();
                
                console.log('‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–æ');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                this.showMessage('‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
            }
        }
        
        saveValue(key, value) {
            try {
                if (typeof value === 'object') {
                    localStorage.setItem(key, JSON.stringify(value));
                } else {
                    localStorage.setItem(key, value.toString());
                }
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ${key}:`, error);
            }
        }
        
        validateGameData() {
            console.log('üîç –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã...');
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
            if (!this.stats || typeof this.stats !== 'object') {
                this.stats = {
                    hunger: 100, happiness: 100, cleanliness: 100,
                    health: 100, energy: 100, sleep: 100
                };
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            this.money = Math.max(0, this.money || 0);
            this.level = Math.max(1, this.level || 1);
            this.experience = Math.max(0, this.experience || 0);
            this.age = Math.max(0, this.age || 0);
            this.chestCount = Math.max(0, this.chestCount || 0);
            this.friendsInvited = Math.max(0, this.friendsInvited || 0);
            this.lastChestLevel = Math.max(0, this.lastChestLevel || 0);
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –ø–∏—Ç–æ–º—Ü–∞ (0-100)
            Object.keys(this.stats).forEach(stat => {
                this.stats[stat] = Math.max(0, Math.min(100, this.stats[stat] || 100));
            });
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ø–æ–ª–µ–π
            this.petName = this.petName || 'Labubu';
            this.outfit = this.outfit || 'default';
            this.currentSkin = this.currentSkin || 'default';
            this.evolutionStage = this.evolutionStage || 'baby';
            this.gameUserId = this.gameUserId || this.generateUserId();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤
            if (!Array.isArray(this.unlockedSkins)) {
                this.unlockedSkins = ['default'];
            }
            
            if (!Array.isArray(this.pets)) {
                this.pets = [{
                    id: 'pet1',
                    name: this.petName,
                    stats: this.stats,
                    outfit: this.outfit,
                    age: this.age,
                    evolutionStage: this.evolutionStage,
                    currentSkin: this.currentSkin
                }];
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
            if (!this.lastUpdate || this.lastUpdate > Date.now()) {
                this.lastUpdate = Date.now();
            }
            
            if (!this.lastNotification || this.lastNotification > Date.now()) {
                this.lastNotification = Date.now();
            }
            
            console.log('‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
            console.log('üìä –§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:', {
                petName: this.petName,
                level: this.level,
                money: this.money,
                experience: this.experience,
                age: this.age,
                stats: this.stats
            });
        }
        
        updateActivePet() {
            const activePet = this.pets.find(pet => pet.id === this.activePetId);
            if (activePet) {
                activePet.name = this.petName;
                activePet.stats = { ...this.stats };
                activePet.outfit = this.outfit;
                activePet.age = this.age;
                activePet.evolutionStage = this.evolutionStage;
                activePet.currentSkin = this.currentSkin;
                activePet.level = this.level;
                activePet.experience = this.experience;
                activePet.money = this.money;
            }
        }
        
        createBackup() {
            try {
                const backupData = {
                    timestamp: Date.now(),
                    version: '4.0',
                    data: {
                        stats: this.stats,
                        money: this.money,
                        outfit: this.outfit,
                        level: this.level,
                        experience: this.experience,
                        age: this.age,
                        evolutionStage: this.evolutionStage,
                        petName: this.petName,
                        isSleeping: this.isSleeping,
                        currentSkin: this.currentSkin,
                        unlockedSkins: this.unlockedSkins,
                        chestCount: this.chestCount,
                        friendsInvited: this.friendsInvited,
                        pets: this.pets
                    }
                };
                
                localStorage.setItem('labubu_backup', JSON.stringify(backupData));
                
                // –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
                const backupHistory = JSON.parse(localStorage.getItem('labubu_backup_history') || '[]');
                backupHistory.push(backupData);
                
                if (backupHistory.length > 3) {
                    backupHistory.shift();
                }
                
                localStorage.setItem('labubu_backup_history', JSON.stringify(backupHistory));
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:', error);
            }
        }
        
        restoreFromBackup() {
            try {
                const backup = JSON.parse(localStorage.getItem('labubu_backup') || '{}');
                
                if (backup.data && backup.timestamp) {
                    const data = backup.data;
                    
                    this.stats = data.stats || this.stats;
                    this.money = data.money || this.money;
                    this.outfit = data.outfit || this.outfit;
                    this.level = data.level || this.level;
                    this.experience = data.experience || this.experience;
                    this.age = data.age || this.age;
                    this.evolutionStage = data.evolutionStage || this.evolutionStage;
                    this.petName = data.petName || this.petName;
                    this.isSleeping = data.isSleeping || this.isSleeping;
                    this.currentSkin = data.currentSkin || this.currentSkin;
                    this.unlockedSkins = data.unlockedSkins || this.unlockedSkins;
                    this.chestCount = data.chestCount || this.chestCount;
                    this.friendsInvited = data.friendsInvited || this.friendsInvited;
                    this.pets = data.pets || this.pets;
                    
                    this.saveData();
                    this.updateDisplay();
                    
                    return true;
                }
                
                return false;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:', error);
                return false;
            }
        }
        
        resetToDefaults() {
            console.log('üîÑ –°–±—Ä–æ—Å –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é...');
            
            this.stats = {
                hunger: 100, happiness: 100, cleanliness: 100,
                health: 100, energy: 100, sleep: 100
            };
            
            this.money = 100;
            this.outfit = 'default';
            this.level = 1;
            this.experience = 0;
            this.age = 0;
            this.evolutionStage = 'baby';
            this.lastUpdate = Date.now();
            this.lastNotification = Date.now();
            this.petName = 'Labubu';
            this.isSleeping = false;
            this.telegramConnected = false;
            this.telegramChatId = '';
            this.gameUserId = this.generateUserId();
            this.currentSkin = 'default';
            this.unlockedSkins = ['default'];
            this.chestCount = 0;
            this.friendsInvited = 0;
            this.lastChestLevel = 0;
            
            this.pets = [{
                id: 'pet1',
                name: this.petName,
                stats: this.stats,
                outfit: this.outfit,
                age: this.age,
                evolutionStage: this.evolutionStage,
                currentSkin: this.currentSkin
            }];
            this.activePetId = 'pet1';
            
            this.saveData();
        }
        
        startAutoSave() {
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                this.saveData();
            }, 30000);
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ë–î –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
            setInterval(() => {
                this.loadFromDatabaseAsync();
            }, 120000);
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            window.addEventListener('beforeunload', () => {
                this.saveData();
            });
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
            window.addEventListener('blur', () => {
                this.saveData();
            });
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
            window.addEventListener('focus', () => {
                this.loadFromDatabaseAsync();
            });
        }
        
        exportGameData() {
            try {
                const exportData = {
                    version: '4.0',
                    timestamp: Date.now(),
                    playerName: this.petName,
                    data: {
                        stats: this.stats,
                        money: this.money,
                        outfit: this.outfit,
                        level: this.level,
                        experience: this.experience,
                        age: this.age,
                        evolutionStage: this.evolutionStage,
                        petName: this.petName,
                        isSleeping: this.isSleeping,
                        currentSkin: this.currentSkin,
                        unlockedSkins: this.unlockedSkins,
                        chestCount: this.chestCount,
                        friendsInvited: this.friendsInvited,
                        pets: this.pets,
                        gameUserId: this.gameUserId
                    }
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `labubu_save_${new Date().toISOString().slice(0, 10)}.json`;
                link.click();
                
                this.showMessage('üìÅ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:', error);
                this.showMessage('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö!');
            }
        }
        
        importGameData(fileContent) {
            try {
                const importData = JSON.parse(fileContent);
                
                if (!importData.data || !importData.version) {
                    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
                }
                
                const data = importData.data;
                
                // –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
                this.stats = data.stats || this.stats;
                this.money = Math.max(0, data.money || 0);
                this.outfit = data.outfit || 'default';
                this.level = Math.max(1, data.level || 1);
                this.experience = Math.max(0, data.experience || 0);
                this.age = Math.max(0, data.age || 0);
                this.evolutionStage = data.evolutionStage || 'baby';
                this.petName = data.petName || 'Labubu';
                this.isSleeping = data.isSleeping || false;
                this.currentSkin = data.currentSkin || 'default';
                this.unlockedSkins = Array.isArray(data.unlockedSkins) ? data.unlockedSkins : ['default'];
                this.chestCount = Math.max(0, data.chestCount || 0);
                this.friendsInvited = Math.max(0, data.friendsInvited || 0);
                this.pets = Array.isArray(data.pets) ? data.pets : this.pets;
                
                if (data.gameUserId) {
                    this.gameUserId = data.gameUserId;
                }
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
                this.validateGameData();
                this.saveData();
                this.updateDisplay();
                
                this.showMessage('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:', error);
                this.showMessage('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö!');
            }
        }
        
        init() {
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
            this.updateTimeAndWeather();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
            if (this.isFirstTime) {
                this.showWelcomeModal();
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π —Ñ–æ–Ω
            this.applyBackground();
            
            // –í–ê–ñ–ù–û: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
            this.updateDisplay();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            this.initEventListeners();
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            this.switchTab('care');
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—â–µ —Ä–∞–∑ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∫–ª–∞–¥–∫–∏
            setTimeout(() => {
                this.updateDisplay();
            }, 100);
        }
        
        initEventListeners() {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
            document.addEventListener('click', (e) => {
                // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏
                if (e.target.id === 'editNameBtn') {
                    this.showNameEdit();
                } else if (e.target.id === 'saveNameBtn') {
                    this.saveNameEdit();
                } else if (e.target.id === 'cancelNameBtn') {
                    this.cancelNameEdit();
                }
                // –ó–≤—É–∫
                else if (e.target.id === 'soundToggle') {
                    this.toggleSound();
                }
                // –í–∫–ª–∞–¥–∫–∏
                else if (e.target.classList.contains('tab-btn')) {
                    this.switchTab(e.target.dataset.tab);
                }
                // –ú–∏–Ω–∏-–∏–≥—Ä—ã
                else if (e.target.id === 'cancelGameBtn') {
                    this.closeMiniGame();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –¥–ª—è –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏
            document.addEventListener('keypress', (e) => {
                if (e.target.id === 'nameInput' && e.key === 'Enter') {
                    this.saveNameEdit();
                }
            });
        }
        
        updateTimeAndWeather() {
            const hour = new Date().getHours();
            const timeElement = document.getElementById('timeOfDay');
            const weatherElement = document.getElementById('weather');
            
            if (hour >= 6 && hour < 12) timeElement.textContent = 'üåÖ';
            else if (hour >= 12 && hour < 18) timeElement.textContent = '‚òÄÔ∏è';
            else if (hour >= 18 && hour < 22) timeElement.textContent = 'üåÜ';
            else timeElement.textContent = 'üåô';
            
            const weathers = ['‚òÄÔ∏è', '‚òÅÔ∏è', 'üåßÔ∏è', '‚ùÑÔ∏è'];
            weatherElement.textContent = weathers[Math.floor(Math.random() * weathers.length)];
        }
        
        updateDisplay() {
            console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è...', {
                petName: this.petName,
                level: this.level,
                money: this.money,
                experience: this.experience,
                age: this.age
            });
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            const petNameDisplay = document.getElementById('petNameDisplay');
            const levelDisplay = document.getElementById('levelDisplay');
            const moneyDisplay = document.getElementById('moneyDisplay');
            const expDisplay = document.getElementById('expDisplay');
            const ageDisplay = document.getElementById('ageDisplay');
            const ageText = document.getElementById('ageText');
            const soundToggle = document.getElementById('soundToggle');
            
            if (petNameDisplay) {
                petNameDisplay.textContent = this.petName;
                console.log('‚úÖ –ò–º—è –ø–∏—Ç–æ–º—Ü–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:', this.petName);
            }
            if (levelDisplay) {
                levelDisplay.textContent = `Lv.${this.level}`;
                console.log('‚úÖ –£—Ä–æ–≤–µ–Ω—å –æ–±–Ω–æ–≤–ª–µ–Ω:', this.level);
            }
            if (moneyDisplay) {
                moneyDisplay.textContent = `üí∞${this.money}`;
                console.log('‚úÖ –î–µ–Ω—å–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', this.money);
            }
            if (expDisplay) {
                expDisplay.textContent = `‚≠ê${this.experience}/100`;
                console.log('‚úÖ –û–ø—ã—Ç –æ–±–Ω–æ–≤–ª–µ–Ω:', this.experience);
            }
            if (ageDisplay) ageDisplay.textContent = `üéÇ${this.age}–¥`;
            if (ageText) ageText.textContent = this.age;
            
            // –ó–≤—É–∫
            if (soundToggle) soundToggle.textContent = this.soundEnabled ? 'üîä' : 'üîá';
            
            // Telegram —Å—Ç–∞—Ç—É—Å (optional elements)
            const telegramBtn = document.getElementById('telegramBtn');
            const telegramStatus = document.getElementById('telegramStatus');
            
            if (telegramBtn && telegramStatus) {
                if (this.telegramConnected) {
                    telegramBtn.classList.add('hidden');
                    telegramStatus.classList.remove('hidden');
                } else {
                    telegramBtn.classList.remove('hidden');
                    telegramStatus.classList.add('hidden');
                }
            }
            
            // –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
            const mood = this.getMood();
            const moodEmoji = document.getElementById('moodEmoji');
            const moodStatus = document.getElementById('moodStatus');
            const evolutionStage = document.getElementById('evolutionStage');
            const petImage = document.getElementById('petImage');
            
            if (moodEmoji && mood) moodEmoji.textContent = mood.emoji;
            if (moodStatus && mood) moodStatus.textContent = mood.status;
            if (evolutionStage && this.evolutionStages && this.evolutionStages[this.evolutionStage]) {
                evolutionStage.textContent = this.evolutionStages[this.evolutionStage].name;
            }
            
            // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞
            if (petImage && this.skins && this.skins[this.currentSkin] && this.skins[this.currentSkin].image) {
                petImage.src = this.skins[this.currentSkin].image;
            }
            
            // –°–æ–Ω –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
            const sleepIndicator = document.getElementById('sleepIndicator');
            const criticalIndicator = document.getElementById('criticalIndicator');
            const moodIndicator = document.getElementById('moodIndicator');
            
            if (sleepIndicator) sleepIndicator.classList.toggle('hidden', !this.isSleeping);
            
            // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ stats –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
            if (this.stats && typeof this.stats === 'object') {
                const avgStats = Object.values(this.stats).reduce((a, b) => a + b, 0) / 6;
                if (criticalIndicator) criticalIndicator.classList.toggle('hidden', avgStats > 10);
            }
            
            if (moodIndicator && mood) {
                if (mood.emoji === 'ü•∞') moodIndicator.textContent = '‚ù§Ô∏è';
                else moodIndicator.textContent = '';
            }
            
            // –û–¥–µ–∂–¥–∞
            this.updateOutfit();
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            this.updateStatsDisplay();
        }
        
        updateOutfit() {
            const outfitContainer = document.getElementById('outfitContainer');
            const currentOutfitEl = document.getElementById('currentOutfit');
            
            if (!outfitContainer || !currentOutfitEl) return;
            
            outfitContainer.innerHTML = '';
            
            if (this.outfit !== 'default' && this.outfits && this.outfits[this.outfit]) {
                const outfitData = this.outfits[this.outfit];
                currentOutfitEl.textContent = `${outfitData.emoji} ${outfitData.name}`;
                currentOutfitEl.classList.remove('hidden');
                
                if (outfitData.image) {
                    const outfitImg = document.createElement('img');
                    outfitImg.src = outfitData.image;
                    outfitImg.className = 'absolute object-contain';
                    
                    if (this.outfit === 'cute') {
                        outfitImg.className += ' top-2 left-1/2 transform -translate-x-1/2 w-28 h-28';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'cool') {
                        outfitImg.className += ' top-8 left-1/2 transform -translate-x-1/2 w-16 h-8';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'formal') {
                        outfitImg.className += ' top-8 left-1/2 transform -translate-x-1/2 w-28 h-32';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'winter') {
                        outfitImg.className += ' top-6 left-1/2 transform -translate-x-1/2 w-30 h-34';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'summer') {
                        outfitImg.className += ' top-2 left-1/2 transform -translate-x-1/2 w-28 h-28';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'ninja') {
                        outfitImg.className += ' top-4 left-1/2 transform -translate-x-1/2 w-32 h-36';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'pirate') {
                        outfitImg.className += ' top-6 left-1/2 transform -translate-x-1/2 w-30 h-34';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'wizard') {
                        outfitImg.className += ' top-0 left-1/2 transform -translate-x-1/2 w-32 h-40';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'school') {
                        outfitImg.className += ' top-8 left-1/2 transform -translate-x-1/2 w-28 h-32';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'chef') {
                        outfitImg.className += ' top-2 left-1/2 transform -translate-x-1/2 w-30 h-34';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'superhero') {
                        outfitImg.className += ' top-4 left-1/2 transform -translate-x-1/2 w-32 h-36';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'princess') {
                        outfitImg.className += ' top-6 left-1/2 transform -translate-x-1/2 w-32 h-36';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'astronaut') {
                        outfitImg.className += ' top-2 left-1/2 transform -translate-x-1/2 w-32 h-38';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'detective') {
                        outfitImg.className += ' top-4 left-1/2 transform -translate-x-1/2 w-30 h-34';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'doctor') {
                        outfitImg.className += ' top-6 left-1/2 transform -translate-x-1/2 w-28 h-32';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'dancer') {
                        outfitImg.className += ' top-8 left-1/2 transform -translate-x-1/2 w-30 h-32';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'knight') {
                        outfitImg.className += ' top-4 left-1/2 transform -translate-x-1/2 w-32 h-36';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'vampire') {
                        outfitImg.className += ' top-2 left-1/2 transform -translate-x-1/2 w-34 h-38';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'angel') {
                        outfitImg.className += ' top-0 left-1/2 transform -translate-x-1/2 w-36 h-40';
                        outfitImg.style.zIndex = '10';
                    } else if (this.outfit === 'robot') {
                        outfitImg.className += ' top-2 left-1/2 transform -translate-x-1/2 w-34 h-38';
                        outfitImg.style.zIndex = '10';
                    }
                    
                    outfitContainer.appendChild(outfitImg);
                }
            } else {
                currentOutfitEl.classList.add('hidden');
            }
        }
        
        updateStatsDisplay() {
            const container = document.getElementById('statsContainer');
            if (!container) return;
            
            const stats = [
                { label: 'üçΩÔ∏è –ì–æ–ª–æ–¥', value: this.stats.hunger, color: 'bg-orange-500' },
                { label: 'üòä –°—á–∞—Å—Ç—å–µ', value: this.stats.happiness, color: 'bg-yellow-500' },
                { label: 'üõÅ –ß–∏—Å—Ç–æ—Ç–∞', value: this.stats.cleanliness, color: 'bg-blue-500' },
                { label: '‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ', value: this.stats.health, color: 'bg-red-500' },
                { label: '‚ö° –≠–Ω–µ—Ä–≥–∏—è', value: this.stats.energy, color: 'bg-green-500' },
                { label: 'üò¥ –°–æ–Ω', value: this.stats.sleep, color: 'bg-purple-500' }
            ];
            
            container.innerHTML = stats.map(stat => `
                <div class="mb-2">
                    <div class="flex justify-between mb-1">
                        <span class="text-xs font-medium">${stat.label}</span>
                        <span class="text-xs">${stat.value}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-1.5">
                        <div class="h-1.5 rounded-full transition-all duration-300 ${stat.color}" style="width: ${stat.value}%"></div>
                    </div>
                </div>
            `).join('');
        }
        
        getMood() {
            if (this.isSleeping) return { emoji: 'üò¥', status: '–°–ø–∏—Ç' };
            
            // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ stats
            if (!this.stats || typeof this.stats !== 'object') {
                return { emoji: 'üòê', status: '–ó–∞–≥—Ä—É–∑–∫–∞...' };
            }
            
            const avg = Object.values(this.stats).reduce((a, b) => a + b, 0) / 6;
            if (avg > 90) return { emoji: 'ü•∞', status: '–í–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω–æ' };
            if (avg > 80) return { emoji: 'üòä', status: '–û—á–µ–Ω—å —Å—á–∞—Å—Ç–ª–∏–≤' };
            if (avg > 60) return { emoji: 'üôÇ', status: '–°—á–∞—Å—Ç–ª–∏–≤' };
            if (avg > 40) return { emoji: 'üòê', status: '–ù–æ—Ä–º–∞–ª—å–Ω–æ' };
            if (avg > 20) return { emoji: 'üòü', status: '–ì—Ä—É—Å—Ç–Ω–æ' };
            if (avg > 10) return { emoji: 'üò¢', status: '–û—á–µ–Ω—å –≥—Ä—É—Å—Ç–Ω–æ' };
            return { emoji: 'üíÄ', status: '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ' };
        }
        
        showMessage(msg) {
            const messageEl = document.getElementById('gameMessage');
            messageEl.textContent = msg;
            messageEl.classList.remove('hidden');
            setTimeout(() => messageEl.classList.add('hidden'), 3000);
        }
        
        showNotification(message, type) {
            const notification = {
                id: Date.now(),
                message,
                type,
                timestamp: Date.now()
            };
            
            this.notifications.push(notification);
            
            const notificationEl = document.createElement('div');
            notificationEl.className = `p-3 rounded-lg shadow-lg text-white text-sm max-w-xs notification-enter ${this.getNotificationColor(type)}`;
            notificationEl.textContent = message;
            
            document.getElementById('notifications').appendChild(notificationEl);
            
            // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram
            this.sendTelegramNotification(message, type);
            
            setTimeout(() => {
                notificationEl.classList.add('notification-exit');
                setTimeout(() => {
                    if (notificationEl.parentNode) {
                        notificationEl.parentNode.removeChild(notificationEl);
                    }
                }, 300);
                this.notifications = this.notifications.filter(n => n.id !== notification.id);
            }, 5000);
        }
        
        getNotificationColor(type) {
            const colors = {
                reminder: 'bg-blue-500',
                sad: 'bg-red-500',
                sleepy: 'bg-purple-500',
                hungry: 'bg-orange-500',
                dirty: 'bg-blue-600',
                sick: 'bg-red-600',
                tired: 'bg-yellow-500'
            };
            return colors[type] || 'bg-gray-500';
        }
        
        showNameEdit() {
            document.getElementById('nameEditSection').classList.remove('hidden');
            document.getElementById('editNameBtn').classList.add('hidden');
            document.getElementById('nameInput').value = this.petName;
            document.getElementById('nameInput').focus();
        }
        
        saveNameEdit() {
            const newName = document.getElementById('nameInput').value.trim();
            if (newName && newName.length <= 15) {
                this.petName = newName;
                this.showMessage(`–¢–µ–ø–µ—Ä—å –∑–æ–≤—É—Ç ${this.petName}!`);
                this.saveData();
                this.updateDisplay();
            }
            this.cancelNameEdit();
        }
        
        cancelNameEdit() {
            document.getElementById('nameEditSection').classList.add('hidden');
            document.getElementById('editNameBtn').classList.remove('hidden');
        }
        
        toggleSound() {
            this.soundEnabled = !this.soundEnabled;
            this.updateDisplay();
            this.saveData();
        }
        
        playSound(frequency, duration = 200, type = 'sine') {
            if (!this.soundEnabled) return;
            
            try {
                if (!this.audioContext) {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(0.1, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration / 1000);
                
                oscillator.start();
                oscillator.stop(this.audioContext.currentTime + duration / 1000);
            } catch (error) {
                console.log('Sound not available');
            }
        }
        
        playHappySound() {
            this.playSound(523, 100);
            setTimeout(() => this.playSound(659, 100), 100);
            setTimeout(() => this.playSound(784, 150), 200);
        }
        
        switchTab(tab) {
            this.activeTab = tab;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–¥–∞–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É –∑–∞–¥–∞–Ω–∏–π
            if (tab === 'tasks') {
                if (this.validateTaskProgress) {
                    this.validateTaskProgress();
                }
                if (this.checkAllTasksStatus) {
                    this.checkAllTasksStatus();
                }
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.dataset.tab === tab) {
                    btn.className = 'tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors bg-purple-500 text-white whitespace-nowrap';
                } else {
                    btn.className = 'tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50 whitespace-nowrap';
                }
            });
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
            const content = document.getElementById('tabContent');
            content.innerHTML = this.getTabContent(tab);
        }
        
        getTabContent(tab) {
            switch (tab) {
                case 'care':
                    return this.getCareTabContent();
                case 'games':
                    return this.getGamesTabContent();
                case 'shop':
                    return this.getShopTabContent();
                case 'chests':
                    return this.getChestsTabContent();
                case 'pets':
                    return this.getPetsTabContent();
                case 'info':
                    return this.getInfoTabContent();
                default:
                    return '';
            }
        }
        
        getCareTabContent() {
            const foodGrid = this.food.map((item, index) => `
                <button onclick="game.feedPet(${index})" class="bg-orange-100 hover:bg-orange-200 p-2 rounded text-xs transition-colors" ${this.isSleeping ? 'disabled' : ''}>
                    <div class="text-sm">${item.emoji}</div>
                    <div class="font-medium text-xs">${item.name}</div>
                    <div class="text-xs text-gray-600">${item.price}üí∞</div>
                    ${item.happiness ? `<div class="text-xs text-yellow-600">+${item.happiness}üòä</div>` : ''}
                    ${item.health ? `<div class="text-xs text-red-600">+${item.health}‚ù§Ô∏è</div>` : ''}
                    ${item.energy ? `<div class="text-xs text-green-600">+${item.energy}‚ö°</div>` : ''}
                </button>
            `).join('');
            
            return `
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üçΩÔ∏è –ö–æ—Ä–º–ª–µ–Ω–∏–µ (${this.food.length} –≤–∏–¥–æ–≤ –µ–¥—ã)</h3>
                        <div class="grid grid-cols-3 gap-1 max-h-60 overflow-y-auto">${foodGrid}</div>
                    </div>
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">‚ö° –î–µ–π—Å—Ç–≤–∏—è</h3>
                        <div class="grid grid-cols-3 gap-1">
                            <button onclick="game.washPet()" class="bg-blue-100 hover:bg-blue-200 p-2 rounded text-xs transition-colors" ${this.isSleeping ? 'disabled' : ''}>
                                <div class="text-sm">üõÅ</div>
                                <div class="font-medium">–ú—ã—Ç—å</div>
                            </button>
                            <button onclick="game.healPet()" class="bg-red-100 hover:bg-red-200 p-2 rounded text-xs transition-colors">
                                <div class="text-sm">üíä</div>
                                <div class="font-medium">–õ–µ—á–∏—Ç—å</div>
                                <div class="text-xs">30üí∞</div>
                            </button>
                            <button onclick="game.toggleSleep()" class="bg-purple-100 hover:bg-purple-200 p-2 rounded text-xs transition-colors">
                                <div class="text-sm">${this.isSleeping ? '‚òÄÔ∏è' : 'üò¥'}</div>
                                <div class="font-medium">${this.isSleeping ? '–ë—É–¥–∏—Ç—å' : '–°–ø–∞—Ç—å'}</div>
                            </button>
                        </div>
                    </div>
                    
                    <!-- –°–æ–≤–º–µ—Å—Ç–Ω—ã–π —É—Ö–æ–¥ -->
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üë• –°–æ–≤–º–µ—Å—Ç–Ω—ã–π —É—Ö–æ–¥</h3>
                        <div class="bg-blue-50 p-3 rounded">
                            <div class="text-xs text-blue-800 mb-2">
                                <strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤:</strong> ${this.friendsList ? this.friendsList.length : 0}
                            </div>
                            <div class="text-xs text-blue-700">
                                üîπ –ò–≥—Ä–æ–∫–∏ –∑–∞–±–æ—Ç—è—Ç—Å—è –æ –ø–∏—Ç–æ–º—Ü–µ –≤–º–µ—Å—Ç–µ<br>
                                üîπ –ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –≤–µ—Å–µ–ª—å—è<br>
                                üîπ –í—ã—Å–æ–∫–∏–π —Å—Ç–∞—Ç—É—Å –¥–∞–µ—Ç –±–æ–ª—å—à–µ –º–æ–Ω–µ—Ç –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        getGamesTabContent() {
            const gamesGrid = this.miniGames.map((game, index) => `
                <button onclick="game.startMiniGame(${index})" class="p-2 rounded-lg text-xs transition-colors bg-yellow-100 hover:bg-yellow-200 flex flex-col items-center" ${this.isSleeping || this.stats.energy < 15 ? 'disabled' : ''}>
                    <span class="text-lg mb-1">${game.emoji}</span>
                    <div class="font-medium text-center">${game.name}</div>
                    <div class="text-xs text-gray-600 text-center">${game.description}</div>
                    <div class="text-xs text-red-600 mt-1">-15 —ç–Ω–µ—Ä–≥–∏–∏</div>
                </button>
            `).join('');
            
            return `
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã</h3>
                    <div class="grid grid-cols-2 gap-2">${gamesGrid}</div>
                </div>
            `;
        }
        
        getFriendsTabContent() {
            return `
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üë• –î—Ä—É–∑—å—è –∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                        
                        <!-- –ú–æ–π –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
                        <div class="bg-green-50 p-3 rounded mb-3">
                            <div class="text-sm font-bold text-green-800 mb-1">–í–∞—à –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:</div>
                            <div class="flex items-center justify-between">
                                <code class="bg-green-200 px-2 py-1 rounded font-mono text-sm">${this.inviteCode}</code>
                                <button onclick="navigator.clipboard.writeText('${this.inviteCode}'); game.showMessage('–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!')" 
                                        class="bg-green-500 text-white px-2 py-1 rounded text-xs">
                                    üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            </div>
                            <div class="text-xs text-green-700 mt-1">–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º –∫–æ–¥–æ–º —Å –¥—Ä—É–∑—å—è–º–∏!</div>
                        </div>
                        
                        <!-- –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞ -->
                        <div class="bg-blue-50 p-3 rounded mb-3">
                            <div class="text-sm font-bold text-blue-800 mb-2">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞:</div>
                            <div class="flex space-x-2">
                                <input type="text" id="friendCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥—Ä—É–≥–∞" 
                                    class="flex-1 px-2 py-1 border rounded text-sm">
                                <button onclick="game.inviteFriend(document.getElementById('friendCode').value)" 
                                        class="bg-blue-500 text-white px-3 py-1 rounded text-xs">
                                    –î–æ–±–∞–≤–∏—Ç—å
                                </button>
                            </div>
                            <div class="text-xs text-blue-700 mt-1">–ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞: +1 —Å—É–Ω–¥—É–∫, +100 –º–æ–Ω–µ—Ç!</div>
                        </div>
                        
                        <!-- –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π -->
                        <div class="bg-purple-50 p-3 rounded mb-3">
                            <div class="text-sm font-bold text-purple-800 mb-2">–ú–æ–∏ –¥—Ä—É–∑—å—è (${this.friendsList.length}):</div>
                            ${this.friendsList.length > 0 ? `
                                <div class="grid grid-cols-2 gap-2 max-h-24 overflow-y-auto">
                                    ${this.friendsList.map(friend => `
                                        <div class="bg-purple-100 p-2 rounded text-xs text-center">
                                            üë§ ${friend}
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<div class="text-xs text-purple-600">–ü–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –ø–µ—Ä–≤–æ–≥–æ!</div>'}
                        </div>
                        
                        <!-- –ù–∞–≥—Ä–∞–¥—ã –∑–∞ –¥—Ä—É–∑–µ–π -->
                        <div class="bg-yellow-50 p-3 rounded">
                            <div class="text-sm font-bold text-yellow-800 mb-2">üéÅ –ù–∞–≥—Ä–∞–¥—ã –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:</div>
                            <div class="text-xs text-yellow-700 space-y-1">
                                ${Object.entries(this.friendsSystem.inviteRewards).map(([count, reward]) => `
                                    <div class="flex justify-between ${this.friendsList.length >= count ? 'line-through text-green-600' : ''}">
                                        <span>${count} –¥—Ä—É–∑–µ–π:</span>
                                        <span>+${reward.chests}üì¶ +${reward.money}üí∞</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        getAchievementsTabContent() {
            return `
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (${this.unlockedAchievements.length}/${Object.keys(this.achievementsSystem).length})</h3>
                        
                        <div class="grid grid-cols-1 gap-2 max-h-64 overflow-y-auto">
                            ${Object.entries(this.achievementsSystem).map(([achievementId, achievement]) => {
                                const isUnlocked = this.unlockedAchievements.includes(achievementId);
                                return `
                                    <div class="p-3 rounded ${isUnlocked ? 'bg-green-50 border border-green-200' : 'bg-gray-50 border border-gray-200'}">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-lg ${isUnlocked ? '' : 'grayscale'}">${achievement.emoji}</span>
                                                <div>
                                                    <div class="font-medium text-sm ${isUnlocked ? 'text-green-800' : 'text-gray-600'}">${achievement.name}</div>
                                                    <div class="text-xs ${isUnlocked ? 'text-green-600' : 'text-gray-500'}">
                                                        ${achievement.reward.money ? `+${achievement.reward.money}üí∞ ` : ''}
                                                        ${achievement.reward.chests ? `+${achievement.reward.chests}üì¶` : ''}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="text-xl">${isUnlocked ? '‚úÖ' : 'üîí'}</div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∫ –Ω–æ–≤—ã–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º -->
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h4 class="font-bold mb-2 text-purple-800 text-sm">üìà –ü—Ä–æ–≥—Ä–µ—Å—Å:</h4>
                        <div class="space-y-2 text-xs">
                            <div class="flex justify-between">
                                <span>–£—Ä–æ–≤–µ–Ω—å:</span>
                                <span>${this.level}/10 –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–£—Ä–æ–≤–µ–Ω—å 10"</span>
                            </div>
                            <div class="flex justify-between">
                                <span>–î–µ–Ω—å–≥–∏:</span>
                                <span>${this.money}/10,000 –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "10,000 –º–æ–Ω–µ—Ç"</span>
                            </div>
                            <div class="flex justify-between">
                                <span>–î—Ä—É–∑—å—è:</span>
                                <span>${this.friendsList.length}/10 –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "10 –¥—Ä—É–∑–µ–π"</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        getShopTabContent() {
            const outfitsList = Object.entries(this.outfits).map(([key, item]) => `
                <button onclick="game.buyOutfit('${key}')" class="w-full p-2 rounded-lg text-xs transition-colors flex items-center justify-between ${
                    this.outfit === key ? 'bg-green-100 border-2 border-green-500' : 'bg-gray-100 hover:bg-gray-200'
                }">
                    <div class="flex items-center space-x-2">
                        <span class="text-lg">${item.emoji}</span>
                        <div class="text-left">
                            <div class="font-medium">${item.name}</div>
                            <div class="text-xs text-gray-500">${item.description}</div>
                            <div class="text-xs text-gray-600 font-bold">
                                ${item.price === 0 ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : `${item.price}üí∞`}
                            </div>
                        </div>
                    </div>
                    ${this.outfit === key ? '<span class="text-green-600 font-bold">‚úì</span>' : ''}
                </button>
            `).join('');

            const backgroundsList = Object.entries(this.backgrounds).map(([key, bg]) => `
                <button onclick="game.buyBackground('${key}')" class="w-full p-2 rounded-lg text-xs transition-colors flex items-center justify-between ${
                    this.currentBackground === key ? 'bg-green-100 border-2 border-green-500' : 'bg-gray-100 hover:bg-gray-200'
                }">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 rounded bg-gradient-to-br ${bg.gradient} flex items-center justify-center text-sm">
                            ${bg.emoji}
                        </div>
                        <div class="text-left">
                            <div class="font-medium">${bg.name}</div>
                            <div class="text-xs text-gray-500">${bg.description}</div>
                            <div class="text-xs text-gray-600 font-bold">
                                ${bg.price === 0 ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : `${bg.price}üí∞`}
                            </div>
                            ${!this.unlockedBackgrounds.includes(key) && bg.price > 0 ? 
                                '<div class="text-xs text-red-500">üîí –ù–µ –∫—É–ø–ª–µ–Ω</div>' : 
                                this.currentBackground === key ? '<div class="text-xs text-green-600">‚úÖ –ê–∫—Ç–∏–≤–µ–Ω</div>' : 
                                '<div class="text-xs text-blue-600">üì¶ –ö—É–ø–ª–µ–Ω</div>'
                            }
                        </div>
                    </div>
                    ${this.currentBackground === key ? '<span class="text-green-600 font-bold">‚úì</span>' : ''}
                </button>
            `).join('');
            
            return `
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üëó –ú–∞–≥–∞–∑–∏–Ω –æ–¥–µ–∂–¥—ã</h3>
                        <div class="grid grid-cols-1 gap-1 max-h-48 overflow-y-auto">${outfitsList}</div>
                    </div>

                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-3 text-purple-800 text-sm">üé® –ö–æ–ª–ª–µ–∫—Ü–∏—è —Ñ–æ–Ω–æ–≤ (${Object.keys(this.backgrounds).length} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)</h3>
                        
                        <div class="space-y-2 text-xs max-h-64 overflow-y-scroll scrollbar-hide" style="scrollbar-width: none; -ms-overflow-style: none;">
                            ${Object.entries(this.backgrounds).map(([key, bg]) => {
                                const isActive = this.currentBackground === key;
                                const isUnlocked = this.unlockedBackgrounds.includes(key);
                                
                                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∏–ª—å —Ä–∞–º–∫–∏ –∫–∞–∫ —É —Å—Ç–∞—Ç—É—Å–æ–≤ —Å –ø–æ–ª–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
                                let frameClass = '';
                                let bgClass = '';
                                let specialEffects = '';
                                let rarityIcon = '';
                                let priceClass = '';
                                let sparkles = '';
                                
                                if (bg.rarity === 'common') {
                                    frameClass = 'border-2 border-gray-300 shadow-sm';
                                    bgClass = 'bg-gray-50';
                                    rarityIcon = '‚ö™';
                                    priceClass = 'text-gray-700';
                                    specialEffects = 'hover:shadow-md transform transition-all duration-300';
                                } else if (bg.rarity === 'rare') {
                                    frameClass = 'border-2 border-blue-400 shadow-lg shadow-blue-200';
                                    bgClass = 'bg-gradient-to-br from-blue-50 to-blue-100';
                                    rarityIcon = 'üîµ';
                                    priceClass = 'text-blue-700';
                                    specialEffects = 'hover:shadow-xl hover:shadow-blue-300 transform transition-all duration-300 hover:scale-105';
                                } else if (bg.rarity === 'legendary') {
                                    frameClass = 'border-3 border-purple-400 shadow-xl shadow-purple-300';
                                    bgClass = 'bg-gradient-to-br from-purple-50 via-purple-100 to-pink-50';
                                    specialEffects = 'animate-pulse hover:shadow-2xl hover:shadow-purple-400 ring-1 ring-purple-200 hover:ring-2 hover:ring-purple-400 transform transition-all duration-500 hover:scale-105 hover:brightness-110';
                                    rarityIcon = 'üü£';
                                    priceClass = 'text-purple-700';
                                    sparkles = '<div class="absolute -top-1 -right-1 text-purple-400 animate-pulse">‚ú®</div>';
                                } else if (bg.rarity === 'mythic') {
                                    frameClass = 'border-4 border-gradient-to-r from-yellow-400 via-orange-400 to-red-400 shadow-2xl shadow-yellow-400';
                                    bgClass = 'bg-gradient-to-br from-yellow-50 via-yellow-100 to-orange-100';
                                    specialEffects = 'animate-pulse ring-4 ring-yellow-300 ring-opacity-75 ring-offset-2 hover:shadow-2xl hover:shadow-orange-400 hover:ring-6 hover:ring-yellow-400 hover:ring-opacity-100 transform transition-all duration-700 hover:scale-110 hover:brightness-125 hover:saturate-150 hover:contrast-110';
                                    rarityIcon = 'üü°';
                                    priceClass = 'text-yellow-700';
                                    sparkles = '<div class="absolute -top-2 -right-2 text-yellow-400 animate-spin text-lg">‚≠ê</div><div class="absolute -top-1 -left-1 text-orange-400 animate-pulse">‚ú®</div><div class="absolute -bottom-1 -right-1 text-yellow-300 animate-bounce">üí´</div>';
                                    
                                    // –û—Å–æ–±—ã–µ –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –≤—ã—Å—à–∏—Ö –º–∏—Ñ–∏—á–µ—Å–∫–∏—Ö
                                    if (key === 'divine') {
                                        specialEffects += ' hover:drop-shadow-2xl hover:drop-shadow-yellow-400 hover:hue-rotate-15';
                                        sparkles += '<div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white animate-pulse text-xs">üëë</div>';
                                    } else if (key === 'celestial') {
                                        specialEffects += ' hover:drop-shadow-2xl hover:drop-shadow-blue-400 hover:hue-rotate-30';
                                        sparkles += '<div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-blue-300 animate-pulse text-xs">‚≠ê</div>';
                                    } else if (key === 'infinity') {
                                        specialEffects += ' hover:drop-shadow-2xl hover:drop-shadow-purple-400 hover:hue-rotate-45 hover:animate-spin';
                                        sparkles += '<div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-purple-300 animate-spin text-sm">‚àû</div>';
                                    }
                                }
                                
                                return `
                                    <div onclick="game.buyBackground('${key}')" class="relative p-2 rounded-lg cursor-pointer ${frameClass} ${bgClass} ${specialEffects} ${isActive ? 'ring-2 ring-green-500 ring-offset-1 border-green-400' : ''} hover:-translate-y-0.5">
                                        ${sparkles}
                                        
                                        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –ø—Ä–µ–≤—å—é -->
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center space-x-2">
                                                <div class="relative w-10 h-10 rounded-lg bg-gradient-to-br ${bg.gradient} flex items-center justify-center text-lg shadow-md border border-white/70 ${bg.rarity === 'mythic' ? 'animate-pulse' : ''} overflow-hidden">
                                                    ${bg.emoji}
                                                    ${bg.rarity === 'mythic' ? '<div class="absolute inset-0 bg-gradient-to-br from-transparent via-white/20 to-transparent animate-pulse"></div>' : ''}
                                                </div>
                                                <div class="flex-1">
                                                    <div class="font-bold text-xs mb-1 ${isActive ? 'text-green-800' : bg.rarity === 'legendary' ? 'text-purple-800' : bg.rarity === 'mythic' ? 'text-yellow-800' : bg.rarity === 'rare' ? 'text-blue-800' : 'text-gray-800'}">${bg.name}</div>
                                                    <div class="text-xs ${isActive ? 'text-green-600' : 'text-gray-600'} mb-1">${bg.description}</div>
                                                    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–µ–≤—å—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ -->
                                                    <div class="w-16 h-2 rounded-full bg-gradient-to-r ${bg.gradient} border border-white/60 shadow-sm ${bg.rarity === 'mythic' ? 'animate-pulse' : ''}"></div>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                ${isActive ? '<div class="text-green-600 font-bold text-lg animate-bounce">‚úì</div>' : 
                                                !isUnlocked && bg.price > 0 ? '<div class="text-red-500 text-lg animate-pulse">üîí</div>' : 
                                                '<div class="text-blue-500 text-lg">üì¶</div>'}
                                            </div>
                                        </div>
                                        
                                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–¥–∫–æ—Å—Ç–∏ –∏ —Ü–µ–Ω–µ -->
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-1">
                                                <span class="px-2 py-0.5 rounded-full text-xs font-bold shadow-sm border ${
                                                    bg.rarity === 'common' ? 'bg-gray-200 text-gray-700 border-gray-300' :
                                                    bg.rarity === 'rare' ? 'bg-blue-200 text-blue-700 border-blue-300' :
                                                    bg.rarity === 'legendary' ? 'bg-purple-200 text-purple-700 border-purple-300 animate-pulse' :
                                                    'bg-yellow-200 text-yellow-700 border-yellow-300 animate-pulse'
                                                }">
                                                    ${rarityIcon} ${bg.rarity === 'common' ? '–û–±—ã—á–Ω—ã–π' :
                                                    bg.rarity === 'rare' ? '–†–µ–¥–∫–∏–π' :
                                                    bg.rarity === 'legendary' ? '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π' :
                                                    '–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π'}
                                                </span>
                                                ${bg.rarity === 'mythic' ? '<span class="text-xs animate-spin">‚ö°</span>' : ''}
                                                ${bg.rarity === 'legendary' ? '<span class="text-xs animate-pulse">‚ú®</span>' : ''}
                                            </div>
                                            <div class="text-right">
                                                <div class="font-bold text-xs ${bg.price === 0 ? 'text-green-600' : priceClass} ${bg.rarity === 'mythic' ? 'animate-pulse' : ''}">
                                                    ${bg.price === 0 ? 'üÜì –ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : `üí∞ ${bg.price.toLocaleString()}`}
                                                </div>
                                                ${isActive ? '<div class="text-xs text-green-600 font-bold animate-pulse">üåü –ê–∫—Ç–∏–≤–µ–Ω</div>' : 
                                                !isUnlocked && bg.price > 0 ? '<div class="text-xs text-red-500 animate-pulse">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</div>' : 
                                                isUnlocked && !isActive ? '<div class="text-xs text-blue-600">‚úÖ –í –∫–æ–ª–ª–µ–∫—Ü–∏–∏</div>' : ''}
                                            </div>
                                        </div>
                                        
                                        ${bg.rarity === 'mythic' ? `
                                            <div class="mt-1 text-center">
                                                <div class="text-xs font-bold ${priceClass} animate-pulse bg-gradient-to-r from-yellow-100 to-orange-100 px-1 py-0.5 rounded border border-yellow-300">
                                                    ‚ö° –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞ ‚ö°
                                                </div>
                                            </div>
                                        ` : ''}
                                        
                                        ${bg.rarity === 'legendary' ? `
                                            <div class="mt-1 text-center">
                                                <div class="text-xs font-bold ${priceClass} animate-pulse">
                                                    ‚ú® –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ –≤–µ–ª–∏–∫–æ–ª–µ–ø–∏–µ ‚ú®
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
                        <div class="mt-4 grid grid-cols-1 gap-3">
                            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ -->
                            <div class="p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200">
                                <h4 class="font-bold text-purple-800 mb-2 text-center">üìä –í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è</h4>
                                <div class="grid grid-cols-4 gap-2 text-xs text-center">
                                    <div class="bg-white/70 rounded p-2">
                                        <div class="font-bold text-gray-700">${this.unlockedBackgrounds.filter(key => this.backgrounds[key]?.rarity === 'common').length}</div>
                                        <div class="text-gray-600">‚ö™ –û–±—ã—á–Ω—ã—Ö</div>
                                    </div>
                                    <div class="bg-white/70 rounded p-2">
                                        <div class="font-bold text-blue-700">${this.unlockedBackgrounds.filter(key => this.backgrounds[key]?.rarity === 'rare').length}</div>
                                        <div class="text-blue-600">üîµ –†–µ–¥–∫–∏—Ö</div>
                                    </div>
                                    <div class="bg-white/70 rounded p-2">
                                        <div class="font-bold text-purple-700">${this.unlockedBackgrounds.filter(key => this.backgrounds[key]?.rarity === 'legendary').length}</div>
                                        <div class="text-purple-600">üü£ –õ–µ–≥–µ–Ω–¥.</div>
                                    </div>
                                    <div class="bg-white/70 rounded p-2">
                                        <div class="font-bold text-yellow-700">${this.unlockedBackgrounds.filter(key => this.backgrounds[key]?.rarity === 'mythic').length}</div>
                                        <div class="text-yellow-600">üü° –ú–∏—Ñ–∏—á.</div>
                                    </div>
                                </div>
                                <div class="text-center mt-2 text-xs text-purple-700">
                                    –°–æ–±—Ä–∞–Ω–æ: ${this.unlockedBackgrounds.length}/${Object.keys(this.backgrounds).length} —Ñ–æ–Ω–æ–≤
                                </div>
                            </div>
                            
                            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–¥–∫–æ—Å—Ç—è—Ö -->
                            <div class="p-3 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg border border-blue-200">
                                <h4 class="font-bold text-blue-800 mb-2 text-center">üé® –°–∏—Å—Ç–µ–º–∞ —Ä–µ–¥–∫–æ—Å—Ç–∏ —Ñ–æ–Ω–æ–≤</h4>
                                <div class="grid grid-cols-2 gap-1 text-xs">
                                    <div class="flex justify-between items-center p-1 bg-gray-100 rounded border-l-2 border-gray-400">
                                        <span><strong>‚ö™ –û–±—ã—á–Ω—ã–µ (9):</strong></span>
                                        <span class="font-bold text-gray-700">800-2,500üí∞</span>
                                    </div>
                                    <div class="flex justify-between items-center p-1 bg-blue-100 rounded border-l-2 border-blue-400">
                                        <span><strong>üîµ –†–µ–¥–∫–∏–µ (8):</strong></span>
                                        <span class="font-bold text-blue-700">3,500-8,000üí∞</span>
                                    </div>
                                    <div class="flex justify-between items-center p-1 bg-purple-100 rounded border-l-2 border-purple-400 animate-pulse">
                                        <span><strong>üü£ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ (8):</strong></span>
                                        <span class="font-bold text-purple-700">12,000-30,000üí∞</span>
                                    </div>
                                    <div class="flex justify-between items-center p-1 bg-yellow-100 rounded border-l-2 border-yellow-400 animate-pulse">
                                        <span><strong>üü° –ú–∏—Ñ–∏—á–µ—Å–∫–∏–µ (8):</strong></span>
                                        <span class="font-bold text-yellow-700">35,000-250,000üí∞</span>
                                    </div>
                                </div>
                                <div class="mt-2 p-2 bg-gradient-to-r from-purple-100 to-pink-100 rounded text-center border border-purple-200">
                                    <div class="font-bold text-purple-800 animate-pulse text-xs">üåü –§–æ–Ω—ã –≤–∏–¥–Ω—ã –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º –Ω–∞ —Ö–æ–ª—Å—Ç–µ! üåü</div>
                                    <div class="text-xs text-purple-700 mt-1">–í—Å–µ ${Object.keys(this.backgrounds).length} —Ñ–æ–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏!</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        getPetsTabContent() {
            return `
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üê∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞–º–∏</h3>
                    <button onclick="game.createNewPet()" class="w-full mb-3 p-3 bg-green-100 hover:bg-green-200 rounded-lg text-sm transition-colors">
                        ‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
                    </button>
                    <div class="bg-blue-50 p-3 rounded-lg">
                        <h4 class="font-bold text-sm text-blue-800 mb-2">üë• –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏–µ</h4>
                        <p class="text-xs text-blue-700">–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏!</p>
                    </div>
                </div>
            `;
        }
        
        getInfoTabContent() {
            return `
                <div class="space-y-3">

                    
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-3 text-purple-800 text-sm">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–µ</h3>
                        <div class="space-y-3 text-xs">
                            <div class="bg-blue-50 p-2 rounded">
                                <h4 class="font-bold text-blue-800 mb-1">üöÄ –ë—É–¥—É—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h4>
                                <p class="text-blue-700">–ë–æ—Ç –±—É–¥–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è! –û–∂–∏–¥–∞–π—Ç–µ:</p>
                                <ul class="list-disc list-inside text-blue-700 mt-1">
                                    <li>–ù–æ–≤—ã–µ –º–∏–Ω–∏-–∏–≥—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</li>
                                    <li>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∏–Ω—ã –∏ –æ–¥–µ–∂–¥–∞</li>
                                    <li>–û—Å–æ–±—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏</li>
                                    <li>–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —ç–≤–æ–ª—é—Ü–∏–∏</li>
                                    <li>–ú–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π!</li>
                                </ul>
                            </div>
                            <div class="bg-green-50 p-2 rounded">
                                <h4 class="font-bold text-green-800 mb-1">üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h4>
                                <ul class="list-disc list-inside text-green-700">
                                    <li>–ö–æ—Ä–º–∏—Ç–µ ${this.petName} –∫–æ–≥–¥–∞ –≥–æ–ª–æ–¥–µ–Ω</li>
                                    <li>–ò–≥—Ä–∞–π—Ç–µ –≤ –º–∏–Ω–∏-–∏–≥—Ä—ã –¥–ª—è –æ–ø—ã—Ç–∞</li>
                                    <li>–ü–æ–∫—É–ø–∞–π—Ç–µ –æ–¥–µ–∂–¥—É –∑–∞ –º–æ–Ω–µ—Ç—ã</li>
                                    <li>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—Å–µ–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏</li>
                                    <li>–í–∞—à –ø–∏—Ç–æ–º–µ—Ü —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º!</li>
                                </ul>
                            </div>
                            <div class="bg-purple-50 p-2 rounded">
                                <h4 class="font-bold text-purple-800 mb-1">‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</h4>
                                <ul class="list-disc list-inside text-purple-700">
                                    <li>20 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏-–∏–≥—Ä</li>
                                    <li>22 –≤–∏–¥–∞ –æ–¥–µ–∂–¥—ã</li>
                                    <li>6 —Ä–µ–¥–∫–∏—Ö —Å–∫–∏–Ω–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</li>
                                    <li>5 —Å—Ç–∞–¥–∏–π —ç–≤–æ–ª—é—Ü–∏–∏</li>
                                    <li>–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Å—Ç–∞—Ä–µ–Ω–∏–µ (1 –¥–µ–Ω—å = 1 –¥–µ–Ω—å)</li>
                                    <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                                    <li>–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</li>
                                    <li>–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏</li>
                                </ul>
                            </div>
                            <div class="bg-orange-50 p-2 rounded">
                                <h4 class="font-bold text-orange-800 mb-1">‚è∞ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h4>
                                <ul class="list-disc list-inside text-orange-700">
                                    <li>–ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç: "–¢—ã –Ω–µ –∑–∞–±—ã–ª –º–µ–Ω—è?"</li>
                                    <li>–ü—Ä–∏ –≥–æ–ª–æ–¥–µ < 50%: "–Ø –≥–æ–ª–æ–¥–µ–Ω!"</li>
                                    <li>–ü—Ä–∏ —Å—á–∞—Å—Ç—å–µ < 50%: "–ú–Ω–µ —Å–∫—É—á–Ω–æ!"</li>
                                    <li>–ü—Ä–∏ —Å–Ω–µ < 50%: "–Ø —Ö–æ—á—É —Å–ø–∞—Ç—å!"</li>
                                    <li>–ü—Ä–∏ –∑–¥–æ—Ä–æ–≤—å–µ < 50%: "–ú–Ω–µ –ø–ª–æ—Ö–æ!"</li>
                                    <li>–ü—Ä–∏ —á–∏—Å—Ç–æ—Ç–µ < 50%: "–Ø –≥—Ä—è–∑–Ω—ã–π!"</li>
                                </ul>
                            </div>
                            <div class="text-center text-gray-500">
                                <p>üê∞ –°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –¥–ª—è ${this.petName}! üíï</p>
                                <p class="text-xs mt-1">–í–µ—Ä—Å–∏—è 4.0 - Enhanced Save System</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
        feedPet(foodIndex) {
            if (this.isSleeping) {
                this.showMessage(`${this.petName} —Å–ø–∏—Ç! üò¥`);
                return;
            }
            
            const food = this.food[foodIndex];
            if (this.money >= food.price) {
                this.money -= food.price;
                this.stats.hunger = Math.min(100, this.stats.hunger + (food.hunger || 0));
                this.stats.happiness = Math.min(100, this.stats.happiness + (food.happiness || 0));
                this.stats.health = Math.min(100, this.stats.health + (food.health || 0));
                this.stats.energy = Math.min(100, this.stats.energy + (food.energy || 0));
                this.stats.cleanliness = Math.min(100, this.stats.cleanliness + (food.cleanliness || 0));
                
                // –ë–æ–ª—å—à–∏–π –±–æ–Ω—É—Å —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç –µ–¥—ã
                if (!food.energy) {
                    this.stats.energy = Math.min(100, this.stats.energy + 10);
                }
                
                // –ë–∞–∑–æ–≤—ã–π –æ–ø—ã—Ç
                let expGain = 10;
                
                // –ë–æ–Ω—É—Å –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
                if (this.activeEvent && this.activeEvent.id === 'double_exp') {
                    expGain *= 2;
                }
                
                this.experience += expGain;
                this.statusPoints += 5; // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
                
                // –î–µ–Ω–µ–∂–Ω—ã–π –±–æ–Ω—É—Å –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ (—Ç–æ–ª—å–∫–æ –ø–ª—é—Å –∫ –º–æ–Ω–µ—Ç–∞–º)
                if (this.statusSystem && this.statusSystem[this.currentStatus]) {
                    const status = this.statusSystem[this.currentStatus];
                    if (status.bonus && status.bonus.money > 0) {
                        this.money += status.bonus.money;
                    }
                }
                
                this.playSound(800, 150);
                this.showMessage(`${this.petName} —Å—ä–µ–ª ${food.name}! ${food.emoji} ${expGain > 10 ? `(+${expGain} –æ–ø—ã—Ç–∞!)` : ''}`);
                this.checkLevelUp();
                this.updateStatus();
                this.saveData();
                this.updateDisplay();
                this.updateStatusDisplay();
            } else {
                this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
            }
        }
        
        washPet() {
            if (this.isSleeping) {
                this.showMessage(`–ù–µ –±—É–¥–∏ —Å–ø—è—â–µ–≥–æ ${this.petName}! üò¥`);
                return;
            }
            
            this.stats.cleanliness = 100;
            this.stats.happiness = Math.min(100, this.stats.happiness + 10);
            this.experience += 8;
            
            this.playSound(400, 200);
            this.showMessage(`${this.petName} —á–∏—Å—Ç—ã–π –∏ —Å—á–∞—Å—Ç–ª–∏–≤—ã–π! üõÅ`);
            this.checkLevelUp();
            this.saveData();
            this.updateDisplay();
        }
        
        healPet() {
            if (this.money >= 30) {
                this.money -= 30;
                this.stats.health = 100;
                this.stats.happiness = Math.min(100, this.stats.happiness + 5);
                this.experience += 12;
                
                this.showMessage(`${this.petName} –∑–¥–æ—Ä–æ–≤! üíä`);
                this.checkLevelUp();
                this.saveData();
                this.updateDisplay();
            } else {
                this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ª–µ—á–µ–Ω–∏—è!');
            }
        }
        
        toggleSleep() {
            this.isSleeping = !this.isSleeping;
            
            if (this.isSleeping) {
                this.playSound(300, 500);
                this.showMessage(`${this.petName} –ª–æ–∂–∏—Ç—Å—è —Å–ø–∞—Ç—å... üò¥`);
            } else {
                this.playHappySound();
                this.showMessage(`${this.petName} –ø—Ä–æ—Å–Ω—É–ª—Å—è! üòä`);
            }
            
            this.saveData();
            this.updateDisplay();
            this.switchTab('care');
        }
        
        buyOutfit(outfitKey) {
            const outfit = this.outfits[outfitKey];
            
            if (this.outfit === outfitKey) {
                this.showMessage('–≠—Ç–∞ –æ–¥–µ–∂–¥–∞ —É–∂–µ –Ω–∞–¥–µ—Ç–∞!');
                return;
            }
            
            if (this.money >= outfit.price) {
                this.money -= outfit.price;
                this.outfit = outfitKey;
                this.stats.happiness = Math.min(100, this.stats.happiness + 20);
                
                this.playHappySound();
                this.showMessage(`–ù–æ–≤–∞—è –æ–¥–µ–∂–¥–∞: ${outfit.name}! ${outfit.emoji}`);
                this.saveData();
                this.updateDisplay();
                this.switchTab('shop');
            } else {
                this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
            }
        }
        
        createNewPet() {
            const newPetId = `pet${this.pets.length + 1}`;
            const newPet = {
                id: newPetId,
                name: `${this.petName} ${this.pets.length + 1}`,
                stats: { hunger: 100, happiness: 100, cleanliness: 100, health: 100, energy: 100, sleep: 100 },
                outfit: 'default',
                age: 0,
                evolutionStage: 'baby'
            };
            
            this.pets.push(newPet);
            this.activePetId = newPetId;
            this.showMessage(`–ù–æ–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü ${newPet.name} —Å–æ–∑–¥–∞–Ω! üéâ`);
            this.saveData();
        }
        
        startMiniGame(gameIndex) {
            if (this.isSleeping) {
                this.showMessage(`${this.petName} —Å–ø–∏—Ç! –†–∞–∑–±—É–¥–∏ –µ–≥–æ —Å–Ω–∞—á–∞–ª–∞! üò¥`);
                return;
            }
            if (this.stats.energy < 15) {
                this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏! –ù—É–∂–Ω–æ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å.');
                return;
            }
            
            this.currentMiniGame = this.miniGames[gameIndex];
            this.showMiniGameModal();
        }
        
        showMiniGameModal() {
            document.getElementById('gameTitle').textContent = `${this.currentMiniGame.name} ${this.currentMiniGame.emoji}`;
            document.getElementById('gameContent').innerHTML = this.getMiniGameContent();
            document.getElementById('miniGameModal').classList.remove('hidden');
        }
        
        closeMiniGame() {
            document.getElementById('miniGameModal').classList.add('hidden');
            this.currentMiniGame = null;
        }
        
        getMiniGameContent() {
            const gameId = this.currentMiniGame.id;
            
            if (gameId === 'memory') {
                return this.getMemoryGameContent();
            } else if (gameId === 'reaction') {
                return this.getReactionGameContent();
            } else if (gameId === 'math') {
                return this.getMathGameContent();
            } else if (gameId === 'puzzle') {
                return this.getPuzzleGameContent();
            } else if (gameId === 'quiz') {
                return this.getQuizGameContent();
            } else if (gameId === 'rhythm') {
                return this.getRhythmGameContent();
            } else if (gameId === 'treasure') {
                return this.getTreasureGameContent();
            } else if (gameId === 'balance') {
                return this.getBalanceGameContent();
            } else if (gameId === 'matching') {
                return this.getMatchingGameContent();
            } else if (gameId === 'simon') {
                return this.getSimonGameContent();
            } else if (gameId === 'catch') {
                return this.getCatchGameContent();
            } else if (gameId === 'target') {
                return this.getTargetGameContent();
            } else if (gameId === 'code') {
                return this.getCodeGameContent();
            } else if (gameId === 'stack') {
                return this.getStackGameContent();
            } else if (gameId === 'speed') {
                return this.getSpeedGameContent();
            } else if (gameId === 'maze') {
                return this.getMazeGameContent();
            } else if (gameId === 'pattern') {
                return this.getPatternGameContent();
            } else if (gameId === 'word') {
                return this.getWordGameContent();
            } else if (gameId === 'color') {
                return this.getColorGameContent();
            } else if (gameId === 'sequence') {
                return this.getSequenceGameContent();
            } else {
                // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–≥—Ä
                return `
                    <div class="text-center">
                        <p class="mb-4">${this.currentMiniGame.description}</p>
                        <p class="text-sm text-gray-600 mb-4">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å!</p>
                        <button onclick="game.completeMiniGame(${Math.random() > 0.3})" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold transition-colors">
                            –ò–≥—Ä–∞—Ç—å!
                        </button>
                    </div>
                `;
            }
        }
        
        getMemoryGameContent() {
            if (!this.gameState) this.gameState = 'waiting';
            
            return `
                <div class="text-center">
                    <p class="mb-4">–ó–∞–ø–æ–º–Ω–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ü–≤–µ—Ç–æ–≤!</p>
                    <div class="grid grid-cols-2 gap-2 mb-4">
                        <button onclick="game.handleMemoryClick(0)" class="h-16 bg-red-400 hover:bg-red-500 rounded transition-colors" id="memory-0">üî¥</button>
                        <button onclick="game.handleMemoryClick(1)" class="h-16 bg-blue-400 hover:bg-blue-500 rounded transition-colors" id="memory-1">üîµ</button>
                        <button onclick="game.handleMemoryClick(2)" class="h-16 bg-green-400 hover:bg-green-500 rounded transition-colors" id="memory-2">üü¢</button>
                        <button onclick="game.handleMemoryClick(3)" class="h-16 bg-yellow-400 hover:bg-yellow-500 rounded transition-colors" id="memory-3">üü°</button>
                    </div>
                    <button onclick="game.startMemorySequence()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded">
                        –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                    </button>
                </div>
            `;
        }
        
        getReactionGameContent() {
            return `
                <div class="text-center">
                    <p class="mb-4">–ù–∞–∂–º–∏ –Ω–∞ –∑–µ–ª–µ–Ω—ã–π —Å–∏–≥–Ω–∞–ª –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ!</p>
                    <div id="reaction-light" class="w-20 h-20 bg-red-400 rounded-full mx-auto mb-4 transition-colors"></div>
                    <button onclick="game.startReactionTest()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg">
                        –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç
                    </button>
                    <button onclick="game.reactionClick()" id="reaction-btn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg hidden">
                        –ù–ê–ñ–ú–ò!
                    </button>
                </div>
            `;
        }
        
        getMathGameContent() {
            const a = Math.floor(Math.random() * 10) + 1;
            const b = Math.floor(Math.random() * 10) + 1;
            const answer = a + b;
            this.mathAnswer = answer;
            
            const options = [answer - 1, answer, answer + 1].sort(() => Math.random() - 0.5);
            
            return `
                <div class="text-center">
                    <p class="text-2xl mb-6">${a} + ${b} = ?</p>
                    <div class="grid grid-cols-3 gap-2">
                        ${options.map(num => `
                            <button onclick="game.checkMathAnswer(${num})" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded text-xl transition-colors">
                                ${num}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        getPuzzleGameContent() {
            this.puzzlePieces = [1, 2, 3, 4].sort(() => Math.random() - 0.5);
            
            return `
                <div class="text-center">
                    <p class="mb-4">–†–∞—Å—Å—Ç–∞–≤—å —á–∏—Å–ª–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É (1, 2, 3, 4):</p>
                    <div class="grid grid-cols-4 gap-2 mb-4">
                        ${this.puzzlePieces.map((piece, index) => `
                            <button onclick="game.swapPuzzlePiece(${index})" class="bg-green-400 hover:bg-green-500 text-white p-4 rounded text-xl transition-colors">
                                ${piece}
                            </button>
                        `).join('')}
                    </div>
                    <p class="text-xs text-gray-600">–ù–∞–∂–º–∏ –Ω–∞ —á–∏—Å–ª–æ —á—Ç–æ–±—ã –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ —Å —Å–æ—Å–µ–¥–Ω–∏–º</p>
                </div>
            `;
        }
        
        getQuizGameContent() {
            const questions = [
                { q: '–ö–∞–∫–æ–≥–æ —Ü–≤–µ—Ç–∞ —Å–æ–ª–Ω—Ü–µ?', answers: ['–ñ–µ–ª—Ç–æ–µ', '–°–∏–Ω–µ–µ', '–ö—Ä–∞—Å–Ω–æ–µ'], correct: 0 },
                { q: '–°–∫–æ–ª—å–∫–æ –Ω–æ–≥ —É –∫–æ—Ç–∞?', answers: ['2', '4', '6'], correct: 1 },
                { q: '–ß—Ç–æ –µ–¥—è—Ç –∫—Ä–æ–ª–∏–∫–∏?', answers: ['–ú—è—Å–æ', '–ú–æ—Ä–∫–æ–≤—å', '–†—ã–±—É'], correct: 1 },
                { q: '–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª–µ?', answers: ['5', '6', '7'], correct: 2 },
                { q: '–ö–∞–∫–æ–π —Ü–≤–µ—Ç —É —Ç—Ä–∞–≤—ã?', answers: ['–ö—Ä–∞—Å–Ω—ã–π', '–ó–µ–ª–µ–Ω—ã–π', '–°–∏–Ω–∏–π'], correct: 1 }
            ];
            
            this.currentQuestion = questions[Math.floor(Math.random() * questions.length)];
            
            return `
                <div class="text-center">
                    <p class="text-lg mb-4">${this.currentQuestion.q}</p>
                    <div class="space-y-2">
                        ${this.currentQuestion.answers.map((answer, index) => `
                            <button onclick="game.checkQuizAnswer(${index})" class="w-full bg-purple-400 hover:bg-purple-500 text-white p-3 rounded transition-colors">
                                ${answer}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        getRhythmGameContent() {
            return `
                <div class="text-center">
                    <p class="mb-4">–ü–æ–≤—Ç–æ—Ä–∏ —Ä–∏—Ç–º: üî¥üîµüî¥üîµ</p>
                    <div class="flex justify-center space-x-4 mb-4">
                        <button onclick="game.addRhythmBeat(1)" class="w-16 h-16 bg-red-400 hover:bg-red-500 rounded-full text-2xl transition-colors">
                            üî¥
                        </button>
                        <button onclick="game.addRhythmBeat(0)" class="w-16 h-16 bg-blue-400 hover:bg-blue-500 rounded-full text-2xl transition-colors">
                            üîµ
                        </button>
                    </div>
                    <div id="rhythm-display" class="mb-4 text-lg">–í–∞—à —Ä–∏—Ç–º: </div>
                    <button onclick="game.checkRhythm()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
                        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                    </button>
                    <button onclick="game.resetRhythm()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded ml-2">
                        –°–±—Ä–æ—Å–∏—Ç—å
                    </button>
                </div>
            `;
        }
        
        getTreasureGameContent() {
            this.treasurePosition = Math.floor(Math.random() * 9);
            this.treasureAttempts = 0;
            
            return `
                <div class="text-center">
                    <p class="mb-4">–ù–∞–π–¥–∏ —Å–æ–∫—Ä–æ–≤–∏—â–µ! üíé</p>
                    <p class="mb-2 text-sm text-gray-600">–£ –≤–∞—Å 3 –ø–æ–ø—ã—Ç–∫–∏</p>
                    <div class="attempts-message text-center text-sm text-blue-600 mb-2">–ü–æ–ø—ã—Ç–æ–∫ –æ—Å—Ç–∞–ª–æ—Å—å: 3</div>
                    <div class="grid grid-cols-3 gap-2">
                        ${Array.from({length: 9}, (_, index) => `
                            <button onclick="game.checkTreasure(${index})" class="treasure-btn bg-yellow-400 hover:bg-yellow-500 text-white p-4 rounded h-16 text-2xl transition-colors">
                                ‚ùì
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        getBalanceGameContent() {
            this.balance = 50;
            this.balanceTimer = 10;
            
            return `
                <div class="text-center">
                    <p class="mb-2">–£–¥–µ—Ä–∂–∏ –±–∞–ª–∞–Ω—Å –≤ –∑–µ–ª–µ–Ω–æ–π –∑–æ–Ω–µ 10 —Å–µ–∫—É–Ω–¥!</p>
                    <p class="mb-4 text-lg font-bold">–í—Ä–µ–º—è: <span id="balance-timer">10</span>—Å</p>
                    <div class="relative h-8 bg-gray-300 rounded mb-4">
                        <div class="absolute top-0 h-8 bg-green-400 rounded" style="left: 30%; right: 30%;"></div>
                        <div class="absolute top-0 h-8 bg-red-400 rounded-l" style="left: 0%; right: 70%;"></div>
                        <div class="absolute top-0 h-8 bg-red-400 rounded-r" style="left: 70%; right: 0%;"></div>
                        <div id="balance-marker" class="absolute top-0 w-3 h-8 bg-blue-800 rounded transition-all duration-150" style="left: 50%; transform: translateX(-50%);"></div>
                    </div>
                    <div class="flex justify-center space-x-4">
                        <button onclick="game.adjustBalance(-5)" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded font-bold">
                            ‚¨ÖÔ∏è –í–ª–µ–≤–æ
                        </button>
                        <button onclick="game.adjustBalance(5)" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded font-bold">
                            –í–ø—Ä–∞–≤–æ ‚û°Ô∏è
                        </button>
                    </div>
                    <button onclick="game.startBalanceGame()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded mt-4">
                        –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                    </button>
                </div>
            `;
        }
        
        getMatchingGameContent() {
            const symbols = ['üçé', 'üçå', 'üçá', 'üçä'];
            this.matchingCards = [...symbols, ...symbols].sort(() => Math.random() - 0.5);
            this.flippedCards = [];
            this.matchedCards = [];
            
            return `
                <div class="text-center">
                    <p class="mb-4">–ù–∞–π–¥–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä—ã!</p>
                    <div class="grid grid-cols-4 gap-2">
                        ${this.matchingCards.map((card, index) => `
                            <button onclick="game.flipCard(${index})" id="card-${index}" class="h-16 w-16 bg-blue-400 hover:bg-blue-500 rounded text-2xl transition-colors">
                                ‚ùì
                            </button>
                        `).join('')}
                    </div>
                    <div class="text-xs text-gray-600 mt-2">
                        –ù–∞–π–¥–µ–Ω–æ –ø–∞—Ä: <span id="pairs-found">0</span> / 4
                    </div>
                </div>
            `;
        }
        
        getSimonGameContent() {
            return `
                <div class="text-center">
                    <p class="mb-4">–ü–æ–≤—Ç–æ—Ä–∏ –∫–æ–º–∞–Ω–¥—ã –°–∞–π–º–æ–Ω–∞!</p>
                    <div class="grid grid-cols-2 gap-2 mb-4">
                        <button onclick="game.simonClick(0)" id="simon-0" class="h-16 bg-red-400 hover:bg-red-500 rounded transition-colors">üî¥</button>
                        <button onclick="game.simonClick(1)" id="simon-1" class="h-16 bg-blue-400 hover:bg-blue-500 rounded transition-colors">üîµ</button>
                        <button onclick="game.simonClick(2)" id="simon-2" class="h-16 bg-green-400 hover:bg-green-500 rounded transition-colors">üü¢</button>
                        <button onclick="game.simonClick(3)" id="simon-3" class="h-16 bg-yellow-400 hover:bg-yellow-500 rounded transition-colors">üü°</button>
                    </div>
                    <button onclick="game.startSimonGame()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded">
                        –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                    </button>
                    <div id="simon-status" class="mt-2 text-sm text-gray-600"></div>
                </div>
            `;
        }
        
        getCatchGameContent() {
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
            setTimeout(() => this.startCatchGame(), 100);
            
            return `
                <div class="text-center">
                    <p class="mb-2">–ü–æ–π–º–∞–π –ø–∞–¥–∞—é—â–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã!</p>
                    <p id="catch-score" class="mb-4">–ü–æ–π–º–∞–Ω–æ: 0/5</p>
                    <div id="catch-game-area" class="relative w-full h-40 bg-blue-100 rounded border overflow-hidden">
                        <div id="catch-bucket" class="absolute bottom-0 w-12 h-6 bg-green-500 rounded-t transition-all duration-200 flex items-center justify-center text-xs" style="left: 50%; transform: translateX(-50%); z-index: 10;">
                            ü™£
                        </div>
                    </div>
                    <div class="flex justify-center space-x-4 mt-2">
                        <button onclick="game.moveCatchPlayer('left')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors">
                            ‚¨ÖÔ∏è –í–ª–µ–≤–æ
                        </button>
                        <button onclick="game.moveCatchPlayer('right')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors">
                            –í–ø—Ä–∞–≤–æ ‚û°Ô∏è
                        </button>
                    </div>
                    <div class="text-xs text-gray-600 mt-2">
                        15 —Å–µ–∫—É–Ω–¥ ‚Ä¢ –ù—É–∂–Ω–æ –ø–æ–π–º–∞—Ç—å 5 –∑–≤–µ–∑–¥–æ—á–µ–∫
                    </div>
                </div>
            `;
        }
        
        getTargetGameContent() {
            this.targetScore = 0;
            this.targetPos = { x: 50, y: 50 };
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
            this.startTargetGame();
            
            return `
                <div class="text-center">
                    <p class="mb-2">–ü–æ–ø–∞–¥–∏ –≤ –¥–≤–∏–∂—É—â—É—é—Å—è –º–∏—à–µ–Ω—å!</p>
                    <p id="target-score" class="mb-4">–ü–æ–ø–∞–¥–∞–Ω–∏–π: 0/3</p>
                    <div id="target-game-area" class="relative w-full h-40 bg-gray-200 rounded border">
                        <button id="moving-target" onclick="game.hitTarget()" class="absolute w-8 h-8 bg-red-500 rounded-full transition-all duration-300" style="left: 50%; top: 50%; transform: translate(-50%, -50%);">
                            üéØ
                        </button>
                    </div>
                    <p class="text-xs text-gray-600 mt-2">–ú–∏—à–µ–Ω—å –¥–≤–∏–∂–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 1.5 —Å–µ–∫—É–Ω–¥—ã!</p>
                </div>
            `;
        }
        
        getCodeGameContent() {
            this.secretCode = Array.from({length: 4}, () => Math.floor(Math.random() * 4));
            this.codeAttempt = [];
            
            return `
                <div class="text-center">
                    <p class="mb-4">–í–∑–ª–æ–º–∞–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥!</p>
                    <p class="mb-2 text-xs text-gray-600">–ö–æ–¥ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 —Ü–∏—Ñ—Ä (0-3)</p>
                    <div class="flex justify-center space-x-2 mb-4">
                        ${Array.from({length: 4}, (_, i) => `
                            <div id="code-slot-${i}" class="w-8 h-8 border-2 border-gray-400 rounded flex items-center justify-center bg-white">
                                ?
                            </div>
                        `).join('')}
                    </div>
                    <div class="grid grid-cols-4 gap-2 mb-3">
                        ${[0, 1, 2, 3].map(digit => `
                            <button onclick="game.enterCodeDigit(${digit})" class="bg-purple-400 hover:bg-purple-500 active:bg-purple-600 text-white p-3 rounded transition-colors font-bold text-lg">
                                ${digit}
                            </button>
                        `).join('')}
                    </div>
                    <button onclick="game.resetCode()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded transition-colors">
                        üîÑ –°–±—Ä–æ—Å–∏—Ç—å
                    </button>
                </div>
            `;
        }
        
        getStackGameContent() {
            // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
            setTimeout(() => this.startStackTimer(), 100);
            
            return `
                <div class="text-center">
                    <p class="mb-2">–°–æ–±–µ—Ä–∏ –±–∞—à–Ω—é –∏–∑ –±–ª–æ–∫–æ–≤!</p>
                    <p class="mb-2">–í—ã—Å–æ—Ç–∞: <span id="stack-height">0</span>/5</p>
                    <p class="mb-4">–í—Ä–µ–º—è: <span id="stack-timer">10</span>—Å</p>
                    <div id="stack-area" class="flex flex-col-reverse items-center h-32 justify-end mb-4 bg-gray-100 rounded border-2 border-dashed border-gray-300">
                    </div>
                    <button onclick="game.addStackBlock()" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded font-bold transition-colors active:scale-95">
                        üß± –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫
                    </button>
                    <div class="text-xs text-gray-600 mt-2">
                        –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –±–∞—à–Ω—é –≤—ã—Å–æ—Ç–æ–π 5 –±–ª–æ–∫–æ–≤ –∑–∞ 10 —Å–µ–∫—É–Ω–¥!
                    </div>
                </div>
            `;
        }
        
        getSpeedGameContent() {
            // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
            setTimeout(() => this.startSpeedTimer(), 100);
            
            return `
                <div class="text-center">
                    <p class="mb-2">–ù–∞–∂–º–∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ!</p>
                    <p class="mb-2">–ù–∞–∂–∞—Ç–∏–π: <span id="click-count">0</span>/20</p>
                    <p class="mb-4">–í—Ä–µ–º—è: <span id="speed-timer">5</span>—Å</p>
                    <button onclick="game.speedClick()" class="w-32 h-32 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white text-3xl rounded-full animate-pulse transition-all active:scale-95">
                        üí® –ö–õ–ò–ö!
                    </button>
                    <div class="text-xs text-gray-600 mt-2">
                        –¶–µ–ª—å: 20+ –∫–ª–∏–∫–æ–≤ –∑–∞ 5 —Å–µ–∫—É–Ω–¥
                    </div>
                </div>
            `;
        }
        
        completeMiniGame(success = null) {
            if (success === null) {
                success = Math.random() > 0.3; // 70% —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞
            }
            
            if (success && this.currentMiniGame) {
                const reward = this.currentMiniGame.reward;
                this.stats.happiness = Math.min(100, this.stats.happiness + (reward.happiness || 0));
                this.stats.energy = Math.max(0, this.stats.energy - 15);
                this.experience += reward.experience || 0;
                this.money += reward.money || 0;
                
                this.playHappySound();
                this.showMessage(`–û—Ç–ª–∏—á–Ω–æ! +${reward.experience} –æ–ø—ã—Ç–∞, +${reward.money} –º–æ–Ω–µ—Ç!`);
            } else {
                this.stats.energy = Math.max(0, this.stats.energy - 10);
                this.playSound(200, 300);
                this.showMessage('–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!');
            }
            
            this.checkLevelUp();
            this.saveData();
            this.updateDisplay();
            this.closeMiniGame();
        }
        
        // –ò–≥—Ä–∞ "–ü–∞–º—è—Ç—å"
        startMemorySequence() {
            this.memorySequence = Array.from({length: 4}, () => Math.floor(Math.random() * 4));
            this.userMemorySequence = [];
            this.currentMemoryStep = 0;
            this.showMemorySequence();
        }
        
        showMemorySequence() {
            if (this.currentMemoryStep < this.memorySequence.length) {
                const colorIndex = this.memorySequence[this.currentMemoryStep];
                const button = document.getElementById(`memory-${colorIndex}`);
                button.style.transform = 'scale(1.1)';
                button.style.boxShadow = '0 0 20px rgba(255,255,255,0.8)';
                
                setTimeout(() => {
                    button.style.transform = 'scale(1)';
                    button.style.boxShadow = 'none';
                    this.currentMemoryStep++;
                    setTimeout(() => this.showMemorySequence(), 300);
                }, 600);
            } else {
                this.showMessage('–¢–µ–ø–µ—Ä—å –ø–æ–≤—Ç–æ—Ä–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å!');
            }
        }
        
        handleMemoryClick(colorIndex) {
            if (this.currentMemoryStep >= this.memorySequence.length) {
                this.userMemorySequence.push(colorIndex);
                
                if (this.userMemorySequence[this.userMemorySequence.length - 1] !== this.memorySequence[this.userMemorySequence.length - 1]) {
                    this.completeMiniGame(false);
                    return;
                }
                
                if (this.userMemorySequence.length === this.memorySequence.length) {
                    this.completeMiniGame(true);
                }
            }
        }
        
        generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        }
        
        handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    this.importGameData(e.target.result);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞:', error);
                    this.showMessage('‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞!');
                }
            };
            reader.readAsText(file);
        }
        
        restoreFromBackupPrompt() {
            if (confirm('üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏?\n\n–≠—Ç–æ –∑–∞–º–µ–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.')) {
                if (this.restoreFromBackup()) {
                    this.showMessage('‚úÖ –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏!');
                    this.updateDisplay();
                    this.switchTab('care');
                } else {
                    this.showMessage('‚ùå –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞!');
                }
            }
        }
        
        resetGamePrompt() {
            const confirmation = prompt(`üóëÔ∏è –í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—Å–∏—Ç –∏–≥—Ä—É!\n\n–í—Å–µ –¥–∞–Ω–Ω—ã–µ, –≤–∫–ª—é—á–∞—è:\n‚Ä¢ –£—Ä–æ–≤–µ–Ω—å ${this.level} –∏ ${this.experience} –æ–ø—ã—Ç–∞\n‚Ä¢ ${this.money} –º–æ–Ω–µ—Ç\n‚Ä¢ ${this.unlockedSkins.length} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤\n‚Ä¢ ${this.chestCount} —Å—É–Ω–¥—É–∫–æ–≤\n‚Ä¢ –í–æ–∑—Ä–∞—Å—Ç ${this.age} –¥–Ω–µ–π\n\n–ù–∞–ø–∏—à–∏—Ç–µ "–°–ë–†–û–°" —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å:`);
            
            if (confirmation === '–°–ë–†–û–°') {
                // –û—á–∏—Å—Ç–∏—Ç—å localStorage
                const keysToRemove = [
                    'shared_labubu_stats', 'shared_labubu_money', 'shared_labubu_outfit',
                    'shared_labubu_level', 'shared_labubu_experience', 'shared_labubu_age',
                    'shared_labubu_evolution', 'shared_labubu_last_update', 'shared_pet_name',
                    'shared_labubu_sleeping', 'shared_labubu_pets', 'shared_active_pet_id',
                    'shared_current_skin', 'shared_unlocked_skins', 'shared_chest_count',
                    'shared_friends_invited', 'shared_last_chest_level', 'shared_labubu_last_notification',
                    'labubu_backup', 'labubu_backup_history'
                ];
                
                keysToRemove.forEach(key => {
                    localStorage.removeItem(key);
                });
                
                this.resetToDefaults();
                this.updateDisplay();
                this.switchTab('care');
                
                this.showMessage('üóëÔ∏è –ò–≥—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—à–µ–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –Ω–æ–≤—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –õ–∞–±—É–±—É!');
            } else {
                this.showMessage('‚ùå –°–±—Ä–æ—Å –æ—Ç–º–µ–Ω–µ–Ω.');
            }
        }
        

        
        async registerTelegramUser(chatId) {
            try {
                // URL –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
                const response = await fetch('https://labubu-server.onrender.com/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chatId: chatId,
                        gameUserId: this.gameUserId,
                        petName: this.petName
                    })
                });
                
                if (response.ok) {
                    this.telegramConnected = true;
                    this.telegramChatId = chatId;
                    localStorage.setItem('telegram_connected', 'true');
                    localStorage.setItem('telegram_chat_id', chatId);
                    
                    document.getElementById('telegramBtn').classList.add('hidden');
                    document.getElementById('telegramStatus').classList.remove('hidden');
                    
                    this.showMessage('‚úÖ Telegram —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                } else {
                    this.showMessage('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram');
                }
            } catch (error) {
                console.error('Telegram connection error:', error);
                this.showMessage('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }
        
        async sendTelegramNotification(message, type) {
            if (!this.telegramConnected) return;
            
            try {
                await fetch('https://labubu-server.onrender.com/api/notify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        gameUserId: this.gameUserId,
                        message: message,
                        type: type,
                        petName: this.petName
                    })
                });
            } catch (error) {
                console.error('Failed to send Telegram notification:', error);
            }
        }
        
        async saveToDatabaseAsync() {
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ)
            try {
                if (!this.gameUserId) {
                    console.log('‚ö†Ô∏è gameUserId –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î');
                    return false;
                }

                console.log('üåê –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...');

                const gameData = {
                    gameUserId: this.gameUserId,
                    petName: this.petName,
                    stats: this.stats,
                    level: this.level,
                    experience: this.experience,
                    money: this.money,
                    age: this.age,
                    outfit: this.outfit,
                    currentSkin: this.currentSkin,
                    unlockedSkins: this.unlockedSkins,
                    evolutionStage: this.evolutionStage,
                    chestCount: this.chestCount,
                    friendsInvited: this.friendsInvited,
                    lastChestLevel: this.lastChestLevel,
                    isSleeping: this.isSleeping,
                    lastUpdate: this.lastUpdate
                };

                const response = await fetch('https://labubu-server.onrender.com/api/save-game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(gameData),
                    signal: AbortSignal.timeout(8000) // 8 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                });

                if (response.ok) {
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö');
                    return true;
                } else {
                    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î:', response.status);
                    return false;
                }

            } catch (error) {
                console.warn('‚ö†Ô∏è –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ:', error.message);
                return false;
            }
        }

        async loadFromDatabaseSync() {
            // –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (–±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)
            try {
                if (!this.gameUserId) {
                    console.log('‚ö†Ô∏è gameUserId –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ –ë–î');
                    return false;
                }

                console.log('üåê –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...');

                const response = await fetch(`https://labubu-server.onrender.com/api/load-game/${this.gameUserId}`, {
                    method: 'GET',
                    signal: AbortSignal.timeout(8000) // 8 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
                });

                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.success && data.gameData) {
                        const gameData = data.gameData;
                        
                        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã –∏–∑ –ë–î, –ø—Ä–∏–º–µ–Ω—è–µ–º...');
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
                        this.stats = gameData.stats || {
                            hunger: 100, happiness: 100, cleanliness: 100,
                            health: 100, energy: 100, sleep: 100
                        };
                        this.money = gameData.money || 100;
                        this.level = gameData.level || 1;
                        this.experience = gameData.experience || 0;
                        this.age = gameData.age || 0;
                        this.outfit = gameData.outfit || 'default';
                        this.currentSkin = gameData.currentSkin || 'default';
                        this.unlockedSkins = gameData.unlockedSkins || ['default'];
                        this.evolutionStage = gameData.evolutionStage || 'baby';
                        this.chestCount = gameData.chestCount || 0;
                        this.friendsInvited = gameData.friendsInvited || 0;
                        this.lastChestLevel = gameData.lastChestLevel || 0;
                        this.isSleeping = gameData.isSleeping || false;
                        this.petName = gameData.petName || 'Labubu';
                        this.lastUpdate = gameData.lastUpdate || Date.now();
                        this.lastNotification = this.loadData('shared_labubu_last_notification', Date.now(), 'number');
                        
                        // –°—Ä–∞–∑—É —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –∫–∞–∫ –∫—ç—à
                        this.saveToLocalStorage();
                        
                        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage –∫–∞–∫ –∫—ç—à');
                        return true;
                    } else {
                        console.log('‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –ë–î');
                        return false;
                    }
                } else {
                    console.log('‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –ë–î –∏–ª–∏ –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                    return false;
                }

            } catch (error) {
                console.warn('‚ö†Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:', error.message);
                return false;
            }
        }

        async loadFromDatabaseAsync() {
            // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ–Ω–µ)
            try {
                if (!this.gameUserId) {
                    console.log('‚ö†Ô∏è gameUserId –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ –ë–î');
                    return;
                }

                console.log('üîÑ –§–æ–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –ë–î...');

                const response = await fetch(`https://labubu-server.onrender.com/api/load-game/${this.gameUserId}`, {
                    method: 'GET',
                    signal: AbortSignal.timeout(5000) // 5 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç
                });

                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.success && data.gameData) {
                        const gameData = data.gameData;
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î –Ω–æ–≤–µ–µ localStorage
                        const localLastUpdate = this.lastUpdate;
                        
                        if (gameData.lastUpdate > localLastUpdate) {
                            console.log('üîÑ –ù–∞–π–¥–µ–Ω—ã –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î, –æ–±–Ω–æ–≤–ª—è–µ–º...');
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
                            this.stats = gameData.stats || this.stats;
                            this.money = gameData.money || this.money;
                            this.level = gameData.level || this.level;
                            this.experience = gameData.experience || this.experience;
                            this.age = gameData.age || this.age;
                            this.outfit = gameData.outfit || this.outfit;
                            this.currentSkin = gameData.currentSkin || this.currentSkin;
                            this.unlockedSkins = gameData.unlockedSkins || this.unlockedSkins;
                            this.evolutionStage = gameData.evolutionStage || this.evolutionStage;
                            this.chestCount = gameData.chestCount || this.chestCount;
                            this.friendsInvited = gameData.friendsInvited || this.friendsInvited;
                            this.lastChestLevel = gameData.lastChestLevel || this.lastChestLevel;
                            this.isSleeping = gameData.isSleeping || this.isSleeping;
                            this.petName = gameData.petName || this.petName;
                            this.lastUpdate = gameData.lastUpdate || this.lastUpdate;
                            
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage –∫–∞–∫ –∫—ç—à
                            this.saveToLocalStorage();
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                            this.updateDisplay();
                            
                            console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
                            this.showMessage('üì± –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞!');
                        } else {
                            console.log('üì± –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã');
                        }
                    }
                }

            } catch (error) {
                console.warn('‚ö†Ô∏è –§–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:', error.message);
            }
        }

        saveToLocalStorage() {
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ localStorage (–±–µ–∑ –ë–î)
            this.saveValue('shared_labubu_stats', this.stats);
            this.saveValue('shared_labubu_money', this.money);
            this.saveValue('shared_labubu_outfit', this.outfit);
            this.saveValue('shared_labubu_level', this.level);
            this.saveValue('shared_labubu_experience', this.experience);
            this.saveValue('shared_labubu_age', this.age);
            this.saveValue('shared_labubu_evolution', this.evolutionStage);
            this.saveValue('shared_labubu_last_update', Date.now());
            this.saveValue('shared_pet_name', this.petName);
            this.saveValue('shared_labubu_sleeping', this.isSleeping);
            this.saveValue('shared_current_skin', this.currentSkin);
            this.saveValue('shared_unlocked_skins', this.unlockedSkins);
            this.saveValue('shared_chest_count', this.chestCount);
            this.saveValue('shared_friends_invited', this.friendsInvited);
            this.saveValue('shared_last_chest_level', this.lastChestLevel);
            this.saveValue('shared_labubu_last_notification', this.lastNotification);
            this.saveValue('current_background', this.currentBackground);
            this.saveValue('unlocked_backgrounds', this.unlockedBackgrounds);
        }
        
        // –ò–≥—Ä–∞ "–†–µ–∞–∫—Ü–∏—è"
        startReactionTest() {
            const light = document.getElementById('reaction-light');
            const btn = document.getElementById('reaction-btn');
            light.className = 'w-20 h-20 bg-red-400 rounded-full mx-auto mb-4 transition-colors';
            btn.classList.add('hidden');
            
            const delay = 2000 + Math.random() * 3000;
            this.reactionStartTime = Date.now() + delay;
            
            setTimeout(() => {
                light.className = 'w-20 h-20 bg-green-500 rounded-full mx-auto mb-4 transition-colors animate-pulse';
                btn.classList.remove('hidden');
                this.reactionStarted = true;
            }, delay);
        }
        
        reactionClick() {
            if (this.reactionStarted) {
                const reactionTime = Date.now() - this.reactionStartTime;
                this.completeMiniGame(reactionTime < 1000);
            }
        }
        
        // –ò–≥—Ä–∞ "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"
        checkMathAnswer(answer) {
            this.completeMiniGame(answer === this.mathAnswer);
        }
        
        // –ò–≥—Ä–∞ "–ü–∞–∑–ª"
        swapPuzzlePiece(index) {
            if (index < this.puzzlePieces.length - 1) {
                [this.puzzlePieces[index], this.puzzlePieces[index + 1]] = [this.puzzlePieces[index + 1], this.puzzlePieces[index]];
                
                // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                const content = this.getPuzzleGameContent();
                document.getElementById('gameContent').innerHTML = content;
                
                if (JSON.stringify(this.puzzlePieces) === JSON.stringify([1, 2, 3, 4])) {
                    this.completeMiniGame(true);
                }
            }
        }
        
        // –ò–≥—Ä–∞ "–í–∏–∫—Ç–æ—Ä–∏–Ω–∞"
        checkQuizAnswer(answerIndex) {
            this.completeMiniGame(answerIndex === this.currentQuestion.correct);
        }
        
        // –ò–≥—Ä–∞ "–†–∏—Ç–º"
        addRhythmBeat(beat) {
            if (!this.userRhythm) this.userRhythm = [];
            this.userRhythm.push(beat);
            
            const display = document.getElementById('rhythm-display');
            display.textContent = '–í–∞—à —Ä–∏—Ç–º: ' + this.userRhythm.map(b => b === 1 ? 'üî¥' : 'üîµ').join('');
        }
        
        checkRhythm() {
            const targetRhythm = [1, 0, 1, 0]; // üî¥üîµüî¥üîµ
            this.completeMiniGame(JSON.stringify(this.userRhythm) === JSON.stringify(targetRhythm));
        }
        
        resetRhythm() {
            this.userRhythm = [];
            document.getElementById('rhythm-display').textContent = '–í–∞—à —Ä–∏—Ç–º: ';
        }
        
        // –ò–≥—Ä–∞ "–ö–ª–∞–¥" (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        checkTreasure(position) {
            if (!this.treasureAttempts) this.treasureAttempts = 0;
            
            if (position === this.treasurePosition) {
                // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–∫—Ä–æ–≤–∏—â–µ
                const buttons = document.querySelectorAll('#gameContent .treasure-btn');
                if (buttons[position]) {
                    buttons[position].textContent = 'üíé';
                    buttons[position].className = 'treasure-btn bg-green-500 text-white p-4 rounded h-16 text-2xl animate-pulse';
                }
                setTimeout(() => this.completeMiniGame(true), 1000);
            } else {
                this.treasureAttempts++;
                const attemptsLeft = 3 - this.treasureAttempts;
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
                const buttons = document.querySelectorAll('#gameContent .treasure-btn');
                if (buttons[position]) {
                    buttons[position].textContent = '‚ùå';
                    buttons[position].disabled = true;
                    buttons[position].className = 'treasure-btn bg-red-400 text-white p-4 rounded h-16 text-2xl';
                }
                
                if (attemptsLeft > 0) {
                    // –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–ø—ã—Ç–∫–∞—Ö
                    const messageEl = document.querySelector('#gameContent .attempts-message');
                    if (messageEl) {
                        messageEl.textContent = `–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: ${attemptsLeft}`;
                        messageEl.className = 'attempts-message text-center text-sm text-red-600 mt-2';
                    }
                } else {
                    // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∫—Ä–æ–≤–∏—â–∞
                    if (buttons[this.treasurePosition]) {
                        buttons[this.treasurePosition].textContent = 'üíé';
                        buttons[this.treasurePosition].className = 'treasure-btn bg-yellow-500 text-white p-4 rounded h-16 text-2xl animate-pulse';
                    }
                    setTimeout(() => this.completeMiniGame(false), 1500);
                }
            }
        }
        
        // –ò–≥—Ä–∞ "–ë–∞–ª–∞–Ω—Å"
        startBalanceGame() {
            this.balance = 50;
            this.balanceTimer = 10;
            this.balanceInterval = setInterval(() => {
                this.balanceTimer--;
                document.getElementById('balance-timer').textContent = this.balanceTimer;
                
                if (this.balanceTimer <= 0) {
                    clearInterval(this.balanceInterval);
                    this.completeMiniGame(true);
                }
                
                // –°–ª—É—á–∞–π–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                this.balance += (Math.random() - 0.5) * 4;
                this.balance = Math.max(0, Math.min(100, this.balance));
                
                const marker = document.getElementById('balance-marker');
                marker.style.left = this.balance + '%';
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–≤–∞–ª
                if (this.balance < 25 || this.balance > 75) {
                    clearInterval(this.balanceInterval);
                    this.completeMiniGame(false);
                }
            }, 1000);
        }
        
        adjustBalance(amount) {
            this.balance += amount;
            this.balance = Math.max(0, Math.min(100, this.balance));
            
            const marker = document.getElementById('balance-marker');
            marker.style.left = this.balance + '%';
        }
        
        // –ò–≥—Ä–∞ "–ù–∞–π–¥–∏ –ø–∞—Ä—É"
        flipCard(index) {
            if (this.flippedCards.length < 2 && !this.flippedCards.includes(index) && !this.matchedCards.includes(index)) {
                this.flippedCards.push(index);
                const card = document.getElementById(`card-${index}`);
                card.textContent = this.matchingCards[index];
                card.className = 'h-16 w-16 bg-green-200 rounded text-2xl transition-colors';
                
                if (this.flippedCards.length === 2) {
                    setTimeout(() => {
                        if (this.matchingCards[this.flippedCards[0]] === this.matchingCards[this.flippedCards[1]]) {
                            this.matchedCards.push(...this.flippedCards);
                            document.getElementById('pairs-found').textContent = this.matchedCards.length / 2;
                            
                            if (this.matchedCards.length === this.matchingCards.length) {
                                this.completeMiniGame(true);
                            }
                        } else {
                            this.flippedCards.forEach(i => {
                                const card = document.getElementById(`card-${i}`);
                                card.textContent = '‚ùì';
                                card.className = 'h-16 w-16 bg-blue-400 hover:bg-blue-500 rounded text-2xl transition-colors';
                            });
                        }
                        this.flippedCards = [];
                    }, 1000);
                }
            }
        }
        
        // –ò–≥—Ä–∞ "–°–∞–π–º–æ–Ω –≥–æ–≤–æ—Ä–∏—Ç"
        startSimonGame() {
            this.simonSequence = Array.from({length: 5}, () => Math.floor(Math.random() * 4));
            this.userSimonSequence = [];
            this.currentSimonStep = 0;
            this.showSimonSequence();
        }
        
        showSimonSequence() {
            if (this.currentSimonStep < this.simonSequence.length) {
                const colorIndex = this.simonSequence[this.currentSimonStep];
                const button = document.getElementById(`simon-${colorIndex}`);
                button.style.transform = 'scale(1.2)';
                button.style.filter = 'brightness(1.5)';
                
                setTimeout(() => {
                    button.style.transform = 'scale(1)';
                    button.style.filter = 'brightness(1)';
                    this.currentSimonStep++;
                    setTimeout(() => this.showSimonSequence(), 300);
                }, 600);
            } else {
                document.getElementById('simon-status').textContent = '–¢–µ–ø–µ—Ä—å –ø–æ–≤—Ç–æ—Ä–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å!';
            }
        }
        
        simonClick(colorIndex) {
            if (this.currentSimonStep >= this.simonSequence.length) {
                this.userSimonSequence.push(colorIndex);
                
                if (this.userSimonSequence[this.userSimonSequence.length - 1] !== this.simonSequence[this.userSimonSequence.length - 1]) {
                    this.completeMiniGame(false);
                    return;
                }
                
                if (this.userSimonSequence.length === this.simonSequence.length) {
                    this.completeMiniGame(true);
                }
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–ü–æ–π–º–∞–π –ø—Ä–µ–¥–º–µ—Ç" (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        startCatchGame() {
            this.fallingItems = [];
            this.catchScore = 0;
            this.playerPos = 50;
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫
            this.updateCatchGameDisplay();
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞–¥–∞—é—â–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
            this.catchSpawnInterval = setInterval(() => {
                const newItem = {
                    id: Date.now() + Math.random(),
                    x: Math.random() * 80 + 10,
                    y: 0
                };
                this.fallingItems.push(newItem);
            }, 800);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
            this.catchUpdateInterval = setInterval(() => {
                // –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –≤—Å–µ—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                this.fallingItems = this.fallingItems.map(item => ({
                    ...item,
                    y: item.y + 5
                })).filter(item => {
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –∫–æ—Ä–∑–∏–Ω–æ–π
                    if (item.y >= 75 && item.y <= 85 && Math.abs(item.x - this.playerPos) < 15) {
                        this.catchScore++;
                        this.updateCatchGameDisplay();
                        
                        if (this.catchScore >= 5) {
                            this.endCatchGame(true);
                            return false;
                        }
                        return false; // –£–¥–∞–ª–∏—Ç—å –ø–æ–π–º–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
                    }
                    
                    // –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ —É–ø–∞–ª–∏
                    return item.y <= 100;
                });
                
                this.renderFallingItems();
            }, 100);
            
            // –ó–∞–∫–æ–Ω—á–∏—Ç—å –∏–≥—Ä—É —á–µ—Ä–µ–∑ 15 —Å–µ–∫—É–Ω–¥
            this.catchGameTimeout = setTimeout(() => {
                this.endCatchGame(this.catchScore >= 5);
            }, 15000);
        }
        
        endCatchGame(success) {
            if (this.catchSpawnInterval) clearInterval(this.catchSpawnInterval);
            if (this.catchUpdateInterval) clearInterval(this.catchUpdateInterval);
            if (this.catchGameTimeout) clearTimeout(this.catchGameTimeout);
            
            this.completeMiniGame(success);
        }
        
        updateCatchGameDisplay() {
            const scoreElement = document.getElementById('catch-score');
            if (scoreElement) {
                scoreElement.textContent = `–ü–æ–π–º–∞–Ω–æ: ${this.catchScore}/5`;
            }
        }
        
        moveCatchPlayer(direction) {
            if (direction === 'left') {
                this.playerPos = Math.max(10, this.playerPos - 15);
            } else if (direction === 'right') {
                this.playerPos = Math.min(90, this.playerPos + 15);
            }
            
            const bucket = document.getElementById('catch-bucket');
            if (bucket) {
                bucket.style.left = this.playerPos + '%';
            }
        }
        
        renderFallingItems() {
            const gameArea = document.getElementById('catch-game-area');
            if (!gameArea) return;
            
            // –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
            const oldItems = gameArea.querySelectorAll('.falling-item');
            oldItems.forEach(item => item.remove());
            
            // –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã
            this.fallingItems.forEach((item) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'falling-item absolute w-6 h-6 bg-yellow-400 rounded-full cursor-pointer flex items-center justify-center text-xs';
                itemElement.style.left = item.x + '%';
                itemElement.style.top = item.y + '%';
                itemElement.style.transform = 'translate(-50%, -50%)';
                itemElement.innerHTML = '‚≠ê';
                itemElement.style.zIndex = '5';
                gameArea.appendChild(itemElement);
            });
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–ü–æ–ø–∞–¥–∏ –≤ —Ü–µ–ª—å" (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        startTargetGame() {
            this.targetScore = 0;
            this.targetPos = { x: 50, y: 50 };
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫
            const scoreElement = document.getElementById('target-score');
            if (scoreElement) {
                scoreElement.textContent = `–ü–æ–ø–∞–¥–∞–Ω–∏–π: 0/3`;
            }
            
            // –ü–µ—Ä–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –º–∏—à–µ–Ω–∏
            this.moveTarget();
            
            // –ò–Ω—Ç–µ—Ä–≤–∞–ª –¥–≤–∏–∂–µ–Ω–∏—è –º–∏—à–µ–Ω–∏
            this.targetGameInterval = setInterval(() => {
                this.moveTarget();
            }, 1500);
            
            // –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            this.targetGameTimeout = setTimeout(() => {
                if (this.targetGameInterval) {
                    clearInterval(this.targetGameInterval);
                    this.completeMiniGame(this.targetScore >= 3);
                }
            }, 10000);
        }
        
        moveTarget() {
            this.targetPos = {
                x: Math.random() * 70 + 15, // –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã
                y: Math.random() * 70 + 15
            };
            
            const target = document.getElementById('moving-target');
            if (target) {
                target.style.left = this.targetPos.x + '%';
                target.style.top = this.targetPos.y + '%';
                target.style.transition = 'all 0.3s ease';
            }
        }
        
        hitTarget() {
            this.targetScore++;
            const scoreElement = document.getElementById('target-score');
            if (scoreElement) {
                scoreElement.textContent = `–ü–æ–ø–∞–¥–∞–Ω–∏–π: ${this.targetScore}/3`;
            }
            
            // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
            const target = document.getElementById('moving-target');
            if (target) {
                target.style.transform = 'translate(-50%, -50%) scale(1.2)';
                setTimeout(() => {
                    target.style.transform = 'translate(-50%, -50%) scale(1)';
                }, 200);
            }
            
            if (this.targetScore >= 3) {
                clearInterval(this.targetGameInterval);
                clearTimeout(this.targetGameTimeout);
                this.completeMiniGame(true);
            } else {
                // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –º–∏—à–µ–Ω—å –ø–æ—Å–ª–µ –ø–æ–ø–∞–¥–∞–Ω–∏—è
                setTimeout(() => this.moveTarget(), 300);
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–í–∑–ª–æ–º–∞–π –∫–æ–¥" (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        enterCodeDigit(digit) {
            if (this.codeAttempt.length < 4) {
                this.codeAttempt.push(digit);
                
                const slot = document.getElementById(`code-slot-${this.codeAttempt.length - 1}`);
                if (slot) {
                    slot.textContent = digit;
                    slot.className = 'w-8 h-8 border-2 border-blue-400 rounded flex items-center justify-center bg-blue-50 font-bold';
                }
                
                if (this.codeAttempt.length === 4) {
                    // –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏
                    for (let i = 0; i < 4; i++) {
                        const slot = document.getElementById(`code-slot-${i}`);
                        if (slot) {
                            slot.className = 'w-8 h-8 border-2 border-yellow-400 rounded flex items-center justify-center bg-yellow-100 font-bold animate-pulse';
                        }
                    }
                    
                    setTimeout(() => {
                        if (JSON.stringify(this.codeAttempt) === JSON.stringify(this.secretCode)) {
                            // –ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
                            for (let i = 0; i < 4; i++) {
                                const slot = document.getElementById(`code-slot-${i}`);
                                if (slot) {
                                    slot.className = 'w-8 h-8 border-2 border-green-500 rounded flex items-center justify-center bg-green-100 font-bold';
                                }
                            }
                            setTimeout(() => this.completeMiniGame(true), 1000);
                        } else {
                            // –ö–æ–¥ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
                            for (let i = 0; i < 4; i++) {
                                const slot = document.getElementById(`code-slot-${i}`);
                                if (slot) {
                                    slot.className = 'w-8 h-8 border-2 border-red-500 rounded flex items-center justify-center bg-red-100 font-bold animate-bounce';
                                }
                            }
                            
                            setTimeout(() => {
                                this.resetCode();
                                this.showMessage('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥! –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑.');
                            }, 1500);
                        }
                    }, 1000);
                }
            }
        }
        
        resetCode() {
            this.codeAttempt = [];
            for (let i = 0; i < 4; i++) {
                const slot = document.getElementById(`code-slot-${i}`);
                if (slot) {
                    slot.textContent = '?';
                    slot.className = 'w-8 h-8 border-2 border-gray-400 rounded flex items-center justify-center bg-white';
                }
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–°–æ–±–µ—Ä–∏ –±–∞—à–Ω—é" (–ò–°–ü–†–ê–í–õ–ï–ù–û)
        startStackTimer() {
            this.stackHeight = 0;
            this.stackTimer = 10;
            
            this.stackTimerInterval = setInterval(() => {
                this.stackTimer--;
                const timerElement = document.getElementById('stack-timer');
                if (timerElement) {
                    timerElement.textContent = this.stackTimer;
                }
                
                if (this.stackTimer <= 0) {
                    clearInterval(this.stackTimerInterval);
                    this.completeMiniGame(this.stackHeight >= 5);
                }
            }, 1000);
        }
        
        addStackBlock() {
            if (this.stackTimer <= 0) return;
            
            this.stackHeight++;
            
            const heightElement = document.getElementById('stack-height');
            if (heightElement) {
                heightElement.textContent = this.stackHeight;
            }
            
            const stackArea = document.getElementById('stack-area');
            if (stackArea) {
                const block = document.createElement('div');
                block.className = 'w-16 h-6 bg-orange-400 border border-orange-600 mb-1 rounded';
                block.style.animation = 'fadeIn 0.2s ease-in';
                stackArea.appendChild(block);
            }
            
            if (this.stackHeight >= 5) {
                clearInterval(this.stackTimerInterval);
                this.completeMiniGame(true);
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–°–∫–æ—Ä–æ—Å—Ç—å"
        startSpeedTimer() {
            this.clickCount = 0;
            this.speedTimer = 5;
            
            this.speedTimerInterval = setInterval(() => {
                this.speedTimer--;
                const timerElement = document.getElementById('speed-timer');
                if (timerElement) {
                    timerElement.textContent = this.speedTimer;
                }
                
                if (this.speedTimer <= 0) {
                    clearInterval(this.speedTimerInterval);
                    this.completeMiniGame(this.clickCount >= 20);
                }
            }, 1000);
        }
        
        speedClick() {
            if (this.speedTimer <= 0) return;
            
            this.clickCount++;
            const countElement = document.getElementById('click-count');
            if (countElement) {
                countElement.textContent = this.clickCount;
            }
            
            if (this.clickCount >= 20) {
                clearInterval(this.speedTimerInterval);
                this.completeMiniGame(true);
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–õ–∞–±–∏—Ä–∏–Ω—Ç" (–ù–û–í–û–ï)
        getMazeGameContent() {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ—Å—Ç–æ–π –ª–∞–±–∏—Ä–∏–Ω—Ç 5x5
            this.mazeSize = 5;
            this.playerPos = { x: 0, y: 0 };
            this.exitPos = { x: 4, y: 4 };
            this.maze = this.generateMaze();
            
            return `
                <div class="text-center">
                    <p class="mb-2">–ù–∞–π–¥–∏ –≤—ã—Ö–æ–¥ –∏–∑ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞!</p>
                    <p class="mb-4">üèÅ –î–æ–π–¥–∏ –¥–æ –≤—ã—Ö–æ–¥–∞ –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É</p>
                    <div id="maze-grid" class="grid grid-cols-5 gap-1 mb-4 mx-auto max-w-40">
                        ${this.renderMaze()}
                    </div>
                    <div class="flex justify-center space-x-2">
                        <button onclick="game.moveMazePlayer('up')" class="bg-blue-500 text-white px-3 py-2 rounded">‚¨ÜÔ∏è</button>
                    </div>
                    <div class="flex justify-center space-x-2 mt-1">
                        <button onclick="game.moveMazePlayer('left')" class="bg-blue-500 text-white px-3 py-2 rounded">‚¨ÖÔ∏è</button>
                        <button onclick="game.moveMazePlayer('down')" class="bg-blue-500 text-white px-3 py-2 rounded">‚¨áÔ∏è</button>
                        <button onclick="game.moveMazePlayer('right')" class="bg-blue-500 text-white px-3 py-2 rounded">‚û°Ô∏è</button>
                    </div>
                </div>
            `;
        }
        
        generateMaze() {
            // –ü—Ä–æ—Å—Ç–æ–π –ª–∞–±–∏—Ä–∏–Ω—Ç 5x5 –≥–¥–µ 1 = —Å—Ç–µ–Ω–∞, 0 = —Å–≤–æ–±–æ–¥–Ω–æ
            const maze = [
                [0, 1, 0, 0, 0],
                [0, 1, 0, 1, 0],
                [0, 0, 0, 1, 0],
                [1, 1, 0, 0, 0],
                [0, 0, 0, 1, 0]
            ];
            return maze;
        }
        
        renderMaze() {
            let html = '';
            for (let y = 0; y < this.mazeSize; y++) {
                for (let x = 0; x < this.mazeSize; x++) {
                    const isPlayer = this.playerPos.x === x && this.playerPos.y === y;
                    const isExit = this.exitPos.x === x && this.exitPos.y === y;
                    const isWall = this.maze[y][x] === 1;
                    
                    let cellClass = 'w-8 h-8 flex items-center justify-center text-xs border ';
                    let content = '';
                    
                    if (isPlayer) {
                        cellClass += 'bg-green-500 text-white';
                        content = 'üë§';
                    } else if (isExit) {
                        cellClass += 'bg-red-500 text-white';
                        content = 'üèÅ';
                    } else if (isWall) {
                        cellClass += 'bg-gray-800';
                        content = '';
                    } else {
                        cellClass += 'bg-white border-gray-300';
                        content = '';
                    }
                    
                    html += `<div class="${cellClass}">${content}</div>`;
                }
            }
            return html;
        }
        
        moveMazePlayer(direction) {
            let newX = this.playerPos.x;
            let newY = this.playerPos.y;
            
            switch (direction) {
                case 'up':
                    newY = Math.max(0, newY - 1);
                    break;
                case 'down':
                    newY = Math.min(this.mazeSize - 1, newY + 1);
                    break;
                case 'left':
                    newX = Math.max(0, newX - 1);
                    break;
                case 'right':
                    newX = Math.min(this.mazeSize - 1, newX + 1);
                    break;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å–æ —Å—Ç–µ–Ω–æ–π
            if (this.maze[newY][newX] !== 1) {
                this.playerPos = { x: newX, y: newY };
                
                // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                const mazeGrid = document.getElementById('maze-grid');
                if (mazeGrid) {
                    mazeGrid.innerHTML = this.renderMaze();
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞
                if (newX === this.exitPos.x && newY === this.exitPos.y) {
                    setTimeout(() => this.completeMiniGame(true), 500);
                }
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–£–∑–æ—Ä" (–ù–û–í–û–ï)
        getPatternGameContent() {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–∑–æ—Ä –∏–∑ —Ü–≤–µ—Ç–æ–≤
            this.pattern = this.generatePattern();
            this.userPattern = [];
            this.showingPattern = true;
            
            setTimeout(() => {
                this.showingPattern = false;
                this.updatePatternDisplay();
            }, 3000);
            
            return `
                <div class="text-center">
                    <p class="mb-2">–ó–∞–ø–æ–º–Ω–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∏ —É–∑–æ—Ä!</p>
                    <p id="pattern-instruction" class="mb-4 text-sm text-gray-600">–ó–∞–ø–æ–º–∏–Ω–∞–π...</p>
                    <div id="pattern-display" class="grid grid-cols-3 gap-2 mb-4 mx-auto max-w-32">
                        ${this.renderPattern()}
                    </div>
                    <div id="pattern-buttons" class="grid grid-cols-3 gap-2 mx-auto max-w-32" style="display: none;">
                        ${this.renderPatternButtons()}
                    </div>
                    <div class="text-xs text-gray-600 mt-2">
                        –ü—Ä–æ–≥—Ä–µ—Å—Å: <span id="pattern-progress">0</span>/${this.pattern.length}
                    </div>
                </div>
            `;
        }
        
        generatePattern() {
            const colors = ['red', 'blue', 'green', 'yellow'];
            const pattern = [];
            for (let i = 0; i < 6; i++) {
                pattern.push(colors[Math.floor(Math.random() * colors.length)]);
            }
            return pattern;
        }
        
        renderPattern() {
            return this.pattern.map((color, index) => {
                const bgColor = this.getColorClass(color);
                const isVisible = this.showingPattern || this.userPattern.length > index;
                return `
                    <div class="w-8 h-8 rounded border-2 ${isVisible ? bgColor : 'bg-gray-200'} ${
                        this.showingPattern && Math.floor(Date.now() / 500) % 2 === 0 ? 'animate-pulse' : ''
                    }"></div>
                `;
            }).join('');
        }
        
        renderPatternButtons() {
            const colors = ['red', 'blue', 'green', 'yellow'];
            return colors.map(color => `
                <button onclick="game.addPatternColor('${color}')" class="w-8 h-8 rounded border-2 ${this.getColorClass(color)} hover:scale-110 transition-transform">
                </button>
            `).join('');
        }
        
        getColorClass(color) {
            const colorMap = {
                red: 'bg-red-500',
                blue: 'bg-blue-500',
                green: 'bg-green-500',
                yellow: 'bg-yellow-500'
            };
            return colorMap[color] || 'bg-gray-500';
        }
        
        updatePatternDisplay() {
            const instruction = document.getElementById('pattern-instruction');
            const patternDisplay = document.getElementById('pattern-display');
            const patternButtons = document.getElementById('pattern-buttons');
            
            if (instruction) instruction.textContent = '–ü–æ–≤—Ç–æ—Ä–∏ —É–∑–æ—Ä:';
            if (patternDisplay) patternDisplay.innerHTML = this.renderPattern();
            if (patternButtons) patternButtons.style.display = 'grid';
        }
        
        addPatternColor(color) {
            if (this.showingPattern) return;
            
            this.userPattern.push(color);
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            const progress = document.getElementById('pattern-progress');
            if (progress) progress.textContent = this.userPattern.length;
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å
            const isCorrect = this.userPattern[this.userPattern.length - 1] === this.pattern[this.userPattern.length - 1];
            
            if (!isCorrect) {
                this.completeMiniGame(false);
                return;
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            this.updatePatternDisplay();
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
            if (this.userPattern.length === this.pattern.length) {
                this.completeMiniGame(true);
            }
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–°–æ—Å—Ç–∞–≤—å —Å–ª–æ–≤–æ" (–ù–û–í–û–ï)
        getWordGameContent() {
            const words = ['–ö–û–¢', '–î–û–ú', '–°–ê–î', '–ú–ò–†', '–°–û–ù', '–õ–ï–°', '–ú–ê–ö', '–õ–£–ö'];
            this.targetWord = words[Math.floor(Math.random() * words.length)];
            this.availableLetters = this.shuffleWord(this.targetWord);
            this.userWord = '';
            
            return `
                <div class="text-center">
                    <p class="mb-2">–°–æ—Å—Ç–∞–≤—å —Å–ª–æ–≤–æ –∏–∑ –±—É–∫–≤!</p>
                    <p class="mb-4 text-lg font-bold">–¶–µ–ª—å: ${this.targetWord}</p>
                    <div class="mb-4">
                        <div class="text-lg font-mono bg-gray-100 p-2 rounded min-h-8">
                            <span id="user-word">${this.userWord || '_'.repeat(this.targetWord.length)}</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        ${this.availableLetters.map((letter, index) => `
                            <button onclick="game.addLetter('${letter}', ${index})" id="letter-${index}" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded font-bold transition-colors">
                                ${letter}
                            </button>
                        `).join('')}
                    </div>
                    <div class="flex justify-center space-x-2">
                        <button onclick="game.clearWord()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">
                            üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                        <button onclick="game.checkWord()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
                            ‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                        </button>
                    </div>
                </div>
            `;
        }
        
        shuffleWord(word) {
            return word.split('').sort(() => Math.random() - 0.5);
        }
        
        addLetter(letter, index) {
            if (this.userWord.length < this.targetWord.length) {
                this.userWord += letter;
                
                // –°–∫—Ä—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é –±—É–∫–≤—É
                const letterBtn = document.getElementById(`letter-${index}`);
                if (letterBtn) {
                    letterBtn.style.display = 'none';
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–æ–≤–∞
                const userWordEl = document.getElementById('user-word');
                if (userWordEl) {
                    userWordEl.textContent = this.userWord + '_'.repeat(this.targetWord.length - this.userWord.length);
                }
            }
        }
        
        clearWord() {
            this.userWord = '';
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –±—É–∫–≤—ã
            this.availableLetters.forEach((_, index) => {
                const letterBtn = document.getElementById(`letter-${index}`);
                if (letterBtn) {
                    letterBtn.style.display = 'block';
                }
            });
            
            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const userWordEl = document.getElementById('user-word');
            if (userWordEl) {
                userWordEl.textContent = '_'.repeat(this.targetWord.length);
            }
        }
        
        checkWord() {
            this.completeMiniGame(this.userWord === this.targetWord);
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–¶–≤–µ—Ç–Ω–∞—è –∏–≥—Ä–∞" (–ù–û–í–û–ï)
        getColorGameContent() {
            const colors = [
                { name: '–ö–†–ê–°–ù–´–ô', color: 'red', textColor: 'blue' },
                { name: '–°–ò–ù–ò–ô', color: 'blue', textColor: 'green' },
                { name: '–ó–ï–õ–ï–ù–´–ô', color: 'green', textColor: 'red' },
                { name: '–ñ–ï–õ–¢–´–ô', color: 'yellow', textColor: 'purple' }
            ];
            
            this.currentColor = colors[Math.floor(Math.random() * colors.length)];
            this.colorOptions = colors.map(c => c.color).sort(() => Math.random() - 0.5);
            
            return `
                <div class="text-center">
                    <p class="mb-4">–í—ã–±–µ—Ä–∏ –¶–í–ï–¢ —Ç–µ–∫—Å—Ç–∞, –∞ –Ω–µ —Ç–æ —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ!</p>
                    <div class="mb-6 p-4 bg-gray-100 rounded-lg">
                        <div class="text-4xl font-bold" style="color: ${this.getActualColor(this.currentColor.textColor)}">
                            ${this.currentColor.name}
                        </div>
                    </div>
                    <p class="mb-4 text-sm text-gray-600">–ö–∞–∫–æ–≥–æ —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç –≤—ã—à–µ?</p>
                    <div class="grid grid-cols-2 gap-3">
                        ${this.colorOptions.map(color => `
                            <button onclick="game.selectColor('${color}')" class="p-3 rounded-lg text-white font-bold transition-colors ${this.getColorButtonClass(color)}">
                                ${this.getColorName(color)}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        getActualColor(color) {
            const colorMap = {
                red: '#ef4444',
                blue: '#3b82f6',
                green: '#22c55e',
                yellow: '#eab308',
                purple: '#a855f7'
            };
            return colorMap[color] || '#000000';
        }
        
        getColorButtonClass(color) {
            const classMap = {
                red: 'bg-red-500 hover:bg-red-600',
                blue: 'bg-blue-500 hover:bg-blue-600',
                green: 'bg-green-500 hover:bg-green-600',
                yellow: 'bg-yellow-500 hover:bg-yellow-600'
            };
            return classMap[color] || 'bg-gray-500 hover:bg-gray-600';
        }
        
        getColorName(color) {
            const nameMap = {
                red: '–ö–†–ê–°–ù–´–ô',
                blue: '–°–ò–ù–ò–ô',
                green: '–ó–ï–õ–ï–ù–´–ô',
                yellow: '–ñ–ï–õ–¢–´–ô'
            };
            return nameMap[color] || '–¶–í–ï–¢';
        }
        
        selectColor(selectedColor) {
            this.completeMiniGame(selectedColor === this.currentColor.textColor);
        }
        
        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–≥—Ä—ã "–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å" (–ù–û–í–û–ï)
        getSequenceGameContent() {
            const sequences = [
                { seq: [2, 4, 6, 8], next: 10, rule: '—á–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞' },
                { seq: [1, 3, 5, 7], next: 9, rule: '–Ω–µ—á–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞' },
                { seq: [1, 4, 7, 10], next: 13, rule: '+3' },
                { seq: [2, 6, 18, 54], next: 162, rule: '√ó3' },
                { seq: [1, 1, 2, 3], next: 5, rule: '–§–∏–±–æ–Ω–∞—á—á–∏' }
            ];
            
            this.currentSequence = sequences[Math.floor(Math.random() * sequences.length)];
            this.sequenceOptions = this.generateSequenceOptions(this.currentSequence.next);
            
            return `
                <div class="text-center">
                    <p class="mb-4">–ù–∞–π–¥–∏ —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:</p>
                    <div class="mb-6 p-4 bg-gray-100 rounded-lg">
                        <div class="text-2xl font-bold">
                            ${this.currentSequence.seq.join(', ')}, ?
                        </div>
                    </div>
                    <p class="mb-4 text-sm text-gray-600">–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–º?</p>
                    <div class="grid grid-cols-2 gap-3">
                        ${this.sequenceOptions.map(option => `
                            <button onclick="game.selectSequenceNumber(${option})" class="bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-lg font-bold transition-colors">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        generateSequenceOptions(correctAnswer) {
            const options = new Set([correctAnswer]);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
            while (options.size < 4) {
                const variation = correctAnswer + (Math.random() - 0.5) * 10;
                options.add(Math.round(variation));
            }
            
            return Array.from(options).sort(() => Math.random() - 0.5);
        }
        
        selectSequenceNumber(selectedNumber) {
            this.completeMiniGame(selectedNumber === this.currentSequence.next);
        }
        
        checkLevelUp() {
            const newLevel = Math.floor(this.experience / 100) + 1;
            if (newLevel > this.level) {
                this.level = newLevel;
                this.money += 50;
                this.playHappySound();
                this.showMessage('üéâ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! +50 –º–æ–Ω–µ—Ç!');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–Ω–¥—É–∫–æ–≤ –∑–∞ —É—Ä–æ–≤–Ω–∏
                this.checkChestReward();
            }
        }
        
        checkChestReward() {
            const chestsEarned = Math.floor(this.level / 10);
            const chestsToAdd = chestsEarned - Math.floor(this.lastChestLevel / 10);
            
            if (chestsToAdd > 0) {
                this.chestCount += chestsToAdd;
                this.lastChestLevel = this.level;
                this.showMessage(`üéÅ –ü–æ–ª—É—á–µ–Ω${chestsToAdd > 1 ? '–æ' : ''} ${chestsToAdd} —Å—É–Ω–¥—É–∫${chestsToAdd > 1 ? '–∞' : ''}!`);
                this.saveData();
            }
        }
        
        getChestsTabContent() {
            const availableChests = this.chestCount;
            const chestsFromFriends = Math.floor(this.friendsInvited / 5);
            const totalChests = availableChests + chestsFromFriends;
            
            return `
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üì¶ –°—É–Ω–¥—É–∫–∏</h3>
                        <div class="text-center mb-4">
                            <div class="text-3xl mb-2">üì¶</div>
                            <p class="text-lg font-bold">–î–æ—Å—Ç—É–ø–Ω–æ —Å—É–Ω–¥—É–∫–æ–≤: ${totalChests}</p>
                            <p class="text-xs text-gray-600">–ó–∞ —É—Ä–æ–≤–Ω–∏: ${availableChests} ‚Ä¢ –ó–∞ –¥—Ä—É–∑–µ–π: ${chestsFromFriends}</p>
                        </div>
                        
                        ${totalChests > 0 ? `
                            <button onclick="game.openChest()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-3 px-4 rounded-lg font-bold transition-colors animate-pulse">
                                üéÅ –û—Ç–∫—Ä—ã—Ç—å —Å—É–Ω–¥—É–∫
                            </button>
                        ` : `
                            <div class="text-center text-gray-500 py-4">
                                <p class="mb-2">üîí –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—É–Ω–¥—É–∫–æ–≤</p>
                                <p class="text-xs">–ü–æ–ª—É—á–∞–π—Ç–µ —É—Ä–æ–≤–Ω–∏ –∏–ª–∏ –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π!</p>
                            </div>
                        `}
                    </div>
                    
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üéØ –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å—É–Ω–¥—É–∫–∏</h3>
                        <div class="space-y-2 text-xs">
                            <div class="flex justify-between items-center p-2 bg-blue-50 rounded">
                                <span>üìà –ö–∞–∂–¥—ã–µ 10 —É—Ä–æ–≤–Ω–µ–π</span>
                                <span class="font-bold text-blue-600">+1 —Å—É–Ω–¥—É–∫</span>
                            </div>
                            <div class="flex justify-between items-center p-2 bg-green-50 rounded">
                                <span>üë• –ö–∞–∂–¥—ã–µ 5 –¥—Ä—É–∑–µ–π</span>
                                <span class="font-bold text-green-600">+1 —Å—É–Ω–¥—É–∫</span>
                            </div>
                        </div>
                        <div class="mt-3 text-xs text-gray-600">
                            <p>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—É–Ω–¥—É–∫–∞: ${10 - (this.level % 10)} —É—Ä–æ–≤–Ω–µ–π</p>
                            <p>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π: ${this.friendsInvited}/5</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üíé –í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –∏–∑ —Å—É–Ω–¥—É–∫–æ–≤</h3>
                        <div class="grid grid-cols-1 gap-1 text-xs max-h-48 overflow-y-auto">
                            <!-- –†–ê–ú–ö–ò (2% —à–∞–Ω—Å –∫–∞–∂–¥–∞—è) -->
                            <div class="bg-yellow-50 p-2 rounded border-l-4 border-yellow-400">
                                <div class="font-bold text-yellow-800 mb-1">üñºÔ∏è –†–ê–ú–ö–ò (—à–∞–Ω—Å 2% –∫–∞–∂–¥–∞—è):</div>
                                ${Object.entries(this.frames || {}).slice(0, 5).map(([key, frame]) => `
                                    <div class="flex items-center justify-between p-1 rounded bg-yellow-100 mb-1">
                                        <span class="font-medium">${frame.name}</span>
                                        <span class="font-bold text-yellow-700">${frame.chance}%</span>
                                    </div>
                                `).join('')}
                                <div class="text-xs text-yellow-600">+ –µ—â–µ ${Object.keys(this.frames || {}).length - 5} —Ä–∞–º–æ–∫...</div>
                            </div>
                            
                            <!-- –ê–ö–°–ï–°–°–£–ê–†–´ –£–ë–†–ê–ù–´ –ò–ó –°–£–ù–î–£–ö–û–í -->
                            
                            <!-- –°–ö–ò–ù–´ -->
                            <div class="bg-purple-50 p-2 rounded border-l-4 border-purple-400">
                                <div class="font-bold text-purple-800 mb-1">üê∞ –°–ö–ò–ù–´:</div>
                                ${Object.entries(this.skins).slice(0, 4).map(([key, skin]) => `
                                    <div class="flex items-center justify-between p-1 rounded mb-1" style="background-color: ${skin.color}33;">
                                        <div class="flex items-center space-x-1">
                                            <span>${this.rarities[skin.rarity].emoji}</span>
                                            <span class="font-medium">${skin.name}</span>
                                        </div>
                                        <span class="font-bold">${skin.chance}%</span>
                                    </div>
                                `).join('')}
                                <div class="text-xs text-purple-600">+ –µ—â–µ ${Object.keys(this.skins).length - 4} —Å–∫–∏–Ω–æ–≤...</div>
                            </div>
                            
                            <!-- –§–û–ù–´ (–ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏) -->
                            <div class="bg-blue-50 p-2 rounded border-l-4 border-blue-400">
                                <div class="font-bold text-blue-800 mb-1">üé® –§–û–ù–´ (–ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏):</div>
                                <div class="grid grid-cols-1 gap-1 text-xs">
                                    <div class="flex justify-between items-center p-1 bg-gray-100 rounded">
                                        <span><strong>‚ö™ –û–±—ã—á–Ω—ã–µ (9 —Ñ–æ–Ω–æ–≤):</strong></span>
                                        <span class="font-bold text-gray-700">12% –∫–∞–∂–¥—ã–π</span>
                                    </div>
                                    <div class="flex justify-between items-center p-1 bg-blue-100 rounded">
                                        <span><strong>üîµ –†–µ–¥–∫–∏–µ (8 —Ñ–æ–Ω–æ–≤):</strong></span>
                                        <span class="font-bold text-blue-700">9% –∫–∞–∂–¥—ã–π</span>
                                    </div>
                                    <div class="flex justify-between items-center p-1 bg-purple-100 rounded">
                                        <span><strong>üü£ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ (8 —Ñ–æ–Ω–æ–≤):</strong></span>
                                        <span class="font-bold text-purple-700">6% –∫–∞–∂–¥—ã–π</span>
                                    </div>
                                    <div class="flex justify-between items-center p-1 bg-yellow-100 rounded">
                                        <span><strong>üü° –ú–∏—Ñ–∏—á–µ—Å–∫–∏–µ (8 —Ñ–æ–Ω–æ–≤):</strong></span>
                                        <span class="font-bold text-yellow-700">3% –∫–∞–∂–¥—ã–π</span>
                                    </div>
                                </div>
                                <div class="text-xs text-blue-600 mt-1">–í—Å–µ–≥–æ ${Object.keys(this.backgrounds).length} —Ñ–æ–Ω–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —à–∞–Ω—Å–∞–º–∏!</div>
                            </div>
                            
                            <!-- –ú–û–ù–ï–¢–´ - –û–°–ù–û–í–ù–ê–Ø –ù–ê–ì–†–ê–î–ê -->
                            <div class="bg-yellow-50 p-2 rounded border-l-4 border-yellow-400">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <span class="text-lg">üí∞</span>
                                        <span class="font-medium">–ú–æ–Ω–µ—Ç—ã (100-500)</span>
                                    </div>
                                    <span class="font-bold text-yellow-700 animate-pulse">~90%</span>
                                </div>
                                <div class="text-xs text-yellow-600 mt-1">–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ - –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞—Ä–∞–±–æ—Ç–∫–∞!</div>
                            </div>
                        </div>
                        
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ -->
                        <div class="mt-3 p-2 bg-gradient-to-r from-purple-100 to-pink-100 rounded border border-purple-200">
                            <div class="text-center text-xs">
                                <div class="font-bold text-purple-800">üìä –í–°–ï–ì–û –ù–ê–ì–†–ê–î –í –ò–ì–†–ï:</div>
                                <div class="grid grid-cols-3 gap-1 mt-1">
                                    <div><span class="font-bold">${Object.keys(this.frames || {}).length}</span><br>üñºÔ∏è –†–∞–º–æ–∫</div>
                                    <div><span class="font-bold">${Object.keys(this.skins).length}</span><br>üê∞ –°–∫–∏–Ω–æ–≤</div>
                                    <div><span class="font-bold">${Object.keys(this.backgrounds).length}</span><br>üé® –§–æ–Ω–æ–≤</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ò–ù–í–ï–ù–¢–ê–†–¨ –†–ê–ú–û–ö -->
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üñºÔ∏è –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Ä–∞–º–æ–∫ (${(this.unlockedFrames || ['default']).length})</h3>
                        <div class="grid grid-cols-2 gap-2 max-h-32 overflow-y-auto">
                            ${(this.unlockedFrames || ['default']).map(frameKey => {
                                const frame = (this.frames && this.frames[frameKey]) || { name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–∞–º–∫–∞', style: 'border-2 border-gray-300', description: '–ë–∞–∑–æ–≤–∞—è —Ä–∞–º–∫–∞' };
                                const isActive = (this.currentFrame || 'default') === frameKey;
                                return `
                                    <button onclick="game.selectFrame('${frameKey}')" class="p-2 rounded-lg text-xs transition-colors ${
                                        isActive ? 'bg-green-100 border-2 border-green-500' : 'bg-gray-100 hover:bg-gray-200'
                                    }">
                                        <div class="text-center">
                                            <div class="w-12 h-12 mx-auto mb-1 ${frame.style} rounded flex items-center justify-center">
                                                <div class="w-8 h-8 bg-gray-200 rounded flex items-center justify-center text-xs">üê∞</div>
                                            </div>
                                            <div class="font-medium">${frame.name}</div>
                                            ${isActive ? '<div class="text-green-600 font-bold mt-1">‚úì –ê–∫—Ç–∏–≤–Ω–∞</div>' : ''}
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- –ê–ö–°–ï–°–°–£–ê–†–´ –£–ë–†–ê–ù–´ –ò–ó –ò–ì–†–´ -->

                    <!-- –ò–ù–í–ï–ù–¢–ê–†–¨ –°–ö–ò–ù–û–í -->
                    <div class="bg-white rounded-lg p-3 shadow">
                        <h3 class="font-bold mb-2 text-purple-800 text-sm">üê∞ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å–∫–∏–Ω–æ–≤ (${this.unlockedSkins.length})</h3>
                        <div class="grid grid-cols-2 gap-2 max-h-32 overflow-y-auto">
                            ${this.unlockedSkins.map(skinKey => {
                                const skin = this.skins[skinKey];
                                const isActive = this.currentSkin === skinKey;
                                return `
                                    <button onclick="game.selectSkin('${skinKey}')" class="p-2 rounded-lg text-xs transition-colors ${
                                        isActive ? 'bg-green-100 border-2 border-green-500' : 'bg-gray-100 hover:bg-gray-200'
                                    }">
                                        <div class="text-center">
                                            <div class="w-12 h-12 mx-auto mb-1 rounded-full flex items-center justify-center text-lg" style="background-color: ${skin.color};">
                                                üê∞
                                            </div>
                                            <div class="font-medium">${skin.name}</div>
                                            <div class="text-xs" style="color: ${this.rarities[skin.rarity].color};">
                                                ${this.rarities[skin.rarity].emoji} ${this.rarities[skin.rarity].name}
                                            </div>
                                            ${isActive ? '<div class="text-green-600 font-bold mt-1">‚úì –ê–∫—Ç–∏–≤–µ–Ω</div>' : ''}
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        
        openChest() {
            if (this.chestCount <= 0) {
                this.showMessage('‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—É–Ω–¥—É–∫–æ–≤!');
                return;
            }
            
            this.chestCount--;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–≥—Ä–∞–¥—É —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π —à–∞–Ω—Å–æ–≤
            const random = Math.random() * 100;
            let reward = null;
            let cumulativeChance = 0;
            
            // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –†–ê–ú–ö–ò (—à–∞–Ω—Å 2%)
            if (!this.unlockedFrames) this.unlockedFrames = ['default'];
            if (!this.currentFrame) this.currentFrame = 'default';
            
            for (const [key, frame] of Object.entries(this.frames || {})) {
                cumulativeChance += frame.chance;
                if (random <= cumulativeChance && !this.unlockedFrames.includes(key)) {
                    reward = { type: 'frame', key: key, frame: frame };
                    this.unlockedFrames.push(key);
                    this.saveValue('unlocked_frames', this.unlockedFrames);
                    break;
                }
            }
            

            
            // 2. –ï—Å–ª–∏ —Ä–∞–º–∫–∞ –Ω–µ –≤—ã–ø–∞–ª–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º –°–ö–ò–ù–´
            if (!reward) {
                for (const [key, skin] of Object.entries(this.skins)) {
                    cumulativeChance += skin.chance;
                    if (random <= cumulativeChance && !this.unlockedSkins.includes(key)) {
                        reward = { type: 'skin', key: key, skin: skin };
                        this.unlockedSkins.push(key);
                        break;
                    }
                }
            }
            
            // 3. –ï—Å–ª–∏ —Å–∫–∏–Ω –Ω–µ –≤—ã–ø–∞–ª, –ø—Ä–æ–≤–µ—Ä—è–µ–º –§–û–ù–´ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
            if (!reward) {
                for (const [key, bg] of Object.entries(this.backgrounds)) {
                    if (bg.chance > 0) {
                        let bgChance = 0;
                        
                        // –®–∞–Ω—Å—ã –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏ —Ñ–æ–Ω–æ–≤
                        if (bg.rarity === 'common') {
                            bgChance = 12; // –û–±—ã—á–Ω—ã–µ —Ñ–æ–Ω—ã - 12%
                        } else if (bg.rarity === 'rare') {
                            bgChance = 9; // –†–µ–¥–∫–∏–µ —Ñ–æ–Ω—ã - 9%
                        } else if (bg.rarity === 'legendary') {
                            bgChance = 6; // –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ —Ñ–æ–Ω—ã - 6%
                        } else if (bg.rarity === 'mythic') {
                            bgChance = 3; // –ú–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–æ–Ω—ã - 3%
                        }
                        
                        cumulativeChance += bgChance;
                        if (random <= cumulativeChance && !this.unlockedBackgrounds.includes(key)) {
                            reward = { type: 'background', key: key, background: bg };
                            this.unlockedBackgrounds.push(key);
                            this.saveValue('unlocked_backgrounds', this.unlockedBackgrounds);
                            break;
                        }
                    }
                }
            }
            
            // 4. –ú–æ–Ω–µ—Ç—ã - –æ—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ (90% —Å–ª—É—á–∞–µ–≤)
            if (!reward) {
                const bonusAmount = Math.floor(Math.random() * 400) + 100; // –û—Ç 100 –¥–æ 500 –º–æ–Ω–µ—Ç
                reward = { type: 'money', amount: bonusAmount };
                this.money += bonusAmount;
            }
            
            this.playHappySound();
            this.saveData();
            this.updateDisplay();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            this.showChestResult(reward);
        }
        
        showChestResult(reward) {
            let message = '';
            let className = '';
            let extraContent = '';
            
            if (reward.type === 'frame') {
                message = `üñºÔ∏è –ù–æ–≤–∞—è —Ä–∞–º–∫–∞: ${reward.frame.name}!`;
                className = 'bg-yellow-100 border-yellow-500 text-yellow-700';
                extraContent = `
                    <div class="mb-4">
                        <div class="w-20 h-20 mx-auto rounded-lg ${reward.frame.style} flex items-center justify-center">
                            <div class="w-12 h-12 bg-gray-200 rounded flex items-center justify-center text-lg">üê∞</div>
                        </div>
                        <p class="text-sm mt-2 text-yellow-600">
                            üñºÔ∏è ${reward.frame.rarity} —Ä–∞–º–∫–∞
                        </p>
                        <p class="text-xs mt-1 text-gray-600">${reward.frame.description}</p>
                    </div>
                `;
            // –ê–ö–°–ï–°–°–£–ê–†–´ –£–î–ê–õ–ï–ù–´ –ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –°–£–ù–î–£–ö–û–í
            } else if (reward.type === 'skin') {
                message = `üéâ –ù–æ–≤—ã–π —Å–∫–∏–Ω: ${reward.skin.name}!`;
                className = 'bg-purple-100 border-purple-500 text-purple-700';
                extraContent = `
                    <div class="mb-4">
                        <div class="w-16 h-16 mx-auto rounded-full flex items-center justify-center text-2xl" style="background-color: ${reward.skin.color};">
                            üê∞
                        </div>
                        <p class="text-sm mt-2" style="color: ${this.rarities[reward.skin.rarity].color};">
                            ${this.rarities[reward.skin.rarity].emoji} ${this.rarities[reward.skin.rarity].name}
                        </p>
                    </div>
                `;
            } else if (reward.type === 'background') {
                message = `üé® –ù–æ–≤—ã–π —Ñ–æ–Ω: ${reward.background.name}!`;
                className = 'bg-blue-100 border-blue-500 text-blue-700';
                extraContent = `
                    <div class="mb-4">
                        <div class="w-16 h-16 mx-auto rounded-lg bg-gradient-to-br ${reward.background.gradient} flex items-center justify-center text-2xl">
                            ${reward.background.emoji}
                        </div>
                        <p class="text-sm mt-2 text-blue-600">
                            üé® ${reward.background.rarity} —Ñ–æ–Ω
                        </p>
                    </div>
                `;
            } else {
                message = `üí∞ –ü–æ–ª—É—á–µ–Ω–æ ${reward.amount} –º–æ–Ω–µ—Ç!`;
                className = 'bg-yellow-100 border-yellow-500 text-yellow-700';
                extraContent = `
                    <div class="mb-4">
                        <div class="w-16 h-16 mx-auto rounded-full bg-gradient-to-br from-yellow-300 to-orange-400 flex items-center justify-center text-3xl">
                            üí∞
                        </div>
                    </div>
                `;
            }
            
            // –°–æ–∑–¥–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4">
                    <div class="text-center">
                        <div class="text-4xl mb-4 animate-bounce">üéÅ</div>
                        <h3 class="text-lg font-bold mb-2">–°—É–Ω–¥—É–∫ –æ—Ç–∫—Ä—ã—Ç!</h3>
                        <div class="p-4 rounded-lg mb-4 border-2 ${className}">
                            ${message}
                        </div>
                        ${extraContent}
                        <button onclick="this.parentElement.parentElement.parentElement.remove(); if(typeof game !== 'undefined' && game.switchTab) game.switchTab('chests');" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-2 rounded-lg font-bold transition-colors">
                            –û—Ç–ª–∏—á–Ω–æ!
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É
            setTimeout(() => {
                this.switchTab('chests');
            }, 100);
        }
        
        selectSkin(skinKey) {
            if (this.unlockedSkins.includes(skinKey)) {
                this.currentSkin = skinKey;
                this.saveData();
                this.updateDisplay();
                this.showMessage(`‚ú® –í—ã–±—Ä–∞–Ω —Å–∫–∏–Ω: ${this.skins[skinKey].name}!`);
                this.switchTab('chests');
            } else {
                this.showMessage('‚ùå –°–∫–∏–Ω –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!');
            }
        }
        
        selectFrame(frameKey) {
            if (!this.unlockedFrames) this.unlockedFrames = ['default'];
            
            if (this.unlockedFrames.includes(frameKey) || frameKey === 'default') {
                this.currentFrame = frameKey;
                this.saveValue('current_frame', this.currentFrame);
                this.updateDisplay();
                
                const frameName = (this.frames && this.frames[frameKey]) ? this.frames[frameKey].name : '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–∞–º–∫–∞';
                this.showMessage(`üñºÔ∏è –í—ã–±—Ä–∞–Ω–∞ —Ä–∞–º–∫–∞: ${frameName}!`);
                this.switchTab('chests');
            } else {
                this.showMessage('‚ùå –†–∞–º–∫–∞ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞!');
            }
        }
        
        // –ê–ö–°–ï–°–°–£–ê–†–´ –£–ë–†–ê–ù–´ –ò–ó –ò–ì–†–´ - –§–£–ù–ö–¶–ò–Ø –ù–ï –ù–£–ñ–ù–ê
        
        checkNotifications() {
            // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ stats
            if (!this.stats || typeof this.stats !== 'object') {
                return;
            }
            
            if (this.stats.happiness < 50) {
                this.showNotification(`üò¢ ${this.petName}: –ú–Ω–µ —Å–∫—É—á–Ω–æ! –ü–æ–∏–≥—Ä–∞–π —Å–æ –º–Ω–æ–π!`, 'sad');
            }
            if (this.stats.sleep < 50) {
                this.showNotification(`üò¥ ${this.petName}: –Ø —Ö–æ—á—É —Å–ø–∞—Ç—å! –£–ª–æ–∂–∏ –º–µ–Ω—è –≤ –∫—Ä–æ–≤–∞—Ç–∫—É!`, 'sleepy');
            }
            if (this.stats.hunger < 50) {
                this.showNotification(`üçΩÔ∏è ${this.petName}: –Ø –≥–æ–ª–æ–¥–µ–Ω! –ü–æ–∫–æ—Ä–º–∏ –º–µ–Ω—è —á–µ–º-–Ω–∏–±—É–¥—å –≤–∫—É—Å–Ω—ã–º!`, 'hungry');
            }
            if (this.stats.cleanliness < 50) {
                this.showNotification(`üõÅ ${this.petName}: –Ø –≥—Ä—è–∑–Ω—ã–π! –ü–æ–º–æ–π –º–µ–Ω—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞!`, 'dirty');
            }
            if (this.stats.health < 50) {
                this.showNotification(`üíä ${this.petName}: –ú–Ω–µ –ø–ª–æ—Ö–æ! –í—ã–ª–µ—á–∏ –º–µ–Ω—è!`, 'sick');
            }
            if (this.stats.energy < 30) {
                this.showNotification(`‚ö° ${this.petName}: –£ –º–µ–Ω—è –º–∞–ª–æ —ç–Ω–µ—Ä–≥–∏–∏! –î–∞–π –º–Ω–µ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å!`, 'tired');
            }
        }
        
        checkEvolution() {
            const currentStage = Object.entries(this.evolutionStages)
                .reverse()
                .find(([_, stage]) => this.age >= stage.minAge)?.[0] || 'baby';
            
            if (currentStage !== this.evolutionStage) {
                this.evolutionStage = currentStage;
                this.playHappySound();
                this.showMessage(`üéâ –≠–≤–æ–ª—é—Ü–∏—è! –¢–µ–ø–µ—Ä—å ${this.evolutionStages[currentStage].name}!`);
            }
        }
        
        startGameLoop() {
            setInterval(() => {
                const now = Date.now();
                const timeDiff = Math.floor((now - this.lastUpdate) / 1000);
                
                // –°—Ç–∞—Ä–µ–Ω–∏–µ: 1 —Ä–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å = 1 –¥–µ–Ω—å –ø–∏—Ç–æ–º—Ü–∞ (86400 —Å–µ–∫—É–Ω–¥ = 1 –¥–µ–Ω—å)
                if (timeDiff >= 86400) {
                    const daysToAdd = Math.floor(timeDiff / 86400);
                    this.age += daysToAdd;
                    this.checkEvolution();
                    this.lastUpdate = now;
                }
                
                // –°–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (300 —Å–µ–∫—É–Ω–¥)
                if (timeDiff >= 300) {
                    if (!this.isSleeping) {
                        this.stats.hunger = Math.max(0, this.stats.hunger - 3); // –í–û–ó–í–†–ê–©–ï–ù–û –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É
                        this.stats.happiness = Math.max(0, this.stats.happiness - 2);
                        this.stats.cleanliness = Math.max(0, this.stats.cleanliness - 2);
                        this.stats.health = Math.max(0, this.stats.health - (this.stats.hunger < 20 ? 3 : 1));
                        this.stats.energy = Math.max(0, this.stats.energy - 3); // –í–û–ó–í–†–ê–©–ï–ù–û –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É
                        this.stats.sleep = Math.max(0, this.stats.sleep - 3);
                        
                        this.checkNotifications();
                    } else {
                        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è —Å–Ω–∞
                        this.stats.energy = Math.min(100, this.stats.energy + 8);
                        this.stats.sleep = Math.min(100, this.stats.sleep + 12);
                    }
                    
                    this.lastUpdate = now;
                    this.saveData();
                    this.updateDisplay();
                }
            }, 60000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        }
        
        startNotificationTimer() {
            setInterval(() => {
                const now = Date.now();
                const timeSinceLastNotification = now - this.lastNotification;
                
                // 30 –º–∏–Ω—É—Ç = 1800000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
                if (timeSinceLastNotification >= 1800000) {
                    this.showNotification(`üí≠ ${this.petName}: –¢—ã –Ω–µ –∑–∞–±—ã–ª –æ–±–æ –º–Ω–µ? –Ø —Å–∫—É—á–∞—é!`, 'reminder');
                    this.lastNotification = now;
                    localStorage.setItem('shared_labubu_last_notification', now.toString());
                }
            }, 60000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        }
    }

    // ===== –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –ò –°–ò–°–¢–ï–ú–´ =====

    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∫–ª–∞—Å—Å—É
    LabubuCareGame.prototype.initializeStatusSystem = function() {
        this.currentStatus = this.loadData('current_status', '–Ω–æ–≤–∏—á–æ–∫', 'string');
        this.statusPoints = this.loadData('status_points', 0, 'number');
        
        return {
            '–Ω–æ–≤–∏—á–æ–∫': { 
                name: '–ù–æ–≤–∏—á–æ–∫', 
                points: 0, 
                frame: 'border-2 border-gray-300', 
                bg: 'bg-gray-50',
                emoji: 'üå±',
                bonus: { money: 0 }
            },
            '–æ–ø—ã—Ç–Ω—ã–π': { 
                name: '–û–ø—ã—Ç–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü', 
                points: 1000, 
                frame: 'border-2 border-blue-400 shadow-lg shadow-blue-200', 
                bg: 'bg-blue-50',
                emoji: '‚≠ê',
                bonus: { money: 10 }
            },
            '—ç–∫—Å–ø–µ—Ä—Ç': { 
                name: '–≠–∫—Å–ø–µ—Ä—Ç –ø–æ —É—Ö–æ–¥—É', 
                points: 5000, 
                frame: 'border-2 border-purple-400 shadow-lg shadow-purple-200', 
                bg: 'bg-purple-50',
                emoji: 'üíé',
                bonus: { money: 25 }
            },
            '–º–∞—Å—Ç–µ—Ä': { 
                name: '–ú–∞—Å—Ç–µ—Ä –≤–æ—Å–ø–∏—Ç–∞–Ω–∏—è', 
                points: 15000, 
                frame: 'border-2 border-yellow-400 shadow-lg shadow-yellow-200', 
                bg: 'bg-yellow-50',
                emoji: 'üëë',
                bonus: { money: 50 }
            },
            '–ª–µ–≥–µ–Ω–¥–∞': { 
                name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫', 
                points: 50000, 
                frame: 'border-4 border-gradient-to-r from-purple-400 via-pink-400 to-red-400 shadow-2xl shadow-purple-300', 
                bg: 'bg-gradient-to-br from-purple-100 via-pink-100 to-red-100',
                emoji: 'üåü',
                bonus: { money: 100 }
            },
            '–±–æ–≥': { 
                name: '–ë–æ–∂–µ—Å—Ç–≤–æ –ø–∏—Ç–æ–º—Ü–µ–≤', 
                points: 100000, 
                frame: 'border-4 border-gradient-to-r from-yellow-400 via-orange-400 to-red-400 shadow-2xl shadow-orange-300 animate-pulse', 
                bg: 'bg-gradient-to-br from-yellow-100 via-orange-100 to-red-100',
                emoji: '‚ö°',
                bonus: { money: 200 }
            }
        };
    };

    LabubuCareGame.prototype.initializeFriendsSystem = function() {
        this.inviteCode = this.loadData('invite_code', this.generateInviteCode(), 'string');
        this.invitedBy = this.loadData('invited_by', '', 'string');
        this.friendsList = this.loadData('friends_list', [], 'array');
        this.pendingInvites = this.loadData('pending_invites', [], 'array');
        this.sharedCarePoints = this.loadData('shared_care_points', 0, 'number');
        
        return {
            inviteRewards: {
                10: { chests: 1, money: 2000, message: '–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü!' }
            }
        };
    };

    LabubuCareGame.prototype.initializeAchievements = function() {
        this.unlockedAchievements = this.loadData('unlocked_achievements', [], 'array');
        
        return {
            'first_feed': { name: '–ü–µ—Ä–≤–æ–µ –∫–æ—Ä–º–ª–µ–Ω–∏–µ', emoji: 'üçº', reward: { money: 100, chests: 1 } },
            'level_10': { name: '–£—Ä–æ–≤–µ–Ω—å 10', emoji: 'üîü', reward: { money: 500, chests: 2 } },
            'level_25': { name: '–£—Ä–æ–≤–µ–Ω—å 25', emoji: 'üåü', reward: { money: 1500, chests: 5 } },
            'level_50': { name: '–£—Ä–æ–≤–µ–Ω—å 50', emoji: '‚≠ê', reward: { money: 3000, chests: 10 } },
            'level_100': { name: '–£—Ä–æ–≤–µ–Ω—å 100', emoji: 'üí´', reward: { money: 10000, chests: 25 } },
            'happy_100': { name: '100% —Å—á–∞—Å—Ç—å—è', emoji: 'ü•∞', reward: { money: 200, chests: 1 } },
            'rich_10k': { name: '10,000 –º–æ–Ω–µ—Ç', emoji: 'üí∞', reward: { chests: 5 } },
            'rich_50k': { name: '50,000 –º–æ–Ω–µ—Ç', emoji: 'üíé', reward: { chests: 10 } },
            'rich_100k': { name: '100,000 –º–æ–Ω–µ—Ç', emoji: 'üëë', reward: { chests: 20 } },
            'friend_master': { name: '10 –¥—Ä—É–∑–µ–π', emoji: 'üë•', reward: { money: 2000, chests: 1 } },
            'chest_opener': { name: '50 —Å—É–Ω–¥—É–∫–æ–≤', emoji: 'üì¶', reward: { money: 1000 } },
            'chest_master': { name: '100 —Å—É–Ω–¥—É–∫–æ–≤', emoji: 'üóÇÔ∏è', reward: { money: 2500, chests: 5 } },
            'evolution_child': { name: '–î–µ—Ç—Å–∫–∞—è —ç–≤–æ–ª—é—Ü–∏—è', emoji: 'üå±', reward: { chests: 2, money: 500 } },
            'evolution_teen': { name: '–ü–æ–¥—Ä–æ—Å—Ç–∫–æ–≤–∞—è —ç–≤–æ–ª—é—Ü–∏—è', emoji: 'üåø', reward: { chests: 3, money: 1000 } },
            'evolution_adult': { name: '–í–∑—Ä–æ—Å–ª–∞—è —ç–≤–æ–ª—é—Ü–∏—è', emoji: 'ü¶ã', reward: { chests: 5, money: 2500 } },
            'evolution_elder': { name: '–ú—É–¥—Ä–µ—Ü —ç–≤–æ–ª—é—Ü–∏—è', emoji: 'üå≥', reward: { chests: 10, money: 5000 } },
            'game_master': { name: '100 –∏–≥—Ä', emoji: 'üéÆ', reward: { money: 3000, chests: 8 } },
            'game_legend': { name: '500 –∏–≥—Ä', emoji: 'üèÜ', reward: { money: 10000, chests: 20 } },
            'task_streak_7': { name: '7 –¥–Ω–µ–π –∑–∞–¥–∞–Ω–∏–π', emoji: 'üî•', reward: { money: 1000, chests: 3 } },
            'task_streak_30': { name: '30 –¥–Ω–µ–π –∑–∞–¥–∞–Ω–∏–π', emoji: 'üí™', reward: { money: 5000, chests: 15 } },
            'skin_collector': { name: '5 —Å–∫–∏–Ω–æ–≤', emoji: 'üé®', reward: { money: 2000, chests: 5 } },
            'outfit_master': { name: '10 –Ω–∞—Ä—è–¥–æ–≤', emoji: 'üëó', reward: { money: 3000, chests: 8 } }
        };
    };

    LabubuCareGame.prototype.initializeEvents = function() {
        this.lastEvent = this.loadData('last_event', 0, 'number');
        this.activeEvent = this.loadData('active_event', null);
        
        return {
            'double_exp': { 
                name: '–î–≤–æ–π–Ω–æ–π –æ–ø—ã—Ç', 
                emoji: '‚≠ê', 
                duration: 3600000, // 1 —á–∞—Å
                effect: '–û–ø—ã—Ç —É–≤–µ–ª–∏—á–µ–Ω –≤ 2 —Ä–∞–∑–∞!',
                chance: 0.1
            },
            'money_rain': { 
                name: '–î–µ–Ω–µ–∂–Ω—ã–π –¥–æ–∂–¥—å', 
                emoji: 'üí∞', 
                duration: 1800000, // 30 –º–∏–Ω—É—Ç
                effect: '–î–µ–Ω—å–≥–∏ –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è —É–≤–µ–ª–∏—á–µ–Ω—ã –≤ 3 —Ä–∞–∑–∞!',
                chance: 0.05
            },
            'happiness_festival': { 
                name: '–§–µ—Å—Ç–∏–≤–∞–ª—å —Å—á–∞—Å—Ç—å—è', 
                emoji: 'üéâ', 
                duration: 7200000, // 2 —á–∞—Å–∞
                effect: '–°—á–∞—Å—Ç—å–µ –Ω–µ —Å–Ω–∏–∂–∞–µ—Ç—Å—è!',
                chance: 0.08
            }
        };
    };

    LabubuCareGame.prototype.generateInviteCode = function() {
        return 'LAB' + Math.random().toString(36).substr(2, 6).toUpperCase();
    };

    LabubuCareGame.prototype.updateStatus = function() {
        if (!this.statusSystem) return;
        
        const totalPoints = this.statusPoints + this.level * 100 + this.experience + this.money / 10;
        
        let newStatus = '–Ω–æ–≤–∏—á–æ–∫';
        for (const [statusKey, statusData] of Object.entries(this.statusSystem)) {
            if (totalPoints >= statusData.points) {
                newStatus = statusKey;
            }
        }
        
        if (newStatus !== this.currentStatus) {
            const status = this.statusSystem[newStatus];
            this.currentStatus = newStatus;
            this.showMessage(`üéâ –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: ${status.emoji} ${status.name}!`);
            this.playHappySound();
        }
    };

    LabubuCareGame.prototype.getCurrentPlayerStatus = function() {
        if (!this.statusSystem || !this.currentStatus) {
            return '–Ω–æ–≤–∏—á–æ–∫';
        }
        
        const totalPoints = this.statusPoints + this.level * 100 + this.experience + this.money / 10;
        
        let currentStatus = '–Ω–æ–≤–∏—á–æ–∫';
        for (const [statusKey, statusData] of Object.entries(this.statusSystem)) {
            if (totalPoints >= statusData.points) {
                currentStatus = statusKey;
            }
        }
        
        return currentStatus;
    };

    // –£–±–∏—Ä–∞–µ–º —Å–ª–æ–∂–Ω—ã–µ –±–æ–Ω—É—Å—ã - –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–ª—é—Å –∫ –Ω–∞–≥—Ä–∞–¥–∞–º
    // –§—É–Ω–∫—Ü–∏–∏ getFriendsDecayBonus –∏ getStatusDecayBonus —É–¥–∞–ª–µ–Ω—ã –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è

    LabubuCareGame.prototype.inviteFriend = function(friendCode) {
        if (!this.friendsSystem) return;
        
        if (friendCode === this.inviteCode) {
            this.showMessage('‚ùå –ù–µ–ª—å–∑—è –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è!');
            return;
        }
        
        if (this.friendsList.includes(friendCode)) {
            this.showMessage('‚ùå –≠—Ç–æ—Ç –¥—Ä—É–≥ —É–∂–µ –≤ –≤–∞—à–µ–º —Å–ø–∏—Å–∫–µ!');
            return;
        }
        
        // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
        this.friendsList.push(friendCode);
        this.friendsInvited++;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–≥—Ä–∞–¥—É –∑–∞ 10 –¥—Ä—É–∑–µ–π
        if (this.friendsList.length === 10) {
            const reward = this.friendsSystem.inviteRewards[10];
            this.chestCount += reward.chests;
            this.money += reward.money;
            this.showMessage(`üéâ ${reward.message} +${reward.chests} —Å—É–Ω–¥—É–∫, +${reward.money} –º–æ–Ω–µ—Ç!`);
        } else {
            // –û–±—ã—á–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞
            this.showMessage('üéâ –î—Ä—É–≥ –¥–æ–±–∞–≤–ª–µ–Ω! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –±–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π!');
        }
        
        this.checkChestReward();
        this.saveData();
        this.updateDisplay();
    };

    LabubuCareGame.prototype.checkAchievements = function() {
        if (!this.achievementsSystem) return;
        
        for (const [achievementId, achievement] of Object.entries(this.achievementsSystem)) {
            if (this.unlockedAchievements.includes(achievementId)) continue;
            
            let unlocked = false;
            
            switch (achievementId) {
                case 'first_feed':
                    unlocked = this.level > 1;
                    break;
                case 'level_10':
                    unlocked = this.level >= 10;
                    break;
                case 'happy_100':
                    unlocked = this.stats.happiness >= 100;
                    break;
                case 'rich_10k':
                    unlocked = this.money >= 10000;
                    break;
                case 'friend_master':
                    unlocked = this.friendsList.length >= 10;
                    break;
                case 'chest_opener':
                    unlocked = this.chestCount >= 50;
                    break;
                case 'evolution_adult':
                    unlocked = this.evolutionStage === 'adult';
                    break;
            }
            
            if (unlocked) {
                this.unlockAchievement(achievementId);
            }
        }
    };

    LabubuCareGame.prototype.unlockAchievement = function(achievementId) {
        const achievement = this.achievementsSystem[achievementId];
        this.unlockedAchievements.push(achievementId);
        
        if (achievement.reward.money) {
            this.money += achievement.reward.money;
        }
        if (achievement.reward.chests) {
            this.chestCount += achievement.reward.chests;
        }
        
        this.showMessage(`üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievement.emoji} ${achievement.name}!`);
        this.playHappySound();
    };

    LabubuCareGame.prototype.checkRandomEvents = function() {
        if (!this.eventsSystem) return;
        
        const now = Date.now();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
        if (this.activeEvent) {
            if (now > this.activeEvent.endTime) {
                this.showMessage(`üìÖ –°–æ–±—ã—Ç–∏–µ "${this.activeEvent.name}" –∑–∞–≤–µ—Ä—à–µ–Ω–æ!`);
                this.activeEvent = null;
            }
        }
        
        // –®–∞–Ω—Å –Ω–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
        if (now - this.lastEvent > 1800000) { // 30 –º–∏–Ω—É—Ç
            for (const [eventId, eventData] of Object.entries(this.eventsSystem)) {
                if (Math.random() < eventData.chance) {
                    this.startEvent(eventId);
                    break;
                }
            }
            this.lastEvent = now;
        }
    };

    LabubuCareGame.prototype.startEvent = function(eventId) {
        const eventData = this.eventsSystem[eventId];
        this.activeEvent = {
            id: eventId,
            name: eventData.name,
            emoji: eventData.emoji,
            effect: eventData.effect,
            endTime: Date.now() + eventData.duration
        };
        
        this.showMessage(`üé™ –°–æ–±—ã—Ç–∏–µ: ${eventData.emoji} ${eventData.name}! ${eventData.effect}`);
        this.playHappySound();
    };

    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –≤–∫–ª–∞–¥–∫–∏ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –º–µ—Ç–æ–¥—É
    LabubuCareGame.prototype.getFriendsTabContent = function() {
        if (!this.friendsSystem) return '<div>–°–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</div>';
        
        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üë• –î—Ä—É–∑—å—è –∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                    
                    <!-- –ú–æ–π –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
                    <div class="bg-green-50 p-3 rounded mb-3">
                        <div class="text-sm font-bold text-green-800 mb-1">–í–∞—à –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:</div>
                        <div class="flex items-center justify-between">
                            <code class="bg-green-200 px-2 py-1 rounded font-mono text-sm">${this.inviteCode}</code>
                            <button onclick="navigator.clipboard.writeText('${this.inviteCode}'); game.showMessage('–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!')" 
                                    class="bg-green-500 text-white px-2 py-1 rounded text-xs">
                                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                        <div class="text-xs text-green-700 mt-1">–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º –∫–æ–¥–æ–º —Å –¥—Ä—É–∑—å—è–º–∏!</div>
                    </div>
                    
                    <!-- –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞ -->
                    <div class="bg-blue-50 p-3 rounded mb-3">
                        <div class="text-sm font-bold text-blue-800 mb-2">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞:</div>
                        <div class="flex space-x-2">
                            <input type="text" id="friendCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥—Ä—É–≥–∞" 
                                class="flex-1 px-2 py-1 border rounded text-sm">
                            <button onclick="game.inviteFriend(document.getElementById('friendCode').value)" 
                                    class="bg-blue-500 text-white px-3 py-1 rounded text-xs">
                                –î–æ–±–∞–≤–∏—Ç—å
                            </button>
                        </div>
                        <div class="text-xs text-blue-700 mt-1">–î—Ä—É–∑—å—è –ø–æ–º–æ–≥–∞—é—Ç –≤–∞–º –≤ –∏–≥—Ä–µ!</div>
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π -->
                    <div class="bg-purple-50 p-3 rounded mb-3">
                        <div class="text-sm font-bold text-purple-800 mb-2">–ú–æ–∏ –¥—Ä—É–∑—å—è (${this.friendsList.length}):</div>
                        ${this.friendsList.length > 0 ? `
                            <div class="grid grid-cols-2 gap-2 max-h-24 overflow-y-auto">
                                ${this.friendsList.map(friend => `
                                    <div class="bg-purple-100 p-2 rounded text-xs text-center">
                                        üë§ ${friend}
                                    </div>
                                `).join('')}
                            </div>
                        ` : '<div class="text-xs text-purple-600">–ü–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –ø–µ—Ä–≤–æ–≥–æ!</div>'}
                    </div>
                    
                    <!-- –û—Å–æ–±–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ 10 –¥—Ä—É–∑–µ–π -->
                    <div class="bg-yellow-50 p-3 rounded">
                        <div class="text-sm font-bold text-yellow-800 mb-2">üéÅ –û—Å–æ–±–∞—è –Ω–∞–≥—Ä–∞–¥–∞:</div>
                        <div class="text-xs text-yellow-700">
                            <div class="flex justify-between ${this.friendsList.length >= 10 ? 'line-through text-green-600' : ''}">
                                <span>10 –¥—Ä—É–∑–µ–π:</span>
                                <span>+1üì¶ +2000üí∞</span>
                            </div>
                            <div class="text-xs text-gray-600 mt-1">
                                –ü—Ä–æ–≥—Ä–µ—Å—Å: ${this.friendsList.length}/10 –¥—Ä—É–∑–µ–π
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ë–æ–Ω—É—Å—ã –æ—Ç –¥—Ä—É–∑–µ–π -->
                    <div class="bg-blue-50 p-3 rounded">
                        <div class="text-sm font-bold text-blue-800 mb-2">üí™ –ë–æ–Ω—É—Å—ã –æ—Ç –¥—Ä—É–∑–µ–π:</div>
                        <div class="text-xs text-blue-700">
                            üîπ –°–æ–≤–º–µ—Å—Ç–Ω–∞—è –∑–∞–±–æ—Ç–∞ –æ –ø–∏—Ç–æ–º—Ü–µ<br>
                            üîπ –ö–∞–∂–¥—ã–π –¥—Ä—É–≥ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞—à–µ–º—É –ø–∏—Ç–æ–º—Ü—É!<br>
                            üîπ –ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –±–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π –¥–ª—è –≤–µ—Å–µ–ª—å—è
                        </div>
                    </div>
                </div>
            </div>
        `;
    };

    LabubuCareGame.prototype.getAchievementsTabContent = function() {
        if (!this.achievementsSystem) return '<div>–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</div>';
        
        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (${this.unlockedAchievements.length}/${Object.keys(this.achievementsSystem).length})</h3>
                    
                    <div class="grid grid-cols-1 gap-2 max-h-64 overflow-y-auto">
                        ${Object.entries(this.achievementsSystem).map(([achievementId, achievement]) => {
                            const isUnlocked = this.unlockedAchievements.includes(achievementId);
                            return `
                                <div class="p-3 rounded ${isUnlocked ? 'bg-green-50 border border-green-200' : 'bg-gray-50 border border-gray-200'}">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-2">
                                            <span class="text-lg ${isUnlocked ? '' : 'grayscale'}">${achievement.emoji}</span>
                                            <div>
                                                <div class="font-medium text-sm ${isUnlocked ? 'text-green-800' : 'text-gray-600'}">${achievement.name}</div>
                                                <div class="text-xs ${isUnlocked ? 'text-green-600' : 'text-gray-500'}">
                                                    ${achievement.reward.money ? `+${achievement.reward.money}üí∞ ` : ''}
                                                    ${achievement.reward.chests ? `+${achievement.reward.chests}üì¶` : ''}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-xl">${isUnlocked ? '‚úÖ' : 'üîí'}</div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∫ –Ω–æ–≤—ã–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º -->
                <div class="bg-white rounded-lg p-3 shadow">
                    <h4 class="font-bold mb-2 text-purple-800 text-sm">üìà –ü—Ä–æ–≥—Ä–µ—Å—Å:</h4>
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between">
                            <span>–£—Ä–æ–≤–µ–Ω—å:</span>
                            <span>${this.level}/10 –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–£—Ä–æ–≤–µ–Ω—å 10"</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–î–µ–Ω—å–≥–∏:</span>
                            <span>${this.money}/10,000 –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "10,000 –º–æ–Ω–µ—Ç"</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–î—Ä—É–∑—å—è:</span>
                            <span>${this.friendsList.length}/10 –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "10 –¥—Ä—É–∑–µ–π"</span>
                        </div>
                    </div>
                </div>
            </div>
        `;
    };

    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
    LabubuCareGame.prototype.updateStatusDisplay = function() {
        if (!this.statusSystem || !this.currentStatus) return;
        
        const status = this.statusSystem[this.currentStatus];
        const petContainer = document.getElementById('petContainer');
        const petFrame = document.getElementById('petFrame');
        const statusBadge = document.getElementById('statusBadge');
        const statusEmoji = document.getElementById('statusEmoji');
        const statusName = document.getElementById('statusName');
        const activeEventDisplay = document.getElementById('activeEventDisplay');
        const activeEventText = document.getElementById('activeEventText');
        const eventEffect = document.getElementById('eventEffect');
        
        if (status && petContainer && petFrame && statusBadge) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ —Ä–∞–º–∫—É
            petContainer.className = `text-center mb-4 bg-white rounded-lg p-6 shadow ${status.bg}`;
            petFrame.className = `mb-4 relative inline-block ${status.frame} rounded-lg p-2`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–æ–∫ —Å—Ç–∞—Ç—É—Å–∞
            statusBadge.className = `inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ${status.bg} ${status.frame}`;
            if (statusEmoji) statusEmoji.textContent = status.emoji;
            if (statusName) statusName.textContent = status.name;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
        if (this.activeEvent && activeEventDisplay && activeEventText) {
            activeEventDisplay.classList.remove('hidden');
            activeEventText.textContent = `${this.activeEvent.emoji} ${this.activeEvent.name}: ${this.activeEvent.effect}`;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—á–µ–Ω–∏—è
            if (eventEffect) {
                eventEffect.classList.remove('hidden');
                eventEffect.className = 'absolute -inset-2 rounded-lg bg-gradient-to-r from-purple-300 via-pink-300 to-blue-300 opacity-50 animate-pulse';
            }
        } else if (activeEventDisplay) {
            activeEventDisplay.classList.add('hidden');
            if (eventEffect) eventEffect.classList.add('hidden');
        }
    };

    // ===== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –°–ò–°–¢–ï–ú–´ =====

    // –°–∏—Å—Ç–µ–º–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
    LabubuCareGame.prototype.initializeDailyTasks = function() {
        this.lastTaskReset = this.loadData('last_task_reset', Date.now(), 'number');
        this.completedTasks = this.loadData('completed_tasks', [], 'array');
        this.taskStreak = this.loadData('task_streak', 0, 'number');
        this.taskProgress = this.loadData('task_progress', {}, 'object');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ —Å–±—Ä–æ—Å–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
        const now = Date.now();
        const timeSinceReset = now - this.lastTaskReset;
        const hoursRequired = 24; // –¢–æ—á–Ω–æ 24 —á–∞—Å–∞
        
        if (timeSinceReset >= (hoursRequired * 60 * 60 * 1000)) {
            this.resetDailyTasks();
        }
        
        // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
        if (!this.taskProgress || typeof this.taskProgress !== 'object') {
            this.taskProgress = {};
            this.saveValue('task_progress', this.taskProgress);
        }
        
        // –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –æ–±–Ω—É–ª—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–æ–≥—Ä–µ—Å—Å—ã
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∑–∞–¥–∞–Ω–∏–π...');
        const taskIds = ['feed_times', 'play_games', 'wash_pet', 'reach_happiness', 'earn_money', 'reach_all_stats_high'];
        taskIds.forEach(taskId => {
            if (this.taskProgress[taskId] && (isNaN(this.taskProgress[taskId]) || this.taskProgress[taskId] === undefined)) {
                console.log(`üîß –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è ${taskId}: ${this.taskProgress[taskId]} ‚Üí 0`);
                this.taskProgress[taskId] = 0;
            }
        });
        this.saveValue('task_progress', this.taskProgress);
        
        // –°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–Ω–∏–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è –∏–≥—Ä–æ–∫–∞
        const levelMultiplier = Math.max(1, Math.floor((this.level || 1) / 10) + 1); // +1 —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–∞–∂–¥—ã–µ 10 —É—Ä–æ–≤–Ω–µ–π
        const baseReward = 100 * levelMultiplier;
        
        // –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        const safeProgress = (taskId, defaultValue = 0) => {
            const progress = this.taskProgress[taskId];
            if (progress === undefined || progress === null || isNaN(progress)) {
                console.log(`üîß –û–±–Ω—É–ª—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å ${taskId}: ${progress} ‚Üí ${defaultValue}`);
                this.taskProgress[taskId] = defaultValue;
                return defaultValue;
            }
            return Math.max(0, Math.floor(progress)); // –û–∫—Ä—É–≥–ª—è–µ–º –∏ –¥–µ–ª–∞–µ–º –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
        };
        
        return {
            tasks: [
                { 
                    id: 'feed_times', 
                    name: `–ü–æ–∫–æ—Ä–º–∏—Ç—å ${3 + levelMultiplier} —Ä–∞–∑`, 
                    description: `–ü–æ–∫–æ—Ä–º–∏—Ç–µ –ø–∏—Ç–æ–º—Ü–∞ ${3 + levelMultiplier} —Ä–∞–∑ –∑–∞ –¥–µ–Ω—å`,
                    progress: this.completedTasks.includes('feed_times') ? (3 + levelMultiplier) : safeProgress('feed_times', 0),
                    target: 3 + levelMultiplier, 
                    reward: { money: baseReward * 2, experience: 30 + (levelMultiplier * 10), chests: levelMultiplier },
                    emoji: 'üçΩÔ∏è',
                    type: 'feed'
                },
                { 
                    id: 'play_games', 
                    name: `–°—ã–≥—Ä–∞—Ç—å ${2 + levelMultiplier} –∏–≥—Ä`, 
                    description: `–°—ã–≥—Ä–∞–π—Ç–µ –≤ –º–∏–Ω–∏-–∏–≥—Ä—ã ${2 + levelMultiplier} —Ä–∞–∑`,
                    progress: this.completedTasks.includes('play_games') ? (2 + levelMultiplier) : safeProgress('play_games', 0),
                    target: 2 + levelMultiplier, 
                    reward: { money: baseReward * 1.5, experience: 50 + (levelMultiplier * 15), happiness: 15 + (levelMultiplier * 5) },
                    emoji: 'üéÆ',
                    type: 'game'
                },
                { 
                    id: 'wash_pet', 
                    name: `–ü–æ–º—ã—Ç—å –ø–∏—Ç–æ–º—Ü–∞ ${Math.max(1, levelMultiplier)} —Ä–∞–∑`, 
                    description: `–ü–æ–º–æ–π—Ç–µ –ø–∏—Ç–æ–º—Ü–∞ ${Math.max(1, levelMultiplier)} —Ä–∞–∑`,
                    progress: this.completedTasks.includes('wash_pet') ? Math.max(1, levelMultiplier) : safeProgress('wash_pet', 0),
                    target: Math.max(1, levelMultiplier), 
                    reward: { money: baseReward, experience: 20 + (levelMultiplier * 5), cleanliness: 30 + (levelMultiplier * 10) },
                    emoji: 'üõÅ',
                    type: 'wash'
                },
                { 
                    id: 'reach_happiness', 
                    name: `–°—á–∞—Å—Ç—å–µ ${Math.min(100, 80 + levelMultiplier * 5)}%+`, 
                    description: `–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ ${Math.min(100, 80 + levelMultiplier * 5)}% —Å—á–∞—Å—Ç—å—è`,
                    progress: this.completedTasks.includes('reach_happiness') ? 1 : safeProgress('reach_happiness', 0), 
                    target: 1, 
                    reward: { money: baseReward * 2.5, chests: Math.max(1, levelMultiplier) },
                    emoji: 'üòä',
                    type: 'stat'
                },
                { 
                    id: 'earn_money', 
                    name: `–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å ${300 + (levelMultiplier * 200)} –º–æ–Ω–µ—Ç`, 
                    description: `–ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ ${300 + (levelMultiplier * 200)} –º–æ–Ω–µ—Ç –∑–∞ –¥–µ–Ω—å`,
                    progress: this.completedTasks.includes('earn_money') ? (300 + (levelMultiplier * 200)) : safeProgress('earn_money', 0),
                    target: 300 + (levelMultiplier * 200), 
                    reward: { experience: 80 + (levelMultiplier * 20), chests: 2 + levelMultiplier },
                    emoji: 'üí∞',
                    type: 'money'
                },
                // –ù–æ–≤–æ–µ —Å–ª–æ–∂–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π
                ...(this.level >= 20 ? [{
                    id: 'reach_all_stats_high', 
                    name: `–í—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ${70 + levelMultiplier * 3}%+`, 
                    description: `–ü–æ–¥–Ω–∏–º–∏—Ç–µ –≤—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ã—à–µ ${70 + levelMultiplier * 3}%`,
                    progress: this.completedTasks.includes('reach_all_stats_high') ? 1 : safeProgress('reach_all_stats_high', 0),
                    target: 1, 
                    reward: { money: baseReward * 3, experience: 100 + (levelMultiplier * 25), chests: 2 + levelMultiplier },
                    emoji: 'üìä',
                    type: 'all_stats'
                }] : [])
            ]
        };
    };

    LabubuCareGame.prototype.resetDailyTasks = function() {
        this.completedTasks = [];
        this.taskProgress = {}; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        this.lastTaskReset = Date.now();
        this.saveValue('completed_tasks', this.completedTasks);
        this.saveValue('task_progress', this.taskProgress);
        this.saveValue('last_task_reset', this.lastTaskReset);
        
        // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Å–∏—Å—Ç–µ–º—É –∑–∞–¥–∞–Ω–∏–π —Å –Ω–æ–≤–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é
        this.dailyTasksSystem = this.initializeDailyTasks();
        
        console.log('üóìÔ∏è –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è —Å–±—Ä–æ—à–µ–Ω—ã —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞');
    };

    LabubuCareGame.prototype.updateTaskProgress = function(taskType, amount = 1) {
        if (!this.dailyTasksSystem || !this.dailyTasksSystem.tasks) {
            console.log('‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
            return;
        }
        
        this.dailyTasksSystem.tasks.forEach(task => {
            if (task.type === taskType && !this.completedTasks.includes(task.id)) {
                const oldProgress = task.progress;
                task.progress = Math.min(task.target, task.progress + amount);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ
                if (!this.taskProgress) this.taskProgress = {};
                this.taskProgress[task.id] = task.progress;
                this.saveValue('task_progress', this.taskProgress);
                
                console.log(`üìã –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏—è ${task.id}: ${oldProgress} ‚Üí ${task.progress}/${task.target}`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
                if (task.progress >= task.target) {
                    this.completeTask(task);
                }
            }
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è "–≤—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ã—Å–æ–∫–∏–µ"
            if (task.type === 'all_stats' && !this.completedTasks.includes(task.id)) {
                const minRequired = 70 + Math.max(1, Math.floor(this.level / 10) + 1) * 3;
                const allStatsHigh = Object.values(this.stats).every(stat => stat >= minRequired);
                
                if (allStatsHigh && task.progress === 0) {
                    task.progress = 1;
                    if (!this.taskProgress) this.taskProgress = {};
                    this.taskProgress[task.id] = 1;
                    this.saveValue('task_progress', this.taskProgress);
                    this.completeTask(task);
                }
            }
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è "–¥–æ—Å—Ç–∏—á—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è —Å—á–∞—Å—Ç—å—è"
            if (task.type === 'stat' && task.id === 'reach_happiness' && !this.completedTasks.includes(task.id)) {
                const levelMultiplier = Math.max(1, Math.floor(this.level / 10) + 1);
                const minRequired = Math.min(100, 80 + levelMultiplier * 5);
                
                if (this.stats.happiness >= minRequired && task.progress === 0) {
                    task.progress = 1;
                    if (!this.taskProgress) this.taskProgress = {};
                    this.taskProgress[task.id] = 1;
                    this.saveValue('task_progress', this.taskProgress);
                    this.completeTask(task);
                }
            }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –∑–∞–¥–∞–Ω–∏–π
        if (this.activeTab === 'tasks') {
            this.switchTab('tasks');
        }
    };

    LabubuCareGame.prototype.completeTask = function(task) {
        if (this.completedTasks.includes(task.id)) return;
        
        this.completedTasks.push(task.id);
        
        // –í—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—ã
        if (task.reward.money) {
            this.money += task.reward.money;
        }
        if (task.reward.experience) {
            this.experience += task.reward.experience;
        }
        if (task.reward.chests) {
            this.chestCount += task.reward.chests;
        }
        if (task.reward.happiness) {
            this.stats.happiness = Math.min(100, this.stats.happiness + task.reward.happiness);
        }
        if (task.reward.cleanliness) {
            this.stats.cleanliness = Math.min(100, this.stats.cleanliness + task.reward.cleanliness);
        }
        
        this.showMessage(`‚úÖ –ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${task.emoji} ${task.name}!`);
        this.playHappySound();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
        if (this.completedTasks.length === this.dailyTasksSystem.tasks.length) {
            this.taskStreak++;
            const streakBonus = this.taskStreak * 100;
            this.money += streakBonus;
            this.chestCount += Math.floor(this.taskStreak / 3);
            
            this.showMessage(`üéâ –í—Å–µ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã! –°–µ—Ä–∏—è: ${this.taskStreak} –¥–Ω–µ–π! +${streakBonus} –º–æ–Ω–µ—Ç!`);
            this.saveValue('task_streak', this.taskStreak);
        }
        
        this.saveValue('completed_tasks', this.completedTasks);
        this.checkLevelUp();
        this.saveData();
        this.updateDisplay();
    };

    // –°–∏—Å—Ç–µ–º–∞ –ø–æ–≥–æ–¥—ã –∏ –æ—Å–æ–±—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
    LabubuCareGame.prototype.initializeWeatherSystem = function() {
        this.currentWeather = this.loadData('current_weather', 'sunny', 'string');
        this.lastWeatherChange = this.loadData('last_weather_change', 0, 'number');
        
        return {
            weathers: {
                'sunny': { 
                    name: '–°–æ–ª–Ω–µ—á–Ω–æ', 
                    emoji: '‚òÄÔ∏è', 
                    effect: '–°—á–∞—Å—Ç—å–µ +20% –±—ã—Å—Ç—Ä–µ–µ',
                    bonus: { happiness: 1.2 },
                    duration: 2 * 60 * 60 * 1000 // 2 —á–∞—Å–∞
                },
                'rainy': { 
                    name: '–î–æ–∂–¥—å', 
                    emoji: 'üåßÔ∏è', 
                    effect: '–ß–∏—Å—Ç–æ—Ç–∞ —Å–Ω–∏–∂–∞–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–µ–µ',
                    bonus: { cleanliness: 0.5 },
                    duration: 1.5 * 60 * 60 * 1000 // 1.5 —á–∞—Å–∞
                },
                'cloudy': { 
                    name: '–û–±–ª–∞—á–Ω–æ', 
                    emoji: '‚òÅÔ∏è', 
                    effect: '–≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ',
                    bonus: { energy: 1.3 },
                    duration: 3 * 60 * 60 * 1000 // 3 —á–∞—Å–∞
                },
                'snowy': { 
                    name: '–°–Ω–µ–≥', 
                    emoji: '‚ùÑÔ∏è', 
                    effect: '–°–æ–Ω –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ',
                    bonus: { sleep: 1.5 },
                    duration: 2.5 * 60 * 60 * 1000 // 2.5 —á–∞—Å–∞
                },
                'rainbow': { 
                    name: '–†–∞–¥—É–≥–∞', 
                    emoji: 'üåà', 
                    effect: '–í—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ +50% –±—ã—Å—Ç—Ä–µ–µ!',
                    bonus: { all: 1.5 },
                    duration: 30 * 60 * 1000, // 30 –º–∏–Ω—É—Ç
                    rare: true
                }
            }
        };
    };

    LabubuCareGame.prototype.updateWeather = function() {
        if (!this.weatherSystem) return;
        
        const now = Date.now();
        const currentWeatherData = this.weatherSystem.weathers[this.currentWeather];
        
        if (now - this.lastWeatherChange > currentWeatherData.duration) {
            // –í—Ä–µ–º—è —Å–º–µ–Ω–∏—Ç—å –ø–æ–≥–æ–¥—É
            const weathers = Object.keys(this.weatherSystem.weathers);
            let newWeather;
            
            // 5% —à–∞–Ω—Å –Ω–∞ —Ä–µ–¥–∫—É—é –ø–æ–≥–æ–¥—É (—Ä–∞–¥—É–≥–∞)
            if (Math.random() < 0.05) {
                newWeather = 'rainbow';
            } else {
                // –í—ã–±–∏—Ä–∞–µ–º –æ–±—ã—á–Ω—É—é –ø–æ–≥–æ–¥—É
                const normalWeathers = weathers.filter(w => !this.weatherSystem.weathers[w].rare);
                newWeather = normalWeathers[Math.floor(Math.random() * normalWeathers.length)];
            }
            
            if (newWeather !== this.currentWeather) {
                this.currentWeather = newWeather;
                this.lastWeatherChange = now;
                
                const weather = this.weatherSystem.weathers[newWeather];
                this.showMessage(`üå§Ô∏è –ü–æ–≥–æ–¥–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å: ${weather.emoji} ${weather.name}! ${weather.effect}`);
                
                this.saveValue('current_weather', this.currentWeather);
                this.saveValue('last_weather_change', this.lastWeatherChange);
            }
        }
    };

    // –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
    LabubuCareGame.prototype.getEnhancedStatusFrame = function(statusKey) {
        const frames = {
            '–Ω–æ–≤–∏—á–æ–∫': {
                frame: 'border-2 border-gray-300 shadow-sm',
                bg: 'bg-gray-50',
                glow: '',
                animation: ''
            },
            '–æ–ø—ã—Ç–Ω—ã–π': {
                frame: 'border-2 border-blue-400 shadow-lg shadow-blue-200',
                bg: 'bg-gradient-to-br from-blue-50 to-blue-100',
                glow: 'drop-shadow-lg',
                animation: ''
            },
            '—ç–∫—Å–ø–µ—Ä—Ç': {
                frame: 'border-2 border-purple-400 shadow-lg shadow-purple-200',
                bg: 'bg-gradient-to-br from-purple-50 via-purple-100 to-purple-50',
                glow: 'drop-shadow-xl',
                animation: 'animate-pulse'
            },
            '–º–∞—Å—Ç–µ—Ä': {
                frame: 'border-3 border-yellow-400 shadow-xl shadow-yellow-300',
                bg: 'bg-gradient-to-br from-yellow-50 via-yellow-100 to-orange-50',
                glow: 'drop-shadow-2xl filter brightness-110',
                animation: 'animate-pulse',
                special: 'ring-2 ring-yellow-300 ring-opacity-50'
            },
            '–ª–µ–≥–µ–Ω–¥–∞': {
                frame: 'border-4 border-gradient-to-r from-purple-400 via-pink-400 to-red-400 shadow-2xl shadow-purple-400',
                bg: 'bg-gradient-to-br from-purple-100 via-pink-100 to-red-100',
                glow: 'drop-shadow-2xl filter brightness-125 saturate-150',
                animation: 'animate-pulse',
                special: 'ring-4 ring-purple-300 ring-opacity-75 ring-offset-2',
                sparkle: true
            },
            '–±–æ–≥': {
                frame: 'border-4 border-gradient-to-r from-yellow-400 via-orange-400 to-red-400 shadow-2xl shadow-orange-400',
                bg: 'bg-gradient-to-br from-yellow-100 via-orange-100 to-red-100',
                glow: 'drop-shadow-2xl filter brightness-150 saturate-200 hue-rotate-15',
                animation: 'animate-pulse',
                special: 'ring-4 ring-yellow-400 ring-opacity-100 ring-offset-4 ring-offset-yellow-100',
                sparkle: true,
                divine: true
            }
        };
        
        return frames[statusKey] || frames['–Ω–æ–≤–∏—á–æ–∫'];
    };

    // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º getTabContent –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
    LabubuCareGame.prototype.getTabContent = function(tab) {
        switch (tab) {
            case 'care':
                return this.getCareTabContent();
            case 'games':
                return this.getGamesTabContent();
            case 'shop':
                return this.getShopTabContent();
            case 'chests':
                return this.getChestsTabContent();
            case 'pets':
                return this.getPetsTabContent();
            case 'friends':
                return this.getFriendsTabContent();
            case 'achievements':
                return this.getAchievementsTabContent();
            case 'tasks':
                return this.getDailyTasksTabContent();
            case 'status':
                return this.getStatusTabContent();
            case 'info':
                return this.getInfoTabContent();
            default:
                return '<div class="bg-white rounded-lg p-4 shadow text-center"><h3 class="font-bold text-purple-800">üîß –í–∫–ª–∞–¥–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h3><p class="text-gray-600">–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!</p></div>';
        }
    };

    // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
    LabubuCareGame.prototype.getDailyTasksTabContent = function() {
        if (!this.dailyTasksSystem) return '<div>–°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</div>';
        
        const timeUntilReset = this.getTimeUntilTaskReset();
        
        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üìã –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>
                    
                    <div class="bg-blue-50 p-3 rounded mb-3">
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-sm font-bold text-blue-800">–°–µ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π: ${this.taskStreak} –¥–Ω–µ–π üî•</div>
                                <div class="text-xs text-blue-700">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑: ${timeUntilReset}</div>
                                <div class="text-xs text-gray-600 mt-1">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${this.completedTasks.length}/${this.dailyTasksSystem.tasks.length} –∑–∞–¥–∞–Ω–∏–π</div>
                            </div>
                            <div class="text-2xl">üìÖ</div>
                        </div>

                    </div>
                    
                    <div class="space-y-2 max-h-64 overflow-y-auto">
                        ${this.dailyTasksSystem.tasks.map(task => {
                            const isCompleted = this.completedTasks.includes(task.id);
                            const progress = Math.min(100, (task.progress / task.target) * 100);
                            
                            return `
                                <div class="p-3 rounded ${isCompleted ? 'bg-green-50 border border-green-200' : 'bg-gray-50 border border-gray-200'}">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center space-x-2">
                                            <span class="text-lg">${task.emoji}</span>
                                            <div>
                                                <div class="font-medium text-sm ${isCompleted ? 'text-green-800 line-through' : 'text-gray-800'}">${task.name}</div>
                                                <div class="text-xs ${isCompleted ? 'text-green-600' : 'text-gray-600'}">${task.description}</div>
                                            </div>
                                        </div>
                                        <div class="text-xl">${isCompleted ? '‚úÖ' : '‚è≥'}</div>
                                    </div>
                                    
                                    ${!isCompleted ? `
                                        <div class="mb-2">
                                            <div class="flex justify-between text-xs mb-1">
                                                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                                                <span>${task.progress}/${task.target}</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: ${progress}%"></div>
                                            </div>
                                        </div>
                                    ` : ''}
                                    
                                    <div class="text-xs ${isCompleted ? 'text-green-600' : 'text-purple-600'}">
                                        <strong>–ù–∞–≥—Ä–∞–¥–∞:</strong>
                                        ${task.reward.money ? `+${task.reward.money}üí∞ ` : ''}
                                        ${task.reward.experience ? `+${task.reward.experience}‚≠ê ` : ''}
                                        ${task.reward.chests ? `+${task.reward.chests}üì¶ ` : ''}
                                        ${task.reward.happiness ? `+${task.reward.happiness}üòä ` : ''}
                                        ${task.reward.cleanliness ? `+${task.reward.cleanliness}üõÅ` : ''}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="mt-3 p-3 bg-yellow-50 rounded">
                        <div class="text-sm font-bold text-yellow-800 mb-1">üéÅ –ë–æ–Ω—É—Å –∑–∞ —Å–µ—Ä–∏—é:</div>
                        <div class="text-xs text-yellow-700">
                            ‚Ä¢ –ó–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å: +${this.taskStreak * 100} –º–æ–Ω–µ—Ç<br>
                            ‚Ä¢ –ö–∞–∂–¥—ã–µ 3 –¥–Ω—è: +1 —Å—É–Ω–¥—É–∫<br>
                            ‚Ä¢ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: ${this.completedTasks.length}/${this.dailyTasksSystem.tasks.length}
                        </div>
                    </div>
                    

                </div>
            </div>
        `;
    };

    LabubuCareGame.prototype.getTimeUntilTaskReset = function() {
        const now = Date.now();
        const timeSinceReset = now - this.lastTaskReset;
        const hoursRequired = 24; // 24 —á–∞—Å–∞
        const timeRemaining = (hoursRequired * 60 * 60 * 1000) - timeSinceReset;
        
        if (timeRemaining <= 0) {
            return '0—á 0–º (–≥–æ—Ç–æ–≤–æ –∫ —Å–±—Ä–æ—Å—É)';
        }
        
        const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
        const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
        
        return `${hours}—á ${minutes}–º`;
    };

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    LabubuCareGame.prototype.validateTaskProgress = function() {
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–¥–∞–Ω–∏–π...');
        
        if (!this.dailyTasksSystem || !this.dailyTasksSystem.tasks) {
            console.log('‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞, –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ–º...');
            this.dailyTasksSystem = this.initializeDailyTasks();
            if (!this.dailyTasksSystem || !this.dailyTasksSystem.tasks) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∑–∞–¥–∞–Ω–∏–π');
                return;
            }
        }
        
        let hasInvalidProgress = false;
        
        this.dailyTasksSystem.tasks.forEach(task => {
            // –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ NaN –∏ undefined
            if (task.progress === undefined || task.progress === null || isNaN(task.progress) || !isFinite(task.progress)) {
                console.log(`üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –∑–∞–¥–∞–Ω–∏–∏ ${task.id}: ${task.progress} ‚Üí 0`);
                task.progress = 0;
                if (this.taskProgress) {
                    this.taskProgress[task.id] = 0;
                }
                hasInvalidProgress = true;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è target
            if (task.target === undefined || task.target === null || isNaN(task.target) || !isFinite(task.target) || task.target <= 0) {
                console.log(`üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ü–µ–ª—å –≤ –∑–∞–¥–∞–Ω–∏–∏ ${task.id}: ${task.target} ‚Üí 1`);
                task.target = 1;
                hasInvalidProgress = true;
            }
            
            // –ï—Å–ª–∏ –∑–∞–¥–∞–Ω–∏–µ –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö, –Ω–æ –∏–º–µ–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
            if (!this.completedTasks.includes(task.id) && task.progress >= task.target) {
                console.log(`üêõ –ù–∞–π–¥–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –∑–∞–¥–∞–Ω–∏–∏ ${task.id}: ${task.progress}/${task.target}`);
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫ 0
                task.progress = 0;
                if (this.taskProgress) {
                    this.taskProgress[task.id] = 0;
                }
                hasInvalidProgress = true;
            }
        });
        
        if (hasInvalidProgress) {
            this.saveValue('task_progress', this.taskProgress || {});
            console.log('‚úÖ –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω');
            this.showMessage('üîß –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω!');
        } else {
            console.log('‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω');
        }
    };

    // –§—É–Ω–∫—Ü–∏—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∑–∞–¥–∞–Ω–∏–π
    LabubuCareGame.prototype.emergencyTaskReset = function() {
        console.log('üö® –≠–ö–°–¢–†–ï–ù–ù–ê–Ø –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –°–ò–°–¢–ï–ú–´ –ó–ê–î–ê–ù–ò–ô');
        
        // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏–π
        this.completedTasks = [];
        this.taskProgress = {};
        this.taskStreak = 0;
        this.lastTaskReset = Date.now();
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º
        this.saveValue('completed_tasks', []);
        this.saveValue('task_progress', {});
        this.saveValue('task_streak', 0);
        this.saveValue('last_task_reset', Date.now());
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Å–∏—Å—Ç–µ–º—É –∑–∞–¥–∞–Ω–∏–π
        this.dailyTasksSystem = null;
        this.dailyTasksSystem = this.initializeDailyTasks();
        
        console.log('‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        this.showMessage('üîÑ –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        if (this.activeTab === 'tasks') {
            this.switchTab('tasks');
        }
    };

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –º–µ—Ç–æ–¥ feedPet –¥–ª—è —É—á–µ—Ç–∞ –∑–∞–¥–∞–Ω–∏–π
    const originalFeedPet = LabubuCareGame.prototype.feedPet;
    LabubuCareGame.prototype.feedPet = function(foodIndex) {
        const oldMoney = this.money;
        const result = originalFeedPet.call(this, foodIndex);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–∫–æ—Ä–º–∏–ª–∏ —É—Å–ø–µ—à–Ω–æ (–¥–µ–Ω—å–≥–∏ —É–º–µ–Ω—å—à–∏–ª–∏—Å—å)
        if (this.money < oldMoney) {
            this.updateTaskProgress('feed');
            console.log(`üìã –ó–∞–¥–∞–Ω–∏–µ –ø–æ–∫–æ—Ä–º–∏—Ç—å: +1 –ø—Ä–æ–≥—Ä–µ—Å—Å`);
        }
        
        return result;
    };

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º washPet –¥–ª—è —É—á–µ—Ç–∞ –∑–∞–¥–∞–Ω–∏–π
    const originalWashPet = LabubuCareGame.prototype.washPet;
    LabubuCareGame.prototype.washPet = function() {
        const result = originalWashPet.call(this);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏—è
        this.updateTaskProgress('wash');
        
        return result;
    };

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º completeMiniGame –¥–ª—è —É—á–µ—Ç–∞ –∑–∞–¥–∞–Ω–∏–π
    const originalCompleteMiniGame = LabubuCareGame.prototype.completeMiniGame;
    LabubuCareGame.prototype.completeMiniGame = function(success) {
        const oldMoney = this.money;
        const result = originalCompleteMiniGame.call(this, success);
        
        if (success && this.currentMiniGame) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏—è
            this.updateTaskProgress('game');
            console.log(`üìã –ó–∞–¥–∞–Ω–∏–µ –∏–≥—Ä—ã: +1 –ø—Ä–æ–≥—Ä–µ—Å—Å`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–µ–Ω–µ–≥ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–µ–Ω—å–≥–∏ —É–≤–µ–ª–∏—á–∏–ª–∏—Å—å)
            const moneyGained = this.money - oldMoney;
            if (moneyGained > 0) {
                this.updateTaskProgress('money', moneyGained);
                console.log(`üìã –ó–∞–¥–∞–Ω–∏–µ –¥–µ–Ω–µ–≥: +${moneyGained} –ø—Ä–æ–≥—Ä–µ—Å—Å`);
            }
        }
        
        return result;
    };

    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
    LabubuCareGame.prototype.updateStatusDisplayEnhanced = function() {
        if (!this.statusSystem || !this.currentStatus) return;
        
        const status = this.statusSystem[this.currentStatus];
        const enhancedFrame = this.getEnhancedStatusFrame(this.currentStatus);
        
        const petContainer = document.getElementById('petContainer');
        const petFrame = document.getElementById('petFrame');
        const statusBadge = document.getElementById('statusBadge');
        const statusEmoji = document.getElementById('statusEmoji');
        const statusName = document.getElementById('statusName');
        
        if (status && petContainer && petFrame && statusBadge) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
            petContainer.className = `text-center mb-4 bg-white rounded-lg p-6 shadow ${enhancedFrame.bg} ${enhancedFrame.animation}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–º–∫—É —Å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
            let frameClass = `mb-4 relative inline-block ${enhancedFrame.frame} rounded-lg p-2 ${enhancedFrame.glow}`;
            if (enhancedFrame.special) frameClass += ` ${enhancedFrame.special}`;
            petFrame.className = frameClass;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏—Å–∫—Ä—ã –¥–ª—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –∏ –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
            if (enhancedFrame.sparkle) {
                this.addSparkleEffects(petFrame, enhancedFrame.divine);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–æ–∫ —Å—Ç–∞—Ç—É—Å–∞
            statusBadge.className = `inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ${enhancedFrame.bg} ${enhancedFrame.frame} ${enhancedFrame.animation}`;
            if (statusEmoji) statusEmoji.textContent = status.emoji;
            if (statusName) statusName.textContent = status.name;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É
        this.updateWeatherDisplay();
    };

    LabubuCareGame.prototype.addSparkleEffects = function(element, isDivine = false) {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∏—Å–∫—Ä—ã
        const oldSparkles = element.querySelectorAll('.sparkle-effect');
        oldSparkles.forEach(sparkle => sparkle.remove());
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∏—Å–∫—Ä—ã
        const sparkleCount = isDivine ? 8 : 5;
        const sparkleEmojis = isDivine ? ['‚≠ê', '‚ú®', 'üí´', 'üåü'] : ['‚ú®', 'üí´'];
        
        for (let i = 0; i < sparkleCount; i++) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle-effect absolute text-lg animate-pulse';
            sparkle.textContent = sparkleEmojis[Math.floor(Math.random() * sparkleEmojis.length)];
            sparkle.style.top = Math.random() * 100 + '%';
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.animationDelay = Math.random() * 2 + 's';
            sparkle.style.zIndex = '20';
            element.appendChild(sparkle);
            
            // –£–¥–∞–ª—è–µ–º –∏—Å–∫—Ä—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (sparkle.parentNode) {
                    sparkle.parentNode.removeChild(sparkle);
                }
            }, 3000);
        }
    };

    LabubuCareGame.prototype.updateWeatherDisplay = function() {
        if (!this.weatherSystem) return;
        
        const weather = this.weatherSystem.weathers[this.currentWeather];
        const weatherElement = document.getElementById('weather');
        
        if (weatherElement && weather) {
            weatherElement.textContent = weather.emoji;
            weatherElement.title = `${weather.name}: ${weather.effect}`;
        }
    };

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π
    LabubuCareGame.prototype.checkAllTasksStatus = function() {
        if (!this.dailyTasksSystem || !this.dailyTasksSystem.tasks) {
            console.log('‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
            return;
        }
        
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π...');
        
        this.dailyTasksSystem.tasks.forEach(task => {
            if (!this.completedTasks.includes(task.id)) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –Ω–∏—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å 0
                if (task.type === 'stat' && task.id === 'reach_happiness' && task.progress === 0) {
                    const levelMultiplier = Math.max(1, Math.floor(this.level / 10) + 1);
                    const minRequired = Math.min(100, 80 + levelMultiplier * 5);
                    
                    if (this.stats.happiness >= minRequired) {
                        console.log(`‚úÖ –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ —Å—á–∞—Å—Ç—å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${this.stats.happiness} >= ${minRequired}`);
                        task.progress = 1;
                        if (!this.taskProgress) this.taskProgress = {};
                        this.taskProgress[task.id] = 1;
                        this.saveValue('task_progress', this.taskProgress);
                        this.completeTask(task);
                    }
                }
                
                if (task.type === 'all_stats' && task.progress === 0) {
                    const levelMultiplier = Math.max(1, Math.floor(this.level / 10) + 1);
                    const minRequired = 70 + levelMultiplier * 3;
                    const allStatsHigh = Object.values(this.stats).every(stat => stat >= minRequired);
                    
                    if (allStatsHigh) {
                        console.log(`‚úÖ –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –≤—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: –≤—Å–µ >= ${minRequired}`);
                        task.progress = 1;
                        if (!this.taskProgress) this.taskProgress = {};
                        this.taskProgress[task.id] = 1;
                        this.saveValue('task_progress', this.taskProgress);
                        this.completeTask(task);
                    }
                }
            }
        });
    };

    // ===== –°–ò–°–¢–ï–ú–ê –í–ò–†–£–°–ù–û–°–¢–ò –ò –ú–û–¢–ò–í–ê–¶–ò–ò =====

    // –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏
    LabubuCareGame.prototype.initializeViralSystem = function() {
        this.streakDays = this.loadData('streak_days', 0, 'number');
        this.longestStreak = this.loadData('longest_streak', 0, 'number');
        this.lastLoginDate = this.loadData('last_login_date', '', 'string');
        this.totalLogins = this.loadData('total_logins', 0, 'number');
        this.motivationalMessages = this.loadData('motivational_messages', [], 'array');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Ä–∏—é –¥–Ω–µ–π
        this.checkDailyStreak();
        
        return {
            dailyBonuses: {
                1: { money: 100, message: '–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å!' },
                3: { money: 300, chests: 1, message: '–¢—Ä–µ—Ç–∏–π –¥–µ–Ω—å –ø–æ–¥—Ä—è–¥!' },
                7: { money: 1000, chests: 3, message: '–ù–µ–¥–µ–ª—è –ø–æ–¥—Ä—è–¥!' },
                14: { money: 2500, chests: 7, message: '–î–≤–µ –Ω–µ–¥–µ–ª–∏!' },
                30: { money: 10000, chests: 20, message: '–ú–µ—Å—è—Ü –ø–æ–¥—Ä—è–¥!' },
                50: { money: 25000, chests: 50, message: '–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è —Å–µ—Ä–∏—è!' },
                100: { money: 100000, chests: 100, message: '–õ–ï–ì–ï–ù–î–ê–†–ù–ê–Ø –°–ï–†–ò–Ø!' }
            },
            
            motivationalQuotes: [
                "–í–∞—à –ø–∏—Ç–æ–º–µ—Ü —Å–∫—É—á–∞–µ—Ç –ø–æ –≤–∞–º! üê∞üíï",
                "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Å –ø–∏—Ç–æ–º—Ü–µ–º - —ç—Ç–æ –Ω–æ–≤–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ! ‚ú®",
                "–í–∞—à –õ–∞–±—É–±—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–∏–ª—å–Ω–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –≤–∞—à–µ–π –∑–∞–±–æ—Ç–µ! üí™",
                "–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è - –æ–Ω–∏ –¥–∞—é—Ç –æ—Ç–ª–∏—á–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã! üéÅ",
                "–ß–µ–º –≤—ã—à–µ –≤–∞—à —É—Ä–æ–≤–µ–Ω—å, —Ç–µ–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏–≥—Ä–∞! üìà",
                "–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π - –≤–º–µ—Å—Ç–µ –∏–≥—Ä–∞—Ç—å –≤–µ—Å–µ–ª–µ–µ! üë•",
                "–ö–∞–∂–¥—ã–π —Å—É–Ω–¥—É–∫ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–µ–¥–∫–∏–π —Å–∫–∏–Ω! üì¶‚ú®",
                "–ú–∏–Ω–∏-–∏–≥—Ä—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç –≤–∞—à–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –∏ –¥–∞—é—Ç –æ–ø—ã—Ç! üéÆ",
                "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ—Å—Ç–∏—á—å –≤—Å–µ—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π! üèÜ"
            ]
        };
    };

    LabubuCareGame.prototype.checkDailyStreak = function() {
        const today = new Date().toDateString();
        const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toDateString();
        
        if (this.lastLoginDate !== today) {
            this.totalLogins++;
            
            if (this.lastLoginDate === yesterday) {
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–µ—Ä–∏—é
                this.streakDays++;
            } else if (this.lastLoginDate !== today) {
                // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Ä–∏—é
                this.streakDays = 1;
            }
            
            if (this.streakDays > this.longestStreak) {
                this.longestStreak = this.streakDays;
            }
            
            this.lastLoginDate = today;
            this.saveValue('streak_days', this.streakDays);
            this.saveValue('longest_streak', this.longestStreak);
            this.saveValue('last_login_date', this.lastLoginDate);
            this.saveValue('total_logins', this.totalLogins);
            
            // –í—ã–¥–∞–µ–º –±–æ–Ω—É—Å –∑–∞ —Å–µ—Ä–∏—é
            this.giveDailyStreakBonus();
        }
    };

    LabubuCareGame.prototype.giveDailyStreakBonus = function() {
        if (!this.viralSystem) return;
        
        const bonus = this.viralSystem.dailyBonuses[this.streakDays];
        if (bonus) {
            if (bonus.money) {
                this.money += bonus.money;
            }
            if (bonus.chests) {
                this.chestCount += bonus.chests;
            }
            
            this.showMessage(`üî• ${bonus.message} –°–µ—Ä–∏—è: ${this.streakDays} –¥–Ω–µ–π! +${bonus.money || 0}üí∞ ${bonus.chests ? `+${bonus.chests}üì¶` : ''}`);
            this.playHappySound();
        } else if (this.streakDays > 1) {
            // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ —Å–µ—Ä–∏—é
            const dailyBonus = Math.min(1000, this.streakDays * 50);
            this.money += dailyBonus;
            this.showMessage(`üî• –°–µ—Ä–∏—è ${this.streakDays} –¥–Ω–µ–π! +${dailyBonus}üí∞`);
        }
    };

    // –°–∏—Å—Ç–µ–º–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –¥–ª—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏
    LabubuCareGame.prototype.initializeRandomMotivation = function() {
        this.lastMotivationTime = this.loadData('last_motivation_time', 0, 'number');
        
        // –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        setInterval(() => {
            const now = Date.now();
            if (now - this.lastMotivationTime > 30 * 60 * 1000) {
                this.showRandomMotivation();
                this.lastMotivationTime = now;
                this.saveValue('last_motivation_time', this.lastMotivationTime);
            }
        }, 5 * 60 * 1000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
    };

    LabubuCareGame.prototype.showRandomMotivation = function() {
        if (!this.viralSystem) return;
        
        const quotes = this.viralSystem.motivationalQuotes;
        const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
        
        // –ò–Ω–æ–≥–¥–∞ –¥–∞–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –±–æ–Ω—É—Å —Å –º–æ—Ç–∏–≤–∞—Ü–∏–µ–π
        if (Math.random() < 0.3) {
            const bonus = Math.floor(Math.random() * 100) + 50;
            this.money += bonus;
            this.showMessage(`üíù ${randomQuote} –ë–æ–Ω—É—Å: +${bonus}üí∞`);
        } else {
            this.showMessage(`üí≠ ${randomQuote}`);
        }
    };

    // –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –∏ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π
    LabubuCareGame.prototype.initializeProgressionRewards = function() {
        this.progressMilestones = {
            money: [1000, 5000, 10000, 25000, 50000, 100000],
            level: [5, 10, 15, 20, 25, 30, 50, 75, 100],
            experience: [500, 1000, 2500, 5000, 10000],
            chests: [10, 25, 50, 100, 200],
            age: [10, 30, 60, 100, 200, 365]
        };
        
        this.unlockedMilestones = this.loadData('unlocked_milestones', [], 'array');
    };

    LabubuCareGame.prototype.checkProgressMilestones = function() {
        if (!this.progressMilestones) return;
        
        const checks = [
            { type: 'money', value: this.money },
            { type: 'level', value: this.level },
            { type: 'experience', value: this.experience },
            { type: 'chests', value: this.chestCount },
            { type: 'age', value: this.age }
        ];
        
        checks.forEach(check => {
            this.progressMilestones[check.type].forEach(milestone => {
                const milestoneId = `${check.type}_${milestone}`;
                
                if (check.value >= milestone && !this.unlockedMilestones.includes(milestoneId)) {
                    this.unlockedMilestones.push(milestoneId);
                    this.saveValue('unlocked_milestones', this.unlockedMilestones);
                    
                    // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –≤–µ—Ö–∏
                    const reward = this.calculateMilestoneReward(check.type, milestone);
                    this.money += reward.money;
                    this.chestCount += reward.chests;
                    
                    this.showMessage(`üéØ –í–µ—Ö–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞! ${check.type}: ${milestone}! +${reward.money}üí∞ +${reward.chests}üì¶`);
                    this.playHappySound();
                }
            });
        });
    };

    LabubuCareGame.prototype.calculateMilestoneReward = function(type, milestone) {
        const baseRewards = {
            money: { money: Math.floor(milestone * 0.1), chests: Math.floor(milestone / 5000) },
            level: { money: milestone * 100, chests: Math.floor(milestone / 5) },
            experience: { money: Math.floor(milestone * 0.2), chests: Math.floor(milestone / 1000) },
            chests: { money: milestone * 50, chests: Math.floor(milestone / 10) },
            age: { money: milestone * 25, chests: Math.floor(milestone / 20) }
        };
        
        return baseRewards[type] || { money: 100, chests: 1 };
    };

    // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    LabubuCareGame.prototype.enhanceNotificationSystem = function() {
        // –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        this.personalizedNotifications = [
            { condition: () => this.level >= 10, message: `${this.petName} –≥–æ—Ä–¥–∏—Ç—Å—è –≤–∞—à–∏–º–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏! –£—Ä–æ–≤–µ–Ω—å ${this.level}! üåü` },
            { condition: () => this.money >= 10000, message: `–í—ã –±–æ–≥–∞—Ç—ã! ${this.money} –º–æ–Ω–µ—Ç - –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üí∞` },
            { condition: () => this.chestCount >= 50, message: `${this.chestCount} —Å—É–Ω–¥—É–∫–æ–≤! –í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä! üì¶` },
            { condition: () => this.unlockedSkins.length >= 3, message: `${this.unlockedSkins.length} —Å–∫–∏–Ω–æ–≤! –í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è —Ä–∞—Å—Ç–µ—Ç! üé®` },
            { condition: () => this.age >= 100, message: `${this.petName} –º—É–¥—Ä–µ—Ü! ${this.age} –¥–Ω–µ–π –≤–º–µ—Å—Ç–µ! üéÇ` }
        ];
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ
        if (Math.random() < 0.1) { // 10% —à–∞–Ω—Å
            const availableNotifications = this.personalizedNotifications.filter(n => n.condition());
            if (availableNotifications.length > 0) {
                const notification = availableNotifications[Math.floor(Math.random() * availableNotifications.length)];
                this.showMessage(notification.message);
            }
        }
    };

    // –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ñ–æ–Ω–æ–≤ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    LabubuCareGame.prototype.showWelcomeModal = function() {
        console.log('üëã –ü–æ–∫–∞–∑ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞...');
        
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.id = 'welcomeModal';
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Ñ–æ–Ω—É –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                this.finishWelcome();
            }
        });
        
        modal.innerHTML = `
            <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-96 overflow-y-auto" onclick="event.stopPropagation()">
                <div class="text-center">
                    <div class="text-6xl mb-4">üê∞</div>
                    <h3 class="text-xl font-bold mb-4 text-purple-800">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Labubu Care!</h3>
                    
                    <!-- –û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã -->
                    <div class="text-left mb-4 bg-purple-50 p-3 rounded-lg">
                        <h4 class="font-bold text-purple-800 mb-2 text-center">üéÆ –ß—Ç–æ –≤–∞—Å –∂–¥–µ—Ç –≤ –∏–≥—Ä–µ:</h4>
                        <div class="text-xs text-purple-700 space-y-1">
                            <div class="flex items-center space-x-2">
                                <span>üîß</span>
                                <span><strong>–£—Ö–æ–¥:</strong> –ö–æ—Ä–º–∏—Ç–µ, –º–æ–π—Ç–µ –∏ –ª–µ—á–∏—Ç–µ –ø–∏—Ç–æ–º—Ü–∞</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üéÆ</span>
                                <span><strong>20 –º–∏–Ω–∏-–∏–≥—Ä:</strong> –†–∞–∑–≤–∏–≤–∞–π—Ç–µ –ø–∏—Ç–æ–º—Ü–∞ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –æ–ø—ã—Ç</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üõçÔ∏è</span>
                                <span><strong>–ú–∞–≥–∞–∑–∏–Ω:</strong> 22 –≤–∏–¥–∞ –æ–¥–µ–∂–¥—ã –∏ 12 —Ñ–æ–Ω–æ–≤ –∏–≥—Ä—ã</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üì¶</span>
                                <span><strong>–°—É–Ω–¥—É–∫–∏:</strong> –ü–æ–ª—É—á–∞–π—Ç–µ —Ä–µ–¥–∫–∏–µ —Å–∫–∏–Ω—ã –∏ –Ω–∞–≥—Ä–∞–¥—ã</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üìã</span>
                                <span><strong>–ó–∞–¥–∞–Ω–∏—è:</strong> –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üëë</span>
                                <span><strong>–°—Ç–∞—Ç—É—Å—ã:</strong> –û—Ç –Ω–æ–≤–∏—á–∫–∞ –¥–æ –±–æ–∂–µ—Å—Ç–≤–∞ –ø–∏—Ç–æ–º—Ü–µ–≤</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üèÜ</span>
                                <span><strong>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:</strong> –°–æ–±–∏—Ä–∞–π—Ç–µ –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span>üê∞</span>
                                <span><strong>–≠–≤–æ–ª—é—Ü–∏—è:</strong> 5 —Å—Ç–∞–¥–∏–π —Ä–æ—Å—Ç–∞ –ø–∏—Ç–æ–º—Ü–∞</span>
                            </div>
                        </div>
                    </div>
                    
                    <p class="mb-4 text-gray-600 text-sm">–î–∞–π—Ç–µ –∏–º—è —Å–≤–æ–µ–º—É –ø–∏—Ç–æ–º—Ü—É –∏ –Ω–∞—á–Ω–∏—Ç–µ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ:</p>
                    <input type="text" id="petNameInput" value="${this.petName}" maxlength="15" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–∏—Ç–æ–º—Ü–∞"
                        class="w-full px-3 py-2 border rounded-lg mb-4 text-center"
                        onkeypress="if(event.key === 'Enter') { if(typeof game !== 'undefined' && game.finishWelcome) { game.finishWelcome(); } }">
                    <button onclick="if(typeof game !== 'undefined' && game.finishWelcome) { game.finishWelcome(); } else { console.error('–§—É–Ω–∫—Ü–∏—è finishWelcome –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'); }" 
                            class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg font-bold transition-colors">
                        –ù–∞—á–∞—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ! üéÆ
                    </button>
                    
                    <p class="text-xs text-gray-500 mt-3">üí° –°–æ–≤–µ—Ç: –ó–∞–±–æ—Ç—å—Ç–µ—Å—å –æ –ø–∏—Ç–æ–º—Ü–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!</p>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        setTimeout(() => {
            const nameInput = document.getElementById('petNameInput');
            if (nameInput) {
                nameInput.focus();
                nameInput.select();
            }
        }, 100);
        
        console.log('‚úÖ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ');
    };

    LabubuCareGame.prototype.finishWelcome = function() {
        console.log('üéÆ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è...');
        
        const nameInput = document.getElementById('petNameInput');
        if (nameInput && nameInput.value.trim()) {
            this.petName = nameInput.value.trim();
            this.saveValue('shared_pet_name', this.petName);
            console.log(`‚úÖ –ò–º—è –ø–∏—Ç–æ–º—Ü–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: ${this.petName}`);
        }
        
        this.isFirstTime = false;
        this.saveValue('first_time_setup', false);
        
        // –ù–∞–π—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = document.querySelector('.fixed.inset-0');
        if (modal) {
            modal.remove();
            console.log('‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —É–¥–∞–ª–µ–Ω–æ');
        } else {
            console.log('‚ö†Ô∏è –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        }
        
        this.updateDisplay();
        this.showMessage(`–ü—Ä–∏–≤–µ—Ç, ${this.petName}! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É! üéâ`);
        console.log('üéâ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
    };

    LabubuCareGame.prototype.applyBackground = function() {
        const body = document.body;
        
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è backgrounds –∏ currentBackground
        if (!this.backgrounds || !this.currentBackground) {
            console.log('‚ö†Ô∏è –§–æ–Ω—ã –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω');
            body.className = 'bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen';
            return;
        }
        
        const bg = this.backgrounds[this.currentBackground];
        if (bg && bg.gradient) {
            body.className = `bg-gradient-to-br ${bg.gradient} min-h-screen`;
            console.log(`üé® –ü—Ä–∏–º–µ–Ω–µ–Ω —Ñ–æ–Ω: ${bg.name}`);
        } else {
            // Fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω
            console.log('‚ö†Ô∏è –§–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π');
            body.className = 'bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen';
        }
    };

    LabubuCareGame.prototype.buyBackground = function(backgroundKey) {
        const bg = this.backgrounds[backgroundKey];
        
        if (this.currentBackground === backgroundKey) {
            this.showMessage('–≠—Ç–æ—Ç —Ñ–æ–Ω —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω!');
            return;
        }
        
        if (this.unlockedBackgrounds.includes(backgroundKey)) {
            this.currentBackground = backgroundKey;
            this.saveValue('current_background', this.currentBackground);
            this.applyBackground();
            this.showMessage(`–§–æ–Ω "${bg.name}" –ø—Ä–∏–º–µ–Ω–µ–Ω! ${bg.emoji}`);
            this.switchTab('shop');
            return;
        }
        
        if (this.money >= bg.price) {
            this.money -= bg.price;
            this.unlockedBackgrounds.push(backgroundKey);
            this.currentBackground = backgroundKey;
            
            this.saveValue('shared_labubu_money', this.money);
            this.saveValue('unlocked_backgrounds', this.unlockedBackgrounds);
            this.saveValue('current_background', this.currentBackground);
            this.saveValue('status_points', this.statusPoints);
            
            this.applyBackground();
            this.playHappySound();
            this.showMessage(`–ù–æ–≤—ã–π —Ñ–æ–Ω: ${bg.name}! ${bg.emoji}`);
            this.updateDisplay();
            this.switchTab('shop');
        } else {
            this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
        }
    };

    LabubuCareGame.prototype.getStatusTabContent = function() {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏–≥—Ä–æ–∫–∞
        const currentStatus = this.getCurrentPlayerStatus();
        
        return `
            <div class="space-y-3">
                <!-- –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–≥—Ä–æ–∫–∞ -->
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-3 text-purple-800 text-sm">üëë –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–≥—Ä–æ–∫–∞</h3>
                    
                    <div class="space-y-3 text-xs">
                        <!-- –ù–æ–≤–∏—á–æ–∫ -->
                        <div class="p-3 rounded-lg border-2 border-gray-300 bg-gray-50 ${currentStatus === '–Ω–æ–≤–∏—á–æ–∫' ? 'ring-2 ring-gray-400' : ''}">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üå±</span>
                                <span class="font-bold text-gray-800">–ù–æ–≤–∏—á–æ–∫</span>
                                ${currentStatus === '–Ω–æ–≤–∏—á–æ–∫' ? '<span class="ml-auto text-green-600 font-bold">‚úì –¢–ï–ö–£–©–ò–ô</span>' : ''}
                            </div>
                            <p class="text-gray-700">üì¶ –ü—Ä–æ—Å—Ç–∞—è —Å–µ—Ä–∞—è —Ä–∞–º–∫–∞</p>
                            <p class="text-gray-600">–ù–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</p>
                        </div>
                        
                        <!-- –û–ø—ã—Ç–Ω—ã–π -->
                        <div class="p-3 rounded-lg border-2 border-blue-400 bg-blue-50 shadow-lg shadow-blue-200 ${currentStatus === '–æ–ø—ã—Ç–Ω—ã–π' ? 'ring-2 ring-blue-400' : ''}">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">‚≠ê</span>
                                <span class="font-bold text-blue-800">–û–ø—ã—Ç–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü</span>
                                ${currentStatus === '–æ–ø—ã—Ç–Ω—ã–π' ? '<span class="ml-auto text-green-600 font-bold">‚úì –¢–ï–ö–£–©–ò–ô</span>' : ''}
                            </div>
                            <p class="text-blue-700">üì¶ –°–∏–Ω—è—è —Ä–∞–º–∫–∞ —Å —Ç–µ–Ω—å—é</p>
                            <p class="text-blue-600">–ë–æ–Ω—É—Å: +10üí∞ –∫ –Ω–∞–≥—Ä–∞–¥–∞–º</p>
                        </div>
                        
                        <!-- –≠–∫—Å–ø–µ—Ä—Ç -->
                        <div class="p-3 rounded-lg border-2 border-purple-400 bg-purple-50 shadow-lg shadow-purple-200 animate-pulse ${currentStatus === '—ç–∫—Å–ø–µ—Ä—Ç' ? 'ring-2 ring-purple-400' : ''}">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üíé</span>
                                <span class="font-bold text-purple-800">–≠–∫—Å–ø–µ—Ä—Ç –ø–æ —É—Ö–æ–¥—É</span>
                                ${currentStatus === '—ç–∫—Å–ø–µ—Ä—Ç' ? '<span class="ml-auto text-green-600 font-bold">‚úì –¢–ï–ö–£–©–ò–ô</span>' : ''}
                            </div>
                            <p class="text-purple-700">üì¶ –§–∏–æ–ª–µ—Ç–æ–≤–∞—è —Ä–∞–º–∫–∞ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º –∏ –ø—É–ª—å—Å–∞—Ü–∏–µ–π</p>
                            <p class="text-purple-600">–ë–æ–Ω—É—Å: +25üí∞ –∫ –Ω–∞–≥—Ä–∞–¥–∞–º</p>
                        </div>
                        
                        <!-- –ú–∞—Å—Ç–µ—Ä -->
                        <div class="p-3 rounded-lg border-2 border-yellow-400 bg-yellow-50 shadow-lg shadow-yellow-200 animate-pulse ring-2 ring-yellow-300 ring-opacity-50 ${currentStatus === '–º–∞—Å—Ç–µ—Ä' ? 'ring-4 ring-yellow-400' : ''}">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üëë</span>
                                <span class="font-bold text-yellow-800">–ú–∞—Å—Ç–µ—Ä –≤–æ—Å–ø–∏—Ç–∞–Ω–∏—è</span>
                                ${currentStatus === '–º–∞—Å—Ç–µ—Ä' ? '<span class="ml-auto text-green-600 font-bold">‚úì –¢–ï–ö–£–©–ò–ô</span>' : ''}
                            </div>
                            <p class="text-yellow-700">üì¶ –ó–æ–ª–æ—Ç–∞—è —Ä–∞–º–∫–∞ —Å –∫–æ–ª—å—Ü–∞–º–∏ –∏ —è—Ä–∫–æ—Å—Ç—å—é</p>
                            <p class="text-yellow-600">–ë–æ–Ω—É—Å: +50üí∞ –∫ –Ω–∞–≥—Ä–∞–¥–∞–º</p>
                        </div>
                        
                        <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
                        <div class="p-3 rounded-lg border-4 bg-gradient-to-br from-purple-100 via-pink-100 to-red-100 shadow-2xl shadow-purple-300 animate-pulse ring-4 ring-purple-300 ring-opacity-75 ring-offset-2 ${currentStatus === '–ª–µ–≥–µ–Ω–¥–∞' ? 'ring-6 ring-purple-500' : ''}" style="border-image: linear-gradient(45deg, #8b5cf6, #ec4899, #ef4444) 1;">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üåü</span>
                                <span class="font-bold bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 bg-clip-text text-transparent">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫</span>
                                ${currentStatus === '–ª–µ–≥–µ–Ω–¥–∞' ? '<span class="ml-auto text-green-600 font-bold">‚úì –¢–ï–ö–£–©–ò–ô</span>' : ''}
                            </div>
                            <p class="text-purple-700">‚ú® –†–∞–¥—É–∂–Ω–∞—è —Ä–∞–º–∫–∞ —Å –∏—Å–∫—Ä–∞–º–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏</p>
                            <p class="text-purple-600">–ë–æ–Ω—É—Å: +100üí∞ –∫ –Ω–∞–≥—Ä–∞–¥–∞–º</p>
                        </div>
                        
                        <!-- –ë–æ–≥ -->
                        <div class="p-3 rounded-lg border-4 bg-gradient-to-br from-yellow-100 via-orange-100 to-red-100 shadow-2xl shadow-orange-300 animate-pulse ring-4 ring-yellow-400 ring-opacity-100 ring-offset-4 ring-offset-yellow-100 ${currentStatus === '–±–æ–≥' ? 'ring-8 ring-yellow-600' : ''}" style="border-image: linear-gradient(45deg, #facc15, #fb923c, #ef4444) 1; filter: brightness(150%) saturate(200%) drop-shadow(0 0 20px #facc15);">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2 animate-spin">‚ö°</span>
                                <span class="font-bold bg-gradient-to-r from-yellow-600 via-orange-600 to-red-600 bg-clip-text text-transparent">–ë–æ–∂–µ—Å—Ç–≤–æ –ø–∏—Ç–æ–º—Ü–µ–≤</span>
                                ${currentStatus === '–±–æ–≥' ? '<span class="ml-auto text-green-600 font-bold">‚úì –¢–ï–ö–£–©–ò–ô</span>' : ''}
                            </div>
                            <p class="text-orange-700">‚ö° –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–∞–º–∫–∞ —Å –º–æ—â–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏, –∏—Å–∫—Ä–∞–º–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —Å–≤–µ—á–µ–Ω–∏–µ–º</p>
                            <p class="text-orange-600">–ë–æ–Ω—É—Å: +200üí∞ –∫ –Ω–∞–≥—Ä–∞–¥–∞–º</p>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-blue-50 rounded">
                        <h4 class="font-bold text-blue-800 mb-2">üìà –ö–∞–∫ –ø–æ–≤—ã—à–∞—Ç—å —Å—Ç–∞—Ç—É—Å:</h4>
                        <ul class="list-disc list-inside text-blue-700 space-y-1 text-xs">
                            <li>–ù–∞–±–∏—Ä–∞–π—Ç–µ –æ—á–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è —Å –ø–∏—Ç–æ–º—Ü–µ–º</li>
                            <li>–ü–æ–≤—ã—à–∞–π—Ç–µ —É—Ä–æ–≤–µ–Ω—å –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ–ø—ã—Ç</li>
                            <li>–°–æ–±–∏—Ä–∞–π—Ç–µ –º–æ–Ω–µ—Ç—ã –∏ –ø–æ–∫—É–ø–∞–π—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è</li>
                            <li>–í—ã—à–µ —Å—Ç–∞—Ç—É—Å = –±–æ–ª—å—à–µ –±–æ–Ω—É—Å–æ–≤ –∏ –º–µ–Ω—å—à–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫!</li>
                        </ul>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∏—Ç–æ–º—Ü–∞ -->
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-3 text-purple-800 text-sm">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∏—Ç–æ–º—Ü–∞ –∏ –∫–∞–∫ –∏—Ö –ø–æ–¥–Ω—è—Ç—å</h3>
                    
                    <div class="space-y-3 text-xs">
                        <div class="p-3 bg-orange-50 rounded">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üçΩÔ∏è</span>
                                <span class="font-bold text-orange-800">–ì–æ–ª–æ–¥</span>
                                <span class="ml-auto text-orange-600">${this.stats.hunger}%</span>
                            </div>
                            <p class="text-orange-700">üí° –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å: –ö–æ—Ä–º–∏—Ç–µ –ø–∏—Ç–æ–º—Ü–∞ —Ä–∞–∑–Ω–æ–π –µ–¥–æ–π –≤ —Ä–∞–∑–¥–µ–ª–µ "–£—Ö–æ–¥"</p>
                        </div>
                        
                        <div class="p-3 bg-yellow-50 rounded">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üòä</span>
                                <span class="font-bold text-yellow-800">–°—á–∞—Å—Ç—å–µ</span>
                                <span class="ml-auto text-yellow-600">${this.stats.happiness}%</span>
                            </div>
                            <p class="text-yellow-700">üí° –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å: –ò–≥—Ä–∞–π—Ç–µ –≤ –º–∏–Ω–∏-–∏–≥—Ä—ã, –∫–æ—Ä–º–∏—Ç–µ –≤–∫—É—Å–Ω–æ–π –µ–¥–æ–π, –ø–æ–∫—É–ø–∞–π—Ç–µ –æ–¥–µ–∂–¥—É</p>
                        </div>
                        
                        <div class="p-3 bg-blue-50 rounded">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üõÅ</span>
                                <span class="font-bold text-blue-800">–ß–∏—Å—Ç–æ—Ç–∞</span>
                                <span class="ml-auto text-blue-600">${this.stats.cleanliness}%</span>
                            </div>
                            <p class="text-blue-700">üí° –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å: –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ú—ã—Ç—å" –≤ —Ä–∞–∑–¥–µ–ª–µ "–£—Ö–æ–¥"</p>
                        </div>
                        
                        <div class="p-3 bg-red-50 rounded">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">‚ù§Ô∏è</span>
                                <span class="font-bold text-red-800">–ó–¥–æ—Ä–æ–≤—å–µ</span>
                                <span class="ml-auto text-red-600">${this.stats.health}%</span>
                            </div>
                            <p class="text-red-700">üí° –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å: –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–õ–µ—á–∏—Ç—å" (30üí∞) –∏–ª–∏ –µ—à—å—Ç–µ –∑–¥–æ—Ä–æ–≤—É—é –ø–∏—â—É</p>
                        </div>
                        
                        <div class="p-3 bg-green-50 rounded">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">‚ö°</span>
                                <span class="font-bold text-green-800">–≠–Ω–µ—Ä–≥–∏—è</span>
                                <span class="ml-auto text-green-600">${this.stats.energy}%</span>
                            </div>
                            <p class="text-green-700">üí° –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å: –î–∞–≤–∞–π—Ç–µ –ø–∏—Ç–æ–º—Ü—É –æ—Ç–¥–æ—Ö–Ω—É—Ç—å, –∫–æ—Ä–º–∏—Ç–µ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–π –µ–¥–æ–π</p>
                        </div>
                        
                        <div class="p-3 bg-purple-50 rounded">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üò¥</span>
                                <span class="font-bold text-purple-800">–°–æ–Ω</span>
                                <span class="ml-auto text-purple-600">${this.stats.sleep}%</span>
                            </div>
                            <p class="text-purple-700">üí° –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –ø–∏—Ç–æ–º—Ü–∞ –≤ —Ä–µ–∂–∏–º —Å–Ω–∞ –∫–Ω–æ–ø–∫–æ–π "–°–ø–∞—Ç—å"</p>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-gray-50 rounded">
                        <h4 class="font-bold text-gray-800 mb-2">üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã:</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 text-xs">
                            <li>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—Å–µ–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ</li>
                            <li>–†–∞–∑–Ω–∞—è –µ–¥–∞ –¥–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –±–æ–Ω—É—Å—ã</li>
                            <li>–ú–∏–Ω–∏-–∏–≥—Ä—ã —Ç—Ä–∞—Ç—è—Ç —ç–Ω–µ—Ä–≥–∏—é, –Ω–æ –¥–∞—é—Ç –æ–ø—ã—Ç</li>
                            <li>–í–æ –≤—Ä–µ–º—è —Å–Ω–∞ —ç–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ</li>
                            <li>–í—ã—Å–æ–∫–∏–π —Å—Ç–∞—Ç—É—Å –¥–∞–µ—Ç –±–æ–ª—å—à–µ –º–æ–Ω–µ—Ç –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è!</li>
                        </ul>
                    </div>
                </div>
            </div>
        `;
    };

    // –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ —Ñ–æ–Ω–æ–≤
    LabubuCareGame.prototype.showWelcomeModal = function() {
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.innerHTML = `
            <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4">
                <div class="text-center">
                    <div class="text-6xl mb-4">üê∞</div>
                    <h3 class="text-xl font-bold mb-4 text-purple-800">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h3>
                    <p class="mb-4 text-gray-600">–≠—Ç–æ –≤–∞—à –Ω–æ–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü –õ–∞–±—É–±—É! –î–∞–π—Ç–µ –µ–º—É –∏–º—è:</p>
                    <input type="text" id="petNameInput" value="${this.petName}" maxlength="15" 
                        class="w-full px-3 py-2 border rounded-lg mb-4 text-center">
                    <button onclick="game.finishWelcome()" 
                            class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg font-bold">
                        –ù–∞—á–∞—Ç—å –∏–≥—Ä—É! üéÆ
                    </button>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    };

    LabubuCareGame.prototype.finishWelcome = function() {
        const nameInput = document.getElementById('petNameInput');
        if (nameInput && nameInput.value.trim()) {
            this.petName = nameInput.value.trim();
            this.saveValue('shared_pet_name', this.petName);
        }
        
        this.isFirstTime = false;
        this.saveValue('first_time_setup', false);
        
        const modal = document.querySelector('.fixed.inset-0');
        if (modal) modal.remove();
        
        this.updateDisplay();
        this.showMessage(`–ü—Ä–∏–≤–µ—Ç, ${this.petName}! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É! üéâ`);
    };

    LabubuCareGame.prototype.applyBackground = function() {
        const body = document.body;
        
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è backgrounds –∏ currentBackground
        if (!this.backgrounds || !this.currentBackground) {
            console.log('‚ö†Ô∏è –§–æ–Ω—ã –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω');
            body.className = 'bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen';
            return;
        }
        
        const bg = this.backgrounds[this.currentBackground];
        if (bg && bg.gradient) {
            body.className = `bg-gradient-to-br ${bg.gradient} min-h-screen`;
            console.log(`üé® –ü—Ä–∏–º–µ–Ω–µ–Ω —Ñ–æ–Ω: ${bg.name}`);
        } else {
            // Fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ–Ω
            console.log('‚ö†Ô∏è –§–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π');
            body.className = 'bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen';
        }
    };

    LabubuCareGame.prototype.buyBackground = function(backgroundKey) {
        const bg = this.backgrounds[backgroundKey];
        
        if (this.currentBackground === backgroundKey) {
            this.showMessage('–≠—Ç–æ—Ç —Ñ–æ–Ω —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω!');
            return;
        }
        
        if (this.unlockedBackgrounds.includes(backgroundKey)) {
            this.currentBackground = backgroundKey;
            this.saveValue('current_background', this.currentBackground);
            this.applyBackground();
            this.showMessage(`–§–æ–Ω "${bg.name}" –ø—Ä–∏–º–µ–Ω–µ–Ω! ${bg.emoji}`);
            this.switchTab('shop');
            return;
        }
        
        if (this.money >= bg.price) {
            this.money -= bg.price;
            this.unlockedBackgrounds.push(backgroundKey);
            this.currentBackground = backgroundKey;
            
            this.saveValue('shared_labubu_money', this.money);
            this.saveValue('unlocked_backgrounds', this.unlockedBackgrounds);
            this.saveValue('current_background', this.currentBackground);
            
            this.applyBackground();
            this.playHappySound();
            this.showMessage(`–ù–æ–≤—ã–π —Ñ–æ–Ω: ${bg.name}! ${bg.emoji}`);
            this.updateDisplay();
            this.switchTab('shop');
        } else {
            this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
        }
    };

    // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
    let game;
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üöÄ DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...');
        game = new LabubuCareGame();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã
        if (game) {
            game.statusSystem = game.initializeStatusSystem();
            game.friendsSystem = game.initializeFriendsSystem();
            game.achievementsSystem = game.initializeAchievements();
            game.eventsSystem = game.initializeEvents();
            game.dailyTasksSystem = game.initializeDailyTasks();
            game.weatherSystem = game.initializeWeatherSystem();
            game.viralSystem = game.initializeViralSystem();
            game.initializeProgressionRewards();
            game.initializeRandomMotivation();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–¥–∞–Ω–∏—è –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
            if (!game.dailyTasksSystem || !game.dailyTasksSystem.tasks) {
                console.log('üîÑ –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∑–∞–¥–∞–Ω–∏–π...');
                game.dailyTasksSystem = game.initializeDailyTasks();
            }
            
            console.log('‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã!');
            console.log('üìã –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é!');
            console.log('üå§Ô∏è –°–∏—Å—Ç–µ–º–∞ –ø–æ–≥–æ–¥—ã –∑–∞–ø—É—â–µ–Ω–∞!');
            console.log('üî• –°–∏—Å—Ç–µ–º–∞ –≤–∏—Ä—É—Å–Ω–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!');
            console.log('üéØ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –∑–∞–ø—É—â–µ–Ω–∞!');
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
            setTimeout(() => {
                console.log('üîß –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∑–∞–¥–∞–Ω–∏–π...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–¥–∞–Ω–∏—è
                if (!game.dailyTasksSystem || !game.dailyTasksSystem.tasks || game.dailyTasksSystem.tasks.length === 0) {
                    console.log('üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞, –∑–∞–ø—É—Å–∫–∞–µ–º —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É');
                    game.emergencyTaskReset();
                } else {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
                    let hasNaN = false;
                    game.dailyTasksSystem.tasks.forEach(task => {
                        if (isNaN(task.progress) || isNaN(task.target) || task.progress === undefined || task.target === undefined) {
                            hasNaN = true;
                            console.log(`üêõ –ù–∞–π–¥–µ–Ω–æ NaN –≤ –∑–∞–¥–∞–Ω–∏–∏ ${task.id}: progress=${task.progress}, target=${task.target}`);
                        }
                    });
                    
                    if (hasNaN) {
                        console.log('üö® –ù–∞–π–¥–µ–Ω—ã NaN –∑–Ω–∞—á–µ–Ω–∏—è, –∑–∞–ø—É—Å–∫–∞–µ–º —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É');
                        game.emergencyTaskReset();
                    } else {
                        if (game.validateTaskProgress) {
                            game.validateTaskProgress();
                        }
                        if (game.checkAllTasksStatus) {
                            game.checkAllTasksStatus();
                        }
                    }
                }
            }, 2000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–≥–æ–¥—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
            game.updateWeather();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–≥–æ–¥—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
            setInterval(() => {
                if (game.updateWeather) {
                    game.updateWeather();
                }
            }, 5 * 60 * 1000);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (game.checkProgressMilestones) {
                    game.checkProgressMilestones();
                }
                if (game.enhanceNotificationSystem) {
                    game.enhanceNotificationSystem();
                }
            }, 30 * 1000);
        }
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            if (game) {
                console.log('üîÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è...');
                game.updateDisplay();
                if (game.updateStatusDisplayEnhanced) {
                    game.updateStatusDisplayEnhanced();
                } else if (game.updateStatusDisplay) {
                    game.updateStatusDisplay();
                }
            }
        }, 2000);
    });
    </script>

    </body>
    </html>
