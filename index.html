<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labubu TBB Game - –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .notification-enter {
            animation: slideInRight 0.3s ease-out;
        }
        .notification-exit {
            animation: fadeOut 0.3s ease-out;
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        .pet-bounce {
            animation: bounce 2s infinite;
        }
        .pet-sleep {
            animation: pulse 2s infinite;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 min-h-screen">

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div id="notifications" class="fixed top-4 right-4 z-50 space-y-2"></div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã -->
<div class="max-w-lg mx-auto bg-gradient-to-b from-pink-100 to-purple-100 rounded-xl p-4 shadow-lg min-h-screen">
    
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –ø–æ–≥–æ–¥–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º -->
    <div class="text-center mb-4">
        <div class="flex justify-between items-center mb-2">
            <div class="text-sm" id="timeOfDay">‚òÄÔ∏è</div>
            <div class="text-center">
                <h1 class="text-xl font-bold text-purple-800">üê∞ <span id="petNameDisplay">Labubu</span> Care</h1>
                <div id="nameEditSection" class="hidden mt-2">
                    <input type="text" id="nameInput" class="text-sm px-2 py-1 border rounded" maxlength="15">
                    <div class="mt-1">
                        <button id="saveNameBtn" class="text-xs bg-blue-500 text-white px-2 py-1 rounded mr-1">‚úì</button>
                        <button id="cancelNameBtn" class="text-xs bg-gray-500 text-white px-2 py-1 rounded">‚úï</button>
                    </div>
                </div>
                <button id="editNameBtn" class="text-xs text-purple-600 hover:text-purple-800 mt-1">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è</button>
            </div>
            <div class="text-sm" id="weather">‚òÄÔ∏è</div>
        </div>
        <div class="flex justify-between text-xs">
            <span id="levelDisplay">Lv.1</span>
            <span id="moneyDisplay">üí∞100</span>
            <span id="expDisplay">‚≠ê0/100</span>
            <span id="ageDisplay">üéÇ0–¥</span>
            <button id="soundToggle" class="text-xs">üîä</button>
        </div>
        <div id="collaboratorsInfo" class="text-xs text-purple-600 mt-1 hidden"></div>
    </div>

    <!-- –ü–µ—Ä—Å–æ–Ω–∞–∂ Labubu -->
    <div class="text-center mb-4 bg-white rounded-lg p-6 shadow">
        <div class="mb-4 relative inline-block">
            <img id="petImage" src="https://i.pinimg.com/474x/49/b9/bc/49b9bc9d7961d675e91a963b192c16a9.jpg" alt="Labubu" class="w-32 h-32 mx-auto object-contain">
            
            <!-- –û–¥–µ–∂–¥–∞ -->
            <div class="absolute inset-0" id="outfitContainer"></div>
            
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã -->
            <div id="sleepIndicator" class="absolute -top-2 -right-2 text-lg animate-pulse hidden">üí§</div>
            <div id="moodIndicator" class="absolute -top-1 -left-1 text-sm"></div>
            <div id="criticalIndicator" class="absolute inset-0 bg-red-500 bg-opacity-20 rounded-full animate-pulse hidden"></div>
        </div>
        
        <div class="text-2xl mb-2" id="moodEmoji">üòä</div>
        <div class="text-sm text-gray-600 font-medium" id="moodStatus">–°—á–∞—Å—Ç–ª–∏–≤</div>
        <div class="text-xs text-purple-600 mt-1" id="evolutionStage">–ú–∞–ª—ã—à</div>
        <div id="currentOutfit" class="text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full mt-2 inline-block hidden"></div>
        <div class="text-xs text-gray-500 mt-1">üéÇ –í–æ–∑—Ä–∞—Å—Ç: <span id="ageText">0</span> –¥–Ω–µ–π</div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div id="gameMessage" class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-3 py-2 rounded mb-3 text-center text-xs hidden"></div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="mb-4 bg-white rounded-lg p-3 shadow">
        <div id="statsContainer"></div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∏ -->
    <div class="flex mb-3 bg-white rounded-lg p-1 shadow text-xs">
        <button class="tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors bg-purple-500 text-white" data-tab="care">üîß –£—Ö–æ–¥</button>
        <button class="tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50" data-tab="games">üéÆ –ò–≥—Ä—ã</button>
        <button class="tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50" data-tab="shop">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</button>
        <button class="tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50" data-tab="chests">üì¶ –°—É–Ω–¥—É–∫–∏</button>
        <button class="tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50" data-tab="pets">üê∞ –ü–∏—Ç–æ–º—Ü—ã</button>
        <button class="tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50" data-tab="info">‚ÑπÔ∏è –ò–Ω—Ñ–æ</button>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
    <div id="tabContent"></div>
</div>

<!-- –ú–æ–¥–∞–ª –º–∏–Ω–∏-–∏–≥—Ä—ã -->
<div id="miniGameModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4 max-h-96 overflow-y-auto">
        <h3 id="gameTitle" class="text-lg font-bold mb-4"></h3>
        <div id="gameContent"></div>
        <button id="cancelGameBtn" class="mt-4 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded w-full transition-colors">–û—Ç–º–µ–Ω–∞</button>
    </div>
</div>

<script>
class LabubuCareGame {
    constructor() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–æ–π—Å—Ç–≤ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        this.stats = {
            hunger: 100, happiness: 100, cleanliness: 100,
            health: 100, energy: 100, sleep: 100
        };
        this.evolutionStages = {
            baby: { name: '–ú–∞–ª—ã—à', minAge: 0 },
            child: { name: '–†–µ–±–µ–Ω–æ–∫', minAge: 7 },
            teen: { name: '–ü–æ–¥—Ä–æ—Å—Ç–æ–∫', minAge: 30 },
            adult: { name: '–í–∑—Ä–æ—Å–ª—ã–π', minAge: 60 },
            elder: { name: '–ú—É–¥—Ä–µ—Ü', minAge: 100 }
        };
        this.skins = {
            default: { 
                name: '–ë–∞–∑–æ–≤—ã–π –õ–∞–±—É–±—É', 
                rarity: 'common', 
                chance: 50, 
                image: 'https://i.ebayimg.com/images/g/yVoAAOSwiqJnxCvP/s-l1600.jpg',
                color: '#DEB887'
            }
        };
        this.outfits = {
            default: { name: '–û–±—ã—á–Ω–∞—è –æ–¥–µ–∂–¥–∞', price: 0, emoji: 'üëï', description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å' },
            cool: { name: '–ö—Ä—É—Ç—ã–µ –æ—á–∫–∏', price: 250, emoji: 'üòé', description: '–°—Ç–∏–ª—å–Ω—ã–µ —Å–æ–ª–Ω—Ü–µ–∑–∞—â–∏—Ç–Ω—ã–µ –æ—á–∫–∏' },
            cute: { name: '–ú–∏–ª–∞—è —à–∞–ø–æ—á–∫–∞', price: 300, emoji: 'üê∞', description: '–û—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –±–µ–ª–∞—è —à–∞–ø–æ—á–∫–∞' },
            artist: { name: '–•—É–¥–æ–∂–Ω–∏–∫', price: 380, emoji: 'üé®', description: '–ë–µ—Ä–µ—Ç –∏ –ø–∞–ª–∏—Ç—Ä–∞ —Ö—É–¥–æ–∂–Ω–∏–∫–∞' },
            summer: { name: '–õ–µ—Ç–Ω—è—è –ø–∞–Ω–∞–º–∞', price: 500, emoji: 'üëí', description: '–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–æ–ª–Ω—Ü–∞' },
            pirate: { name: '–ü–∏—Ä–∞—Ç—Å–∫–∏–π –∫–æ—Å—Ç—é–º', price: 500, emoji: 'üè¥‚Äç‚ò†Ô∏è', description: '–§–ª–∞–≥ –ø–∏—Ä–∞—Ç–∞' },
            formal: { name: '–î–µ–ª–æ–≤–æ–π –∫–æ—Å—Ç—é–º', price: 1500, emoji: 'ü§µ', description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –∫–æ—Å—Ç—é–º' },
            winter: { name: '–ó–∏–º–Ω—è—è –∫—É—Ä—Ç–∫–∞', price: 2000, emoji: 'üß•', description: '–¢–µ–ø–ª–∞—è –∫—É—Ä—Ç–∫–∞' },
            school: { name: '–®–∫–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞', price: 3000, emoji: 'üéí', description: '–®–∫–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞' },
            knight: { name: '–†—ã—Ü–∞—Ä—å', price: 3000, emoji: '‚öîÔ∏è', description: '–î–æ—Å–ø–µ—Ö–∏ —Ä—ã—Ü–∞—Ä—è' },
            chef: { name: '–ö–æ—Å—Ç—é–º –ø–æ–≤–∞—Ä–∞', price: 4000, emoji: 'üë®‚Äçüç≥', description: '–ë–µ–ª—ã–π –∫–æ–ª–ø–∞–∫ –ø–æ–≤–∞—Ä–∞' },
            superhero: { name: '–°—É–ø–µ—Ä–≥–µ—Ä–æ–π', price: 4500, emoji: 'ü¶∏', description: '–ü–ª–∞—â –≥–µ—Ä–æ—è' },
            doctor: { name: '–î–æ–∫—Ç–æ—Ä', price: 4800, emoji: 'üë®‚Äç‚öïÔ∏è', description: '–ë–µ–ª—ã–π —Ö–∞–ª–∞—Ç' },
            ninja: { name: '–ö–æ—Å—Ç—é–º –Ω–∏–Ω–¥–∑—è', price: 5000, emoji: 'ü•∑', description: '–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å' },
            detective: { name: '–î–µ—Ç–µ–∫—Ç–∏–≤', price: 5000, emoji: 'üïµÔ∏è', description: '–ü–ª–∞—â —Å—ã—â–∏–∫–∞' },
            wizard: { name: '–ö–æ—Å—Ç—é–º –≤–æ–ª—à–µ–±–Ω–∏–∫–∞', price: 5500, emoji: 'üßô', description: '–ú–∞–≥–∏—á–µ—Å–∫–∞—è —à–ª—è–ø–∞' },
            astronaut: { name: '–ö–æ—Å–º–æ–Ω–∞–≤—Ç', price: 6000, emoji: 'üë®‚ÄçüöÄ', description: '–°–∫–∞—Ñ–∞–Ω–¥—Ä' },
            dancer: { name: '–¢–∞–Ω—Ü–æ—Ä', price: 9000, emoji: 'üíÉ', description: '–Ø—Ä–∫–∏–π –∫–æ—Å—Ç—é–º' },
            vampire: { name: '–í–∞–º–ø–∏—Ä', price: 9999, emoji: 'üßõ', description: '–ß–µ—Ä–Ω—ã–π –ø–ª–∞—â' },
            princess: { name: '–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞', price: 10000, emoji: 'üë∏', description: '–†–æ—Å–∫–æ—à–Ω–æ–µ –ø–ª–∞—Ç—å–µ' },
            angel: { name: '–ê–Ω–≥–µ–ª', price: 14000, emoji: 'üëº', description: '–ë–µ–ª—ã–µ –∫—Ä—ã–ª—å—è' },
            robot: { name: '–†–æ–±–æ—Ç', price: 20000, emoji: 'ü§ñ', description: '–ú–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –∫–æ—Å—Ç—é–º' }
        };
        this.currentSkin = 'default';
        this.outfit = 'default';
        this.evolutionStage = 'baby';
        this.petName = 'Labubu';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        this.food = [
            { name: '–ü–µ—á–µ–Ω—å–µ', hunger: 20, price: 20, emoji: 'üç™', happiness: 5 },
            { name: '–§—Ä—É–∫—Ç—ã', hunger: 30, price: 35, emoji: 'üçé', health: 5 },
            { name: '–°—É—à–∏', hunger: 50, price: 65, emoji: 'üç£', happiness: 10 },
            { name: '–¢–æ—Ä—Ç', hunger: 40, happiness: 15, price: 75, emoji: 'üç∞' },
            { name: '–ú–æ—Ä–æ–∂–µ–Ω–æ–µ', hunger: 25, happiness: 20, price: 45, emoji: 'üç¶' },
            { name: '–ü–∏—Ü—Ü–∞', hunger: 60, price: 80, emoji: 'üçï', happiness: 10 },
            { name: '–í–∏—Ç–∞–º–∏–Ω—ã', health: 30, price: 95, emoji: 'üíä' },
            { name: '–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫', energy: 40, price: 55, emoji: '‚ö°' },
            { name: '–ë—É—Ä–≥–µ—Ä', hunger: 45, price: 50, emoji: 'üçî', happiness: 8 },
            { name: '–†—ã–±–∞', hunger: 35, health: 10, price: 45, emoji: 'üêü' },
            { name: '–°–∞–ª–∞—Ç', health: 15, cleanliness: 10, price: 40, emoji: 'ü•ó' },
            { name: '–ú–æ–ª–æ–∫–æ', hunger: 15, health: 8, price: 25, emoji: 'ü•õ' }
        ];
        
        this.miniGames = [
            { id: 'memory', name: '–ú–µ–º–æ—Ä–∏', emoji: 'üß†', description: '–ó–∞–ø–æ–º–Ω–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', reward: { happiness: 25, experience: 20, money: 15 } },
            { id: 'reaction', name: '–†–µ–∞–∫—Ü–∏—è', emoji: '‚ö°', description: '–ù–∞–∂–º–∏ –∫–æ–≥–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è —Å–∏–≥–Ω–∞–ª', reward: { happiness: 20, experience: 15, money: 10 } },
            { id: 'math', name: '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', emoji: 'üî¢', description: '–†–µ—à–∏ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä', reward: { happiness: 30, experience: 25, money: 20 } },
            { id: 'puzzle', name: '–ü–∞–∑–ª', emoji: 'üß©', description: '–°–æ–±–µ—Ä–∏ —á–∏—Å–ª–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É', reward: { happiness: 35, experience: 30, money: 25 } },
            { id: 'quiz', name: '–í–∏–∫—Ç–æ—Ä–∏–Ω–∞', emoji: 'ü§î', description: '–û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å', reward: { happiness: 28, experience: 22, money: 18 } },
            { id: 'rhythm', name: '–†–∏—Ç–º', emoji: 'üéµ', description: '–ü–æ–≤—Ç–æ—Ä–∏ —Ä–∏—Ç–º', reward: { happiness: 40, experience: 25, money: 20 } }
        ];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        this.initializeData();
        
        // –ó–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
        this.audioContext = null;
        this.soundEnabled = this.loadData('sound_enabled', true, 'boolean');
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        this.activeTab = 'care';
        this.currentMiniGame = null;
        this.notifications = [];
        
        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –í–´–î–ê–ï–ú –í–°–ï –†–ï–°–£–†–°–´ –î–õ–Ø –¶–ï–õ–ï–í–û–ì–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø –ü–†–ò –ó–ê–ü–£–°–ö–ï
        this.autoGiveResources = () => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ —Ü–µ–ª–µ–≤–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (Telegram ID: 5224479471)
            if (typeof window !== 'undefined' && window.hatch && window.hatch.useUser) {
                try {
                    const user = window.hatch.useUser();
                    if (user && (user.name === 'Jojo' || user.id === 'user_2z7V9FOEAACKKYnUxFVldLTZhFE')) {
                        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –í–´–î–ê–ï–ú –í–°–ï!
                        this.money = 999999;
                        this.chestCount = 9999;
                        this.stats = {
                            hunger: 100,
                            happiness: 100,
                            cleanliness: 100,
                            health: 100,
                            energy: 100,
                            sleep: 100
                        };
                        this.level = 100;
                        this.experience = 9999;
                        
                        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        this.ownedOutfits = Object.keys(this.outfits);
                        
                        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ Telegram ID 5224479471
                        this.telegramConnected = true;
                        this.telegramChatId = '5224479471';
                        
                        this.showMessage('üëë –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –í–´–î–ê–ù–´ –†–ï–°–£–†–°–´! 999,999 –º–æ–Ω–µ—Ç, 9999 —Å—É–Ω–¥—É–∫–æ–≤, 100 —É—Ä–æ–≤–µ–Ω—å! Telegram –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                        this.saveData();
                        this.updateDisplay();
                        
                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –ë–î —Å Telegram ID
                        this.autoRegisterTelegram();
                        
                        console.log('üëë –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –í–´–î–ê–ù–´ –í–°–ï –†–ï–°–£–†–°–´ –ò –ü–û–î–ö–õ–Æ–ß–ï–ù TELEGRAM!');
                        return true;
                    }
                } catch (e) {
                    // –ï—Å–ª–∏ hatch.useUser –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
                }
            }
            return false;
        };
        
        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –í –ë–î –° TELEGRAM ID
        this.autoRegisterTelegram = async () => {
            try {
                const response = await fetch('https://labubu-server.onrender.com/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chatId: '5224479471', // Telegram ID —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        gameUserId: this.gameUserId,
                        petName: this.petName
                    })
                });
                
                if (response.ok) {
                    console.log('‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –ë–î —É—Å–ø–µ—à–Ω–∞ –¥–ª—è Telegram ID: 5224479471');
                    this.showMessage('‚úÖ Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É!');
                } else {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –ë–î');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É:', error);
            }
        };
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
        setTimeout(() => {
            this.updateDisplay();
        }, 50);
        
        // –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –í–´–î–ê–ï–ú –†–ï–°–£–†–°–´ –î–õ–Ø –¶–ï–õ–ï–í–û–ì–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
        setTimeout(() => {
            this.autoGiveResources();
        }, 500);
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        setInterval(() => {
            if (this.telegramConnected && this.telegramChatId === '5224479471') {
                this.saveToDatabaseAsync().then(success => {
                    if (success) {
                        console.log('üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –≤—ã–ø–æ–ª–Ω–µ–Ω–æ');
                    }
                });
            }
        }, 10000); // –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        this.init();
        this.startGameLoop();
        this.startRealTimeStatDecay(); // –ù–û–í–û–ï: –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—É –ø–∞–¥–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
        this.startNotificationTimer();
        
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        this.startAutoSave();
        
        // –ï—â–µ –æ–¥–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        setTimeout(() => {
            this.updateDisplay();
            console.log('üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
        }, 1000);
    }
    
    async initializeData() {
        console.log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã...');
        
        try {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
            this.gameUserId = this.loadData('game_user_id', this.generateUserId(), 'string');
            this.telegramConnected = this.loadData('telegram_connected', false, 'boolean');
            this.telegramChatId = this.loadData('telegram_chat_id', '', 'string');
            
            console.log('üíæ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...');
            
            // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ë–î
            const loadedFromDB = await this.loadFromDatabaseSync();
            
            if (loadedFromDB) {
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö');
            } else {
                console.log('üì± –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤...');
                
                // –ï—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage
                this.stats = this.loadData('shared_labubu_stats', {
                    hunger: 100, happiness: 100, cleanliness: 100,
                    health: 100, energy: 100, sleep: 100
                });
                
                this.money = this.loadData('shared_labubu_money', 100, 'number');
                this.outfit = this.loadData('shared_labubu_outfit', 'default', 'string');
                this.ownedOutfits = this.loadData('shared_owned_outfits', ['default']); // –ù–û–í–û–ï: —Å–ø–∏—Å–æ–∫ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤
                this.level = this.loadData('shared_labubu_level', 1, 'number');
                this.experience = this.loadData('shared_labubu_experience', 0, 'number');
                this.age = this.loadData('shared_labubu_age', 0, 'number');
                this.evolutionStage = this.loadData('shared_labubu_evolution', 'baby', 'string');
                this.lastUpdate = this.loadData('shared_labubu_last_update', Date.now(), 'number');
                this.lastNotification = this.loadData('shared_labubu_last_notification', Date.now(), 'number');
                this.petName = this.loadData('shared_pet_name', 'Labubu', 'string');
                this.isSleeping = this.loadData('shared_labubu_sleeping', false, 'boolean');
                this.currentSkin = this.loadData('shared_current_skin', 'default', 'string');
                this.unlockedSkins = this.loadData('shared_unlocked_skins', ['default']);
                this.chestCount = this.loadData('shared_chest_count', 0, 'number');
                this.friendsInvited = this.loadData('shared_friends_invited', 0, 'number');
                this.lastChestLevel = this.loadData('shared_last_chest_level', 0, 'number');
                this.lastStatDecay = this.loadData('shared_last_stat_decay', Date.now(), 'number'); // –ù–û–í–û–ï: –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
                
                console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤ (–≤—Å–µ–≥–¥–∞ –∏–∑ localStorage –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
            this.pets = this.loadData('shared_labubu_pets', [
                { 
                    id: 'pet1', 
                    name: this.petName, 
                    stats: this.stats, 
                    outfit: this.outfit, 
                    age: this.age, 
                    evolutionStage: this.evolutionStage,
                    currentSkin: this.currentSkin
                }
            ]);
            this.activePetId = this.loadData('shared_active_pet_id', 'pet1', 'string');
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º Telegram –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (typeof window !== 'undefined' && window.hatch && window.hatch.useUser) {
                try {
                    const user = window.hatch.useUser();
                    if (user && (user.name === 'Jojo' || user.id === 'user_2z7V9FOEAACKKYnUxFVldLTZhFE')) {
                        this.telegramConnected = true;
                        this.telegramChatId = '5224479471';
                        console.log('‚úÖ Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    }
                } catch (e) {
                    console.log('‚ö†Ô∏è Hatch.useUser –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');
                }
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            this.validateGameData();
            
            console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:', error);
            this.resetToDefaults();
        }
    }
    
    loadData(key, defaultValue, type = 'auto') {
        try {
            const saved = localStorage.getItem(key);
            
            if (saved === null || saved === undefined) {
                return defaultValue;
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
            switch (type) {
                case 'string':
                    return saved;
                    
                case 'number':
                    const num = parseFloat(saved);
                    return isNaN(num) ? defaultValue : num;
                    
                case 'boolean':
                    return saved === 'true';
                    
                case 'auto':
                default:
                    try {
                        return JSON.parse(saved);
                    } catch (parseError) {
                        console.warn(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –∫–ª—é—á–∞ ${key}:`, parseError);
                        return defaultValue;
                    }
            }
        } catch (error) {
            console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–ª—é—á–∞ ${key}:`, error);
            return defaultValue;
        }
    }
    
    saveData() {
        try {
            console.log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã...');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            this.lastUpdate = Date.now();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
            this.updateActivePet();
            
            // –ü–†–ò–û–†–ò–¢–ï–¢: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            this.saveToDatabaseAsync().then(success => {
                if (success) {
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)');
                } else {
                    console.log('‚ö†Ô∏è –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –≤ localStorage');
                }
            });
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (this.telegramChatId === '5224479471') {
                // –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                setTimeout(() => {
                    this.saveToDatabaseAsync().then(success => {
                        if (success) {
                            console.log('üîÑ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                        }
                    });
                }, 2000);
            }
            
            // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ localStorage –∫–∞–∫ –∫—ç—à
            this.saveToLocalStorage();
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
            this.createBackup();
            
            console.log('‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–æ');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            this.showMessage('‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
        }
    }
    
    saveValue(key, value) {
        try {
            if (typeof value === 'object') {
                localStorage.setItem(key, JSON.stringify(value));
            } else {
                localStorage.setItem(key, value.toString());
            }
        } catch (error) {
            console.error(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ${key}:`, error);
        }
    }
    
    validateGameData() {
        console.log('üîç –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã...');
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
        if (!this.stats || typeof this.stats !== 'object') {
            this.stats = {
                hunger: 100, happiness: 100, cleanliness: 100,
                health: 100, energy: 100, sleep: 100
            };
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        this.money = Math.max(0, this.money || 0);
        this.level = Math.max(1, this.level || 1);
        this.experience = Math.max(0, this.experience || 0);
        this.age = Math.max(0, this.age || 0);
        this.chestCount = Math.max(0, this.chestCount || 0);
        this.friendsInvited = Math.max(0, this.friendsInvited || 0);
        this.lastChestLevel = Math.max(0, this.lastChestLevel || 0);
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –ø–∏—Ç–æ–º—Ü–∞ (0-100)
        Object.keys(this.stats).forEach(stat => {
            this.stats[stat] = Math.max(0, Math.min(100, this.stats[stat] || 100));
        });
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ø–æ–ª–µ–π
        this.petName = this.petName || 'Labubu';
        this.outfit = this.outfit || 'default';
        this.currentSkin = this.currentSkin || 'default';
        this.evolutionStage = this.evolutionStage || 'baby';
        this.gameUserId = this.gameUserId || this.generateUserId();
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤
        if (!Array.isArray(this.unlockedSkins)) {
            this.unlockedSkins = ['default'];
        }
        
        if (!Array.isArray(this.ownedOutfits)) {
            this.ownedOutfits = ['default'];
        }
        
        if (!Array.isArray(this.pets)) {
            this.pets = [{
                id: 'pet1',
                name: this.petName,
                stats: this.stats,
                outfit: this.outfit,
                age: this.age,
                evolutionStage: this.evolutionStage,
                currentSkin: this.currentSkin
            }];
        }
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
        if (!this.lastUpdate || this.lastUpdate > Date.now()) {
            this.lastUpdate = Date.now();
        }
        
        if (!this.lastNotification || this.lastNotification > Date.now()) {
            this.lastNotification = Date.now();
        }
        
        if (!this.lastStatDecay || this.lastStatDecay > Date.now()) {
            this.lastStatDecay = Date.now();
        }
        
        console.log('‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
        console.log('üìä –§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:', {
            petName: this.petName,
            level: this.level,
            money: this.money,
            experience: this.experience,
            age: this.age,
            stats: this.stats
        });
    }
    
    updateActivePet() {
        const activePet = this.pets.find(pet => pet.id === this.activePetId);
        if (activePet) {
            activePet.name = this.petName;
            activePet.stats = { ...this.stats };
            activePet.outfit = this.outfit;
            activePet.age = this.age;
            activePet.evolutionStage = this.evolutionStage;
            activePet.currentSkin = this.currentSkin;
            activePet.level = this.level;
            activePet.experience = this.experience;
            activePet.money = this.money;
        }
    }
    
    createBackup() {
        try {
            const backupData = {
                timestamp: Date.now(),
                version: '4.0',
                data: {
                    stats: this.stats,
                    money: this.money,
                    outfit: this.outfit,
                    ownedOutfits: this.ownedOutfits,
                    level: this.level,
                    experience: this.experience,
                    age: this.age,
                    evolutionStage: this.evolutionStage,
                    petName: this.petName,
                    isSleeping: this.isSleeping,
                    currentSkin: this.currentSkin,
                    unlockedSkins: this.unlockedSkins,
                    chestCount: this.chestCount,
                    friendsInvited: this.friendsInvited,
                    pets: this.pets
                }
            };
            
            localStorage.setItem('labubu_backup', JSON.stringify(backupData));
            
            // –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
            const backupHistory = JSON.parse(localStorage.getItem('labubu_backup_history') || '[]');
            backupHistory.push(backupData);
            
            if (backupHistory.length > 3) {
                backupHistory.shift();
            }
            
            localStorage.setItem('labubu_backup_history', JSON.stringify(backupHistory));
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:', error);
        }
    }
    
    resetToDefaults() {
        console.log('üîÑ –°–±—Ä–æ—Å –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é...');
        
        this.stats = {
            hunger: 100, happiness: 100, cleanliness: 100,
            health: 100, energy: 100, sleep: 100
        };
        
        this.money = 100;
        this.outfit = 'default';
        this.ownedOutfits = ['default'];
        this.level = 1;
        this.experience = 0;
        this.age = 0;
        this.evolutionStage = 'baby';
        this.lastUpdate = Date.now();
        this.lastNotification = Date.now();
        this.lastStatDecay = Date.now();
        this.petName = 'Labubu';
        this.isSleeping = false;
        this.telegramConnected = false;
        this.telegramChatId = '';
        this.gameUserId = this.generateUserId();
        this.currentSkin = 'default';
        this.unlockedSkins = ['default'];
        this.chestCount = 0;
        this.friendsInvited = 0;
        this.lastChestLevel = 0;
        
        this.pets = [{
            id: 'pet1',
            name: this.petName,
            stats: this.stats,
            outfit: this.outfit,
            age: this.age,
            evolutionStage: this.evolutionStage,
            currentSkin: this.currentSkin
        }];
        this.activePetId = 'pet1';
        
        this.saveData();
    }
    
    startAutoSave() {
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            this.saveData();
        }, 30000);
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ë–î –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
        setInterval(() => {
            this.loadFromDatabaseAsync();
        }, 120000);
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            this.saveData();
        });
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
        window.addEventListener('blur', () => {
            this.saveData();
        });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
        window.addEventListener('focus', () => {
            this.loadFromDatabaseAsync();
        });
    }
    
    saveToLocalStorage() {
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ localStorage (–±–µ–∑ –ë–î)
        this.saveValue('shared_labubu_stats', this.stats);
        this.saveValue('shared_labubu_money', this.money);
        this.saveValue('shared_labubu_outfit', this.outfit);
        this.saveValue('shared_owned_outfits', this.ownedOutfits); // –ù–û–í–û–ï: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫—É–ø–ª–µ–Ω–Ω—ã–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã
        this.saveValue('shared_labubu_level', this.level);
        this.saveValue('shared_labubu_experience', this.experience);
        this.saveValue('shared_labubu_age', this.age);
        this.saveValue('shared_labubu_evolution', this.evolutionStage);
        this.saveValue('shared_labubu_last_update', Date.now());
        this.saveValue('shared_last_stat_decay', this.lastStatDecay); // –ù–û–í–û–ï: –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è
        this.saveValue('shared_pet_name', this.petName);
        this.saveValue('shared_labubu_sleeping', this.isSleeping);
        this.saveValue('shared_current_skin', this.currentSkin);
        this.saveValue('shared_unlocked_skins', this.unlockedSkins);
        this.saveValue('shared_chest_count', this.chestCount);
        this.saveValue('shared_friends_invited', this.friendsInvited);
        this.saveValue('shared_last_chest_level', this.lastChestLevel);
        this.saveValue('shared_labubu_last_notification', this.lastNotification);
    }
    
    // –ù–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê –†–ï–ê–õ–¨–ù–û–ì–û –í–†–ï–ú–ï–ù–ò –î–õ–Ø –ü–ê–î–ï–ù–ò–Ø –°–¢–ê–¢–ò–°–¢–ò–ö
    startRealTimeStatDecay() {
        console.log('üîÑ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏...');
        
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        this.processTimeAway();
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ü–∏–∫–ª –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            const now = Date.now();
            const timeSinceLastDecay = now - this.lastStatDecay;
            
            // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª–µ–µ 30 —Å–µ–∫—É–Ω–¥ - –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            if (timeSinceLastDecay >= 30000) { // 30 —Å–µ–∫—É–Ω–¥
                this.updateStatsRealTime();
                this.lastStatDecay = now;
                this.saveValue('shared_last_stat_decay', now);
            }
        }, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        
        console.log('‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—â–µ–Ω–∞!');
    }
    
    processTimeAway() {
        const now = Date.now();
        const timeAway = now - this.lastStatDecay;
        
        if (timeAway > 60000) { // –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –±–æ–ª—å—à–µ –º–∏–Ω—É—Ç—ã
            const minutesAway = Math.floor(timeAway / 60000);
            console.log(`‚è∞ –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ ${minutesAway} –º–∏–Ω—É—Ç, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º...`);
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞ –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è
            this.calculateStatsForTimeAway(minutesAway);
            this.lastStatDecay = now;
            this.saveValue('shared_last_stat_decay', now);
            
            this.showMessage(`‚è∞ –í—ã –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ ${minutesAway} –º–∏–Ω. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!`);
        }
    }
    
    calculateStatsForTimeAway(minutesAway) {
        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è (—á—Ç–æ–±—ã –Ω–µ —É–±–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞)
        const maxMinutes = Math.min(minutesAway, 480); // –ú–∞–∫—Å–∏–º—É–º 8 —á–∞—Å–æ–≤
        const intervals = Math.floor(maxMinutes / 0.5); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ = 0.5 –º–∏–Ω—É—Ç—ã
        
        for (let i = 0; i < intervals; i++) {
            if (this.isSleeping) {
                // –í–æ –≤—Ä–µ–º—è —Å–Ω–∞
                this.stats.energy = Math.min(100, this.stats.energy + 1.5); // –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
                this.stats.sleep = Math.min(100, this.stats.sleep + 2);
                this.stats.hunger = Math.max(0, this.stats.hunger - 0.3);
                this.stats.happiness = Math.max(0, this.stats.happiness - 0.2);
                this.stats.cleanliness = Math.max(0, this.stats.cleanliness - 0.2);
                this.stats.health = Math.max(0, this.stats.health - 0.1);
            } else {
                // –í –∞–∫—Ç–∏–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
                this.stats.hunger = Math.max(0, this.stats.hunger - 0.5);
                this.stats.happiness = Math.max(0, this.stats.happiness - 0.4);
                this.stats.cleanliness = Math.max(0, this.stats.cleanliness - 0.3);
                this.stats.health = Math.max(0, this.stats.health - 0.2);
                this.stats.energy = Math.min(100, this.stats.energy + 0.3); // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
                this.stats.sleep = Math.max(0, this.stats.sleep - 0.6);
            }
        }
        
        // –û–∫—Ä—É–≥–ª—è–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è
        Object.keys(this.stats).forEach(key => {
            this.stats[key] = Math.round(this.stats[key]);
        });
        
        this.saveData();
        this.updateDisplay();
    }
    
    updateStatsRealTime() {
        if (this.isSleeping) {
            // –í–æ –≤—Ä–µ–º—è —Å–Ω–∞: –±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Å–Ω–∞
            this.stats.energy = Math.min(100, this.stats.energy + 3); // +3 –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
            this.stats.sleep = Math.min(100, this.stats.sleep + 4); // +4 –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
            // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            this.stats.hunger = Math.max(0, this.stats.hunger - 0.5);
            this.stats.happiness = Math.max(0, this.stats.happiness - 0.3);
            this.stats.cleanliness = Math.max(0, this.stats.cleanliness - 0.3);
            this.stats.health = Math.max(0, this.stats.health - 0.2);
        } else {
            // –í –∞–∫—Ç–∏–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏: –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ
            this.stats.hunger = Math.max(0, this.stats.hunger - 1); // -1 –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
            this.stats.happiness = Math.max(0, this.stats.happiness - 0.8);
            this.stats.cleanliness = Math.max(0, this.stats.cleanliness - 0.6);
            this.stats.health = Math.max(0, this.stats.health - 0.4);
            this.stats.energy = Math.min(100, this.stats.energy + 0.5); // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
            this.stats.sleep = Math.max(0, this.stats.sleep - 1.2);
        }
        
        // –û–∫—Ä—É–≥–ª—è–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è
        Object.keys(this.stats).forEach(key => {
            this.stats[key] = Math.round(this.stats[key]);
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏
        this.checkNotifications();
        
        this.saveData();
        this.updateDisplay();
        
        console.log(`üìâ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (${this.isSleeping ? '—Å–ø–∏—Ç' : '–Ω–µ —Å–ø–∏—Ç'})`);
    }
    
    init() {
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
        this.updateTimeAndWeather();
        
        // –í–ê–ñ–ù–û: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        this.updateDisplay();
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        this.initEventListeners();
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        this.switchTab('care');
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—â–µ —Ä–∞–∑ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∫–ª–∞–¥–∫–∏
        setTimeout(() => {
            this.updateDisplay();
        }, 100);
    }
    
    initEventListeners() {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
        document.addEventListener('click', (e) => {
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏
            if (e.target.id === 'editNameBtn') {
                this.showNameEdit();
            } else if (e.target.id === 'saveNameBtn') {
                this.saveNameEdit();
            } else if (e.target.id === 'cancelNameBtn') {
                this.cancelNameEdit();
            }
            // –ó–≤—É–∫
            else if (e.target.id === 'soundToggle') {
                this.toggleSound();
            }
            // –í–∫–ª–∞–¥–∫–∏
            else if (e.target.classList.contains('tab-btn')) {
                this.switchTab(e.target.dataset.tab);
            }
            // –ú–∏–Ω–∏-–∏–≥—Ä—ã
            else if (e.target.id === 'cancelGameBtn') {
                this.closeMiniGame();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –¥–ª—è –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏
        document.addEventListener('keypress', (e) => {
            if (e.target.id === 'nameInput' && e.key === 'Enter') {
                this.saveNameEdit();
            }
        });
    }
    
    updateTimeAndWeather() {
        const hour = new Date().getHours();
        const timeElement = document.getElementById('timeOfDay');
        const weatherElement = document.getElementById('weather');
        
        if (hour >= 6 && hour < 12) timeElement.textContent = 'üåÖ';
        else if (hour >= 12 && hour < 18) timeElement.textContent = '‚òÄÔ∏è';
        else if (hour >= 18 && hour < 22) timeElement.textContent = 'üåÜ';
        else timeElement.textContent = 'üåô';
        
        const weathers = ['‚òÄÔ∏è', '‚òÅÔ∏è', 'üåßÔ∏è', '‚ùÑÔ∏è'];
        weatherElement.textContent = weathers[Math.floor(Math.random() * weathers.length)];
    }
    
    updateDisplay() {
        console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è...', {
            petName: this.petName,
            level: this.level,
            money: this.money,
            experience: this.experience,
            age: this.age
        });
        
        // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        const petNameDisplay = document.getElementById('petNameDisplay');
        const levelDisplay = document.getElementById('levelDisplay');
        const moneyDisplay = document.getElementById('moneyDisplay');
        const expDisplay = document.getElementById('expDisplay');
        const ageDisplay = document.getElementById('ageDisplay');
        const ageText = document.getElementById('ageText');
        const soundToggle = document.getElementById('soundToggle');
        
        if (petNameDisplay) {
            petNameDisplay.textContent = this.petName;
            console.log('‚úÖ –ò–º—è –ø–∏—Ç–æ–º—Ü–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:', this.petName);
        }
        if (levelDisplay) {
            levelDisplay.textContent = `Lv.${this.level}`;
            console.log('‚úÖ –£—Ä–æ–≤–µ–Ω—å –æ–±–Ω–æ–≤–ª–µ–Ω:', this.level);
        }
        if (moneyDisplay) {
            moneyDisplay.textContent = `üí∞${this.money}`;
            console.log('‚úÖ –î–µ–Ω—å–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', this.money);
        }
        if (expDisplay) {
            expDisplay.textContent = `‚≠ê${this.experience}/100`;
            console.log('‚úÖ –û–ø—ã—Ç –æ–±–Ω–æ–≤–ª–µ–Ω:', this.experience);
        }
        if (ageDisplay) ageDisplay.textContent = `üéÇ${this.age}–¥`;
        if (ageText) ageText.textContent = this.age;
        
        // –ó–≤—É–∫
        if (soundToggle) soundToggle.textContent = this.soundEnabled ? 'üîä' : 'üîá';
        
        // –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
        const mood = this.getMood();
        const moodEmoji = document.getElementById('moodEmoji');
        const moodStatus = document.getElementById('moodStatus');
        const evolutionStage = document.getElementById('evolutionStage');
        const petImage = document.getElementById('petImage');
        
        if (moodEmoji && mood) moodEmoji.textContent = mood.emoji;
        if (moodStatus && mood) moodStatus.textContent = mood.status;
        if (evolutionStage && this.evolutionStages && this.evolutionStages[this.evolutionStage]) {
            evolutionStage.textContent = this.evolutionStages[this.evolutionStage].name;
        }
        
        // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞
        if (petImage && this.skins && this.skins[this.currentSkin] && this.skins[this.currentSkin].image) {
            petImage.src = this.skins[this.currentSkin].image;
        }
        
        // –°–æ–Ω –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
        const sleepIndicator = document.getElementById('sleepIndicator');
        const criticalIndicator = document.getElementById('criticalIndicator');
        const moodIndicator = document.getElementById('moodIndicator');
        
        if (sleepIndicator) sleepIndicator.classList.toggle('hidden', !this.isSleeping);
        
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ stats –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
        if (this.stats && typeof this.stats === 'object') {
            const avgStats = Object.values(this.stats).reduce((a, b) => a + b, 0) / 6;
            if (criticalIndicator) criticalIndicator.classList.toggle('hidden', avgStats > 10);
        }
        
        if (moodIndicator && mood) {
            if (mood.emoji === 'ü•∞') moodIndicator.textContent = '‚ù§Ô∏è';
            else moodIndicator.textContent = '';
        }
        
        // –û–¥–µ–∂–¥–∞
        this.updateOutfit();
        
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        this.updateStatsDisplay();
    }
    
    updateOutfit() {
        const outfitContainer = document.getElementById('outfitContainer');
        const currentOutfitEl = document.getElementById('currentOutfit');
        
        if (!outfitContainer || !currentOutfitEl) return;
        
        outfitContainer.innerHTML = '';
        
        if (this.outfit !== 'default' && this.outfits && this.outfits[this.outfit]) {
            const outfitData = this.outfits[this.outfit];
            currentOutfitEl.textContent = `${outfitData.emoji} ${outfitData.name}`;
            currentOutfitEl.classList.remove('hidden');
        } else {
            currentOutfitEl.classList.add('hidden');
        }
    }
    
    updateStatsDisplay() {
        const container = document.getElementById('statsContainer');
        if (!container) return;
        
        const stats = [
            { label: 'üçΩÔ∏è –ì–æ–ª–æ–¥', value: this.stats.hunger, color: 'bg-orange-500' },
            { label: 'üòä –°—á–∞—Å—Ç—å–µ', value: this.stats.happiness, color: 'bg-yellow-500' },
            { label: 'üõÅ –ß–∏—Å—Ç–æ—Ç–∞', value: this.stats.cleanliness, color: 'bg-blue-500' },
            { label: '‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ', value: this.stats.health, color: 'bg-red-500' },
            { label: '‚ö° –≠–Ω–µ—Ä–≥–∏—è', value: this.stats.energy, color: 'bg-green-500' },
            { label: 'üò¥ –°–æ–Ω', value: this.stats.sleep, color: 'bg-purple-500' }
        ];
        
        container.innerHTML = stats.map(stat => `
            <div class="mb-2">
                <div class="flex justify-between mb-1">
                    <span class="text-xs font-medium">${stat.label}</span>
                    <span class="text-xs">${stat.value}%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-1.5">
                    <div class="h-1.5 rounded-full transition-all duration-300 ${stat.color}" style="width: ${stat.value}%"></div>
                </div>
            </div>
        `).join('');
    }
    
    getMood() {
        if (this.isSleeping) return { emoji: 'üò¥', status: '–°–ø–∏—Ç' };
        
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ stats
        if (!this.stats || typeof this.stats !== 'object') {
            return { emoji: 'üòê', status: '–ó–∞–≥—Ä—É–∑–∫–∞...' };
        }
        
        const avg = Object.values(this.stats).reduce((a, b) => a + b, 0) / 6;
        if (avg > 90) return { emoji: 'ü•∞', status: '–í–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω–æ' };
        if (avg > 80) return { emoji: 'üòä', status: '–û—á–µ–Ω—å —Å—á–∞—Å—Ç–ª–∏–≤' };
        if (avg > 60) return { emoji: 'üôÇ', status: '–°—á–∞—Å—Ç–ª–∏–≤' };
        if (avg > 40) return { emoji: 'üòê', status: '–ù–æ—Ä–º–∞–ª—å–Ω–æ' };
        if (avg > 20) return { emoji: 'üòü', status: '–ì—Ä—É—Å—Ç–Ω–æ' };
        if (avg > 10) return { emoji: 'üò¢', status: '–û—á–µ–Ω—å –≥—Ä—É—Å—Ç–Ω–æ' };
        return { emoji: 'üíÄ', status: '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ' };
    }
    
    showMessage(msg) {
        const messageEl = document.getElementById('gameMessage');
        messageEl.textContent = msg;
        messageEl.classList.remove('hidden');
        setTimeout(() => messageEl.classList.add('hidden'), 3000);
    }
    
    showNameEdit() {
        document.getElementById('nameEditSection').classList.remove('hidden');
        document.getElementById('editNameBtn').classList.add('hidden');
        document.getElementById('nameInput').value = this.petName;
        document.getElementById('nameInput').focus();
    }
    
    saveNameEdit() {
        const newName = document.getElementById('nameInput').value.trim();
        if (newName && newName.length <= 15) {
            this.petName = newName;
            this.showMessage(`–¢–µ–ø–µ—Ä—å –∑–æ–≤—É—Ç ${this.petName}!`);
            this.saveData();
            this.updateDisplay();
        }
        this.cancelNameEdit();
    }
    
    cancelNameEdit() {
        document.getElementById('nameEditSection').classList.add('hidden');
        document.getElementById('editNameBtn').classList.remove('hidden');
    }
    
    toggleSound() {
        this.soundEnabled = !this.soundEnabled;
        this.updateDisplay();
        this.saveData();
    }
    
    playSound(frequency, duration = 200, type = 'sine') {
        if (!this.soundEnabled) return;
        
        try {
            if (!this.audioContext) {
                this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            const oscillator = this.audioContext.createOscillator();
            const gainNode = this.audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(this.audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0.1, this.audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration / 1000);
            
            oscillator.start();
            oscillator.stop(this.audioContext.currentTime + duration / 1000);
        } catch (error) {
            console.log('Sound not available');
        }
    }
    
    playHappySound() {
        this.playSound(523, 100);
        setTimeout(() => this.playSound(659, 100), 100);
        setTimeout(() => this.playSound(784, 150), 200);
    }
    
    switchTab(tab) {
        this.activeTab = tab;
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('.tab-btn').forEach(btn => {
            if (btn.dataset.tab === tab) {
                btn.className = 'tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors bg-purple-500 text-white';
            } else {
                btn.className = 'tab-btn flex-1 py-2 px-1 rounded-md font-medium transition-colors text-purple-500 hover:bg-purple-50';
            }
        });
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
        const content = document.getElementById('tabContent');
        content.innerHTML = this.getTabContent(tab);
    }
    
    getTabContent(tab) {
        switch (tab) {
            case 'care':
                return this.getCareTabContent();
            case 'games':
                return this.getGamesTabContent();
            case 'shop':
                return this.getShopTabContent();
            case 'chests':
                return this.getChestsTabContent();
            case 'pets':
                return this.getPetsTabContent();
            case 'info':
                return this.getInfoTabContent();
            default:
                return '';
        }
    }
    
    getCareTabContent() {
        const foodGrid = this.food.map((item, index) => `
            <button onclick="game.feedPet(${index})" class="bg-orange-100 hover:bg-orange-200 p-2 rounded text-xs transition-colors" ${this.isSleeping ? 'disabled' : ''}>
                <div class="text-sm">${item.emoji}</div>
                <div class="font-medium text-xs">${item.name}</div>
                <div class="text-xs text-gray-600">${item.price}üí∞</div>
            </button>
        `).join('');
        
        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üçΩÔ∏è –ö–æ—Ä–º–ª–µ–Ω–∏–µ</h3>
                    <div class="grid grid-cols-4 gap-1">${foodGrid}</div>
                </div>
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">‚ö° –î–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="grid grid-cols-3 gap-1">
                        <button onclick="game.washPet()" class="bg-blue-100 hover:bg-blue-200 p-2 rounded text-xs transition-colors" ${this.isSleeping ? 'disabled' : ''}>
                            <div class="text-sm">üõÅ</div>
                            <div class="font-medium">–ú—ã—Ç—å</div>
                        </button>
                        <button onclick="game.healPet()" class="bg-red-100 hover:bg-red-200 p-2 rounded text-xs transition-colors">
                            <div class="text-sm">üíä</div>
                            <div class="font-medium">–õ–µ—á–∏—Ç—å</div>
                            <div class="text-xs">30üí∞</div>
                        </button>
                        <button onclick="game.toggleSleep()" class="bg-purple-100 hover:bg-purple-200 p-2 rounded text-xs transition-colors">
                            <div class="text-sm">${this.isSleeping ? '‚òÄÔ∏è' : 'üò¥'}</div>
                            <div class="font-medium">${this.isSleeping ? '–ë—É–¥–∏—Ç—å' : '–°–ø–∞—Ç—å'}</div>
                        </button>
                    </div>
                </div>
            </div>
        `;
    }
    
    getGamesTabContent() {
        const gamesGrid = this.miniGames.map((game, index) => `
            <button onclick="game.startMiniGame(${index})" class="p-2 rounded-lg text-xs transition-colors bg-yellow-100 hover:bg-yellow-200 flex flex-col items-center" ${this.isSleeping || this.stats.energy < 15 ? 'disabled' : ''}>
                <span class="text-lg mb-1">${game.emoji}</span>
                <div class="font-medium text-center">${game.name}</div>
                <div class="text-xs text-gray-600 text-center">${game.description}</div>
                <div class="text-xs text-red-600 mt-1">-15 —ç–Ω–µ—Ä–≥–∏–∏</div>
            </button>
        `).join('');
        
        return `
            <div class="bg-white rounded-lg p-3 shadow">
                <h3 class="font-bold mb-2 text-purple-800 text-sm">üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã</h3>
                <div class="grid grid-cols-2 gap-2">${gamesGrid}</div>
            </div>
        `;
    }
    
    getShopTabContent() {
        const outfitsList = Object.entries(this.outfits).map(([key, item]) => {
            const isOwned = this.ownedOutfits.includes(key);
            const isWearing = this.outfit === key;
            
            return `
            <button onclick="game.buyOrWearOutfit('${key}')" class="w-full p-2 rounded-lg text-xs transition-colors flex items-center justify-between ${
                isWearing ? 'bg-green-100 border-2 border-green-500' : 
                isOwned ? 'bg-blue-100 hover:bg-blue-200 border border-blue-300' : 
                'bg-gray-100 hover:bg-gray-200'
            }">
                <div class="flex items-center space-x-2">
                    <span class="text-lg">${item.emoji}</span>
                    <div class="text-left">
                        <div class="font-medium">${item.name}</div>
                        <div class="text-xs text-gray-500">${item.description}</div>
                        <div class="text-xs font-bold ${isOwned ? 'text-blue-600' : 'text-gray-600'}">
                            ${isOwned ? (isWearing ? '–ù–∞–¥–µ—Ç–æ' : '–ù–∞–¥–µ—Ç—å') : 
                              item.price === 0 ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : `–ö—É–ø–∏—Ç—å ${item.price}üí∞`}
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    ${isWearing ? '<span class="text-green-600 font-bold">‚úì –ù–∞–¥–µ—Ç–æ</span>' : 
                      isOwned ? '<span class="text-blue-600 font-bold">üì¶ –ö—É–ø–ª–µ–Ω–æ</span>' : 
                      this.money >= item.price ? '<span class="text-green-600 font-bold">üí∞ –ö—É–ø–∏—Ç—å</span>' : 
                      '<span class="text-red-600 font-bold">‚ùå –î–æ—Ä–æ–≥–æ</span>'}
                </div>
            </button>
        `}).join('');
        
        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üëó –ú–∞–≥–∞–∑–∏–Ω –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤</h3>
                    <div class="text-xs text-gray-600 mb-3">
                        üí∞ –£ –≤–∞—Å: ${this.money} –º–æ–Ω–µ—Ç | üì¶ –ö—É–ø–ª–µ–Ω–æ: ${this.ownedOutfits.length}/${Object.keys(this.outfits).length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                    </div>
                    <div class="grid grid-cols-1 gap-1 max-h-64 overflow-y-auto">${outfitsList}</div>
                </div>
                
                <div class="bg-white rounded-lg p-2 shadow">
                    <h4 class="font-bold mb-1 text-purple-800 text-xs">üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h4>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>üõí <strong>–ö—É–ø–∏—Ç—å</strong> - –ø–æ–∫—É–ø–∞–µ—Ç–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä –æ–¥–∏–Ω —Ä–∞–∑</li>
                        <li>üëó <strong>–ù–∞–¥–µ—Ç—å</strong> - –Ω–∞–¥–µ–≤–∞–µ—Ç–µ —É–∂–µ –∫—É–ø–ª–µ–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç</li>
                        <li>‚úÖ <strong>–ù–∞–¥–µ—Ç–æ</strong> - —Ç–µ–∫—É—â–∏–π –∞–∫—Å–µ—Å—Å—É–∞—Ä</li>
                        <li>üíæ –í—Å–µ –ø–æ–∫—É–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞!</li>
                    </ul>
                </div>
            </div>
        `;
    }
    
    getChestsTabContent() {
        const chestTypes = [
            { name: '–û–±—ã—á–Ω—ã–π —Å—É–Ω–¥—É–∫', rarity: 'common', emoji: 'üì¶', cost: 1, rewards: '10-50 –º–æ–Ω–µ—Ç' },
            { name: '–†–µ–¥–∫–∏–π —Å—É–Ω–¥—É–∫', rarity: 'rare', emoji: '‚ú®', cost: 3, rewards: '50-200 –º–æ–Ω–µ—Ç + –æ–¥–µ–∂–¥–∞' },
            { name: '–≠–ø–∏—á–µ—Å–∫–∏–π —Å—É–Ω–¥—É–∫', rarity: 'epic', emoji: 'üíé', cost: 5, rewards: '200-500 –º–æ–Ω–µ—Ç + —Å–∫–∏–Ω' },
            { name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π —Å—É–Ω–¥—É–∫', rarity: 'legendary', emoji: 'üèÜ', cost: 10, rewards: '500-1000 –º–æ–Ω–µ—Ç + —ç–∫—Å–∫–ª—é–∑–∏–≤' }
        ];

        const chestGrid = chestTypes.map((chest, index) => `
            <button onclick="game.openChest('${chest.rarity}')" class="bg-gradient-to-br from-yellow-100 to-orange-100 hover:from-yellow-200 hover:to-orange-200 p-3 rounded-lg text-xs transition-colors">
                <div class="text-2xl mb-1">${chest.emoji}</div>
                <div class="font-medium">${chest.name}</div>
                <div class="text-xs text-gray-600 mt-1">${chest.rewards}</div>
                <div class="text-xs font-bold text-orange-600 mt-1">–°—Ç–æ–∏–º–æ—Å—Ç—å: ${chest.cost} —Å—É–Ω–¥—É–∫${chest.cost > 1 ? (chest.cost < 5 ? '–∞' : '–æ–≤') : ''}</div>
            </button>
        `).join('');

        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üì¶ –£ –≤–∞—Å —Å—É–Ω–¥—É–∫–æ–≤: ${this.chestCount}</h3>
                    <div class="text-xs text-gray-600 mb-3">–ü–æ–ª—É—á–∞–π—Ç–µ —Å—É–Ω–¥—É–∫–∏ –∑–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è (–∫–∞–∂–¥—ã–µ 10 —É—Ä–æ–≤–Ω–µ–π = +1 —Å—É–Ω–¥—É–∫)</div>
                </div>
                
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üéÅ –û—Ç–∫—Ä—ã—Ç—å —Å—É–Ω–¥—É–∫–∏</h3>
                    <div class="grid grid-cols-2 gap-2">${chestGrid}</div>
                </div>
                
                <div class="bg-white rounded-lg p-2 shadow">
                    <h4 class="font-bold mb-1 text-purple-800 text-xs">üí° –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å—É–Ω–¥—É–∫–∏:</h4>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>‚Ä¢ –ö–∞–∂–¥—ã–µ 10 —É—Ä–æ–≤–Ω–µ–π = +1 —Å—É–Ω–¥—É–∫</li>
                        <li>‚Ä¢ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–∑–µ–π = +5 —Å—É–Ω–¥—É–∫–æ–≤</li>
                        <li>‚Ä¢ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥ = +1 —Å—É–Ω–¥—É–∫</li>
                        <li>‚Ä¢ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è = +—Å—É–Ω–¥—É–∫–∏</li>
                    </ul>
                </div>
            </div>
        `;
    }
    
    getPetsTabContent() {
        const availablePets = [
            { name: '–ë–∞–∑–æ–≤—ã–π –õ–∞–±—É–±—É', rarity: 'common', emoji: 'üê∞', owned: true, description: '–í–∞—à –ø–µ—Ä–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü' },
            { name: '–ö–æ—Ç–µ–Ω–æ–∫ –õ–∞–±—É–±—É', rarity: 'rare', emoji: 'üê±', owned: this.unlockedSkins.includes('cat'), price: 2000, description: '–ú—è—É-–º—è—É!' },
            { name: '–î—Ä–∞–∫–æ–Ω—á–∏–∫ –õ–∞–±—É–±—É', rarity: 'epic', emoji: 'üêâ', owned: this.unlockedSkins.includes('dragon'), price: 5000, description: '–û–≥–Ω–µ–¥—ã—à–∞—â–∏–π!' },
            { name: '–ï–¥–∏–Ω–æ—Ä–æ–≥ –õ–∞–±—É–±—É', rarity: 'legendary', emoji: 'ü¶Ñ', owned: this.unlockedSkins.includes('unicorn'), price: 10000, description: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π!' },
            { name: '–†–æ–±–æ—Ç –õ–∞–±—É–±—É', rarity: 'epic', emoji: 'ü§ñ', owned: this.unlockedSkins.includes('robot'), price: 7500, description: '–ë—É–¥—É—â–µ–µ –∑–¥–µ—Å—å!' },
            { name: '–ê–Ω–≥–µ–ª –õ–∞–±—É–±—É', rarity: 'legendary', emoji: 'üëº', owned: this.unlockedSkins.includes('angel'), price: 15000, description: '–ù–µ–±–µ—Å–Ω—ã–π!' }
        ];

        const petGrid = availablePets.map((pet, index) => {
            const rarityColors = {
                common: 'bg-gray-100 border-gray-300',
                rare: 'bg-blue-100 border-blue-300',
                epic: 'bg-purple-100 border-purple-300',
                legendary: 'bg-yellow-100 border-yellow-300'
            };

            return `
                <div class="p-3 rounded-lg border-2 ${rarityColors[pet.rarity]} ${pet.owned ? 'opacity-100' : 'opacity-60'}">
                    <div class="text-center">
                        <div class="text-2xl mb-1">${pet.emoji}</div>
                        <div class="font-medium text-xs">${pet.name}</div>
                        <div class="text-xs text-gray-600 mt-1">${pet.description}</div>
                        ${pet.owned ? 
                            `<button onclick="game.selectPetSkin('${pet.name.toLowerCase().replace(' –ª–∞–±—É–±—É', '')}')" class="mt-2 bg-green-500 hover:bg-green-600 text-white px-2 py-1 rounded text-xs">
                                ${this.currentSkin === pet.name.toLowerCase().replace(' –ª–∞–±—É–±—É', '') ? '‚úÖ –í—ã–±—Ä–∞–Ω' : '–í—ã–±—Ä–∞—Ç—å'}
                            </button>` :
                            `<button onclick="game.buyPet('${pet.name.toLowerCase().replace(' –ª–∞–±—É–±—É', '')}', ${pet.price})" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs">
                                –ö—É–ø–∏—Ç—å ${pet.price}üí∞
                            </button>`
                        }
                    </div>
                </div>
            `;
        }).join('');

        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üê∞ –í–∞—à–∏ –ø–∏—Ç–æ–º—Ü—ã</h3>
                    <div class="text-xs text-gray-600 mb-3">–¢–µ–∫—É—â–∏–π –ø–∏—Ç–æ–º–µ—Ü: ${this.petName} (${this.currentSkin})</div>
                </div>
                
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-2 text-purple-800 text-sm">üõí –ú–∞–≥–∞–∑–∏–Ω –ø–∏—Ç–æ–º—Ü–µ–≤</h3>
                    <div class="grid grid-cols-2 gap-2">${petGrid}</div>
                </div>
                
                <div class="bg-white rounded-lg p-2 shadow">
                    <h4 class="font-bold mb-1 text-purple-800 text-xs">üåü –†–µ–¥–∫–æ—Å—Ç—å –ø–∏—Ç–æ–º—Ü–µ–≤:</h4>
                    <div class="grid grid-cols-2 gap-1 text-xs">
                        <div class="flex items-center"><div class="w-3 h-3 bg-gray-300 rounded mr-1"></div>–û–±—ã—á–Ω—ã–π</div>
                        <div class="flex items-center"><div class="w-3 h-3 bg-blue-300 rounded mr-1"></div>–†–µ–¥–∫–∏–π</div>
                        <div class="flex items-center"><div class="w-3 h-3 bg-purple-300 rounded mr-1"></div>–≠–ø–∏—á–µ—Å–∫–∏–π</div>
                        <div class="flex items-center"><div class="w-3 h-3 bg-yellow-300 rounded mr-1"></div>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</div>
                    </div>
                </div>
            </div>
        `;
    }
    
    getInfoTabContent() {
        return `
            <div class="space-y-3">
                <div class="bg-white rounded-lg p-3 shadow">
                    <h3 class="font-bold mb-3 text-purple-800 text-sm">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–µ</h3>
                    <div class="space-y-3 text-xs">
                        <div class="bg-blue-50 p-2 rounded">
                            <h4 class="font-bold text-blue-800 mb-1">üöÄ –ë—É–¥—É—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h4>
                            <p class="text-blue-700">–ë–æ—Ç –±—É–¥–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è! –û–∂–∏–¥–∞–π—Ç–µ:</p>
                            <ul class="list-disc list-inside text-blue-700 mt-1">
                                <li>–ù–æ–≤—ã–µ –º–∏–Ω–∏-–∏–≥—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</li>
                                <li>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∏–Ω—ã –∏ –æ–¥–µ–∂–¥–∞</li>
                                <li>–û—Å–æ–±—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏</li>
                                <li>–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —ç–≤–æ–ª—é—Ü–∏–∏</li>
                                <li>–ú–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π!</li>
                            </ul>
                        </div>
                        <div class="bg-green-50 p-2 rounded">
                            <h4 class="font-bold text-green-800 mb-1">üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h4>
                            <ul class="list-disc list-inside text-green-700">
                                <li>–ö–æ—Ä–º–∏—Ç–µ ${this.petName} –∫–æ–≥–¥–∞ –≥–æ–ª–æ–¥–µ–Ω</li>
                                <li>–ò–≥—Ä–∞–π—Ç–µ –≤ –º–∏–Ω–∏-–∏–≥—Ä—ã –¥–ª—è –æ–ø—ã—Ç–∞</li>
                                <li>–ü–æ–∫—É–ø–∞–π—Ç–µ –æ–¥–µ–∂–¥—É –∑–∞ –º–æ–Ω–µ—Ç—ã</li>
                                <li>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—Å–µ–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏</li>
                                <li>–í–∞—à –ø–∏—Ç–æ–º–µ—Ü —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º!</li>
                            </ul>
                        </div>
                        <div class="bg-purple-50 p-2 rounded">
                            <h4 class="font-bold text-purple-800 mb-1">‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</h4>
                            <ul class="list-disc list-inside text-purple-700">
                                <li>6 –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–∏–Ω–∏-–∏–≥—Ä</li>
                                <li>23 –≤–∏–¥–∞ –æ–¥–µ–∂–¥—ã –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤</li>
                                <li>6 —Ä–µ–¥–∫–∏—Ö —Å–∫–∏–Ω–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</li>
                                <li>5 —Å—Ç–∞–¥–∏–π —ç–≤–æ–ª—é—Ü–∏–∏</li>
                                <li>–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Å—Ç–∞—Ä–µ–Ω–∏–µ (1 –¥–µ–Ω—å = 1 –¥–µ–Ω—å)</li>
                                <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                                <li>–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</li>
                                <li>–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏</li>
                            </ul>
                        </div>
                        <div class="bg-orange-50 p-2 rounded">
                            <h4 class="font-bold text-orange-800 mb-1">‚è∞ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</h4>
                            <ul class="list-disc list-inside text-orange-700">
                                <li>üìâ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–¥–∞—é—Ç –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥</li>
                                <li>üò¥ –í–æ —Å–Ω–µ: —ç–Ω–µ—Ä–≥–∏—è +3, —Å–æ–Ω +4 –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫</li>
                                <li>üòä –ù–µ —Å–ø–∏—Ç: —ç–Ω–µ—Ä–≥–∏—è +0.5 –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫</li>
                                <li>‚è∞ –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–µ –≤ –∏–≥—Ä–µ!</li>
                                <li>üíæ –í—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ</li>
                                <li>üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö</li>
                            </ul>
                        </div>
                        <div class="bg-blue-50 p-2 rounded">
                            <h4 class="font-bold text-blue-800 mb-1">üõí –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫—É–ø–æ–∫</h4>
                            <ul class="list-disc list-inside text-blue-700">
                                <li>üëó –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –ø–æ–∫—É–ø–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑</li>
                                <li>üì¶ –ö—É–ø–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞</li>
                                <li>‚ú® –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–¥–µ–≤–∞—Ç—å—Å—è –º–µ–∂–¥—É –∫—É–ø–ª–µ–Ω–Ω—ã–º–∏</li>
                                <li>üí∞ –¶–µ–Ω–∞ –ø–ª–∞—Ç–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ</li>
                                <li>üíæ –í—Å–µ –ø–æ–∫—É–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è</li>
                            </ul>
                        </div>
                        <div class="bg-green-50 p-2 rounded">
                            <h4 class="font-bold text-green-800 mb-1">üìä –°—Ç–∞—Ç—É—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</h4>
                            <ul class="list-disc list-inside text-green-700">
                                <li>üíæ localStorage: –í—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω</li>
                                <li>üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ${this.telegramConnected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞ ‚úÖ' : '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ ‚ùå'}</li>
                                <li>üì± Telegram: ${this.telegramConnected ? `ID ${this.telegramChatId} ‚úÖ` : '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω ‚ùå'}</li>
                                <li>üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥</li>
                                <li>‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏</li>
                            </ul>
                        </div>
                        <div class="text-center text-gray-500">
                            <p>üê∞ –°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –¥–ª—è ${this.petName}! üíï</p>
                            <p class="text-xs mt-1">–í–µ—Ä—Å–∏—è 4.0 - Enhanced Real-Time System</p>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }
    
    // –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –ü–û–ö–£–ü–ö–ò –ê–ö–°–ï–°–°–£–ê–†–û–í
    buyOrWearOutfit(outfitKey) {
        const outfit = this.outfits[outfitKey];
        
        if (!outfit) {
            this.showMessage('‚ùå –ê–∫—Å–µ—Å—Å—É–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–∂–µ –ª–∏ –∫—É–ø–∏–ª–∏ —ç—Ç–æ—Ç –∞–∫—Å–µ—Å—Å—É–∞—Ä
        if (this.ownedOutfits.includes(outfitKey)) {
            // –£–∂–µ –∫—É–ø–ª–µ–Ω - –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–µ–≤–∞–µ–º
            this.outfit = outfitKey;
            this.stats.happiness = Math.min(100, this.stats.happiness + 5);
            this.showMessage(`üëó –ù–∞–¥–µ—Ç–æ: ${outfit.name} ${outfit.emoji}!`);
        } else {
            // –ï—â–µ –Ω–µ –∫—É–ø–ª–µ–Ω - –ø–æ–∫—É–ø–∞–µ–º
            if (this.money >= outfit.price) {
                this.money -= outfit.price;
                this.ownedOutfits.push(outfitKey); // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö
                this.outfit = outfitKey; // –°—Ä–∞–∑—É –Ω–∞–¥–µ–≤–∞–µ–º
                this.stats.happiness = Math.min(100, this.stats.happiness + 20);
                this.showMessage(`üõí –ö—É–ø–ª–µ–Ω–æ –∏ –Ω–∞–¥–µ—Ç–æ: ${outfit.name} ${outfit.emoji}!`);
            } else {
                this.showMessage('üí∞ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
                return;
            }
        }
        
        this.saveData();
        this.updateDisplay();
        this.switchTab('shop'); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
    }
    
    // –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—É–Ω–¥—É–∫–æ–≤
    openChest(rarity) {
        const chestCosts = {
            common: 1,
            rare: 3,
            epic: 5,
            legendary: 10
        };
        
        const cost = chestCosts[rarity];
        
        if (this.chestCount >= cost) {
            this.chestCount -= cost;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–≥—Ä–∞–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–¥–∫–æ—Å—Ç–∏
            let reward = { money: 0, items: [] };
            
            switch (rarity) {
                case 'common':
                    reward.money = Math.floor(Math.random() * 40) + 10; // 10-50
                    break;
                case 'rare':
                    reward.money = Math.floor(Math.random() * 150) + 50; // 50-200
                    reward.items.push('–†–µ–¥–∫–∞—è –æ–¥–µ–∂–¥–∞');
                    break;
                case 'epic':
                    reward.money = Math.floor(Math.random() * 300) + 200; // 200-500
                    reward.items.push('–≠–ø–∏—á–µ—Å–∫–∏–π —Å–∫–∏–Ω');
                    // –®–∞–Ω—Å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–∫–∏–Ω
                    if (Math.random() > 0.5 && !this.unlockedSkins.includes('golden')) {
                        this.unlockedSkins.push('golden');
                        reward.items.push('üéâ –ó–æ–ª–æ—Ç–æ–π —Å–∫–∏–Ω —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!');
                    }
                    break;
                case 'legendary':
                    reward.money = Math.floor(Math.random() * 500) + 500; // 500-1000
                    reward.items.push('–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç');
                    // –®–∞–Ω—Å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π
                    if (Math.random() > 0.3) {
                        ['golden', 'rainbow'].forEach(skin => {
                            if (!this.unlockedSkins.includes(skin)) {
                                this.unlockedSkins.push(skin);
                                reward.items.push(`üéâ ${skin} —Å–∫–∏–Ω —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!`);
                            }
                        });
                    }
                    break;
            }
            
            this.money += reward.money;
            
            let message = `üéÅ –°—É–Ω–¥—É–∫ –æ—Ç–∫—Ä—ã—Ç! +${reward.money} –º–æ–Ω–µ—Ç`;
            if (reward.items.length > 0) {
                message += `, ${reward.items.join(', ')}`;
            }
            
            this.showMessage(message);
            this.saveData();
            this.updateDisplay();
            this.switchTab('chests'); // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∫–ª–∞–¥–∫—É
        } else {
            this.showMessage(`–ù—É–∂–Ω–æ ${cost} —Å—É–Ω–¥—É–∫${cost > 1 ? (cost < 5 ? '–∞' : '–æ–≤') : ''}!`);
        }
    }
    
    // –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
    feedPet(foodIndex) {
        if (this.isSleeping) {
            this.showMessage(`${this.petName} —Å–ø–∏—Ç! üò¥`);
            return;
        }
        
        const food = this.food[foodIndex];
        if (this.money >= food.price) {
            this.money -= food.price;
            this.stats.hunger = Math.min(100, this.stats.hunger + (food.hunger || 0));
            this.stats.happiness = Math.min(100, this.stats.happiness + (food.happiness || 0));
            this.stats.health = Math.min(100, this.stats.health + (food.health || 0));
            this.stats.energy = Math.min(100, this.stats.energy + (food.energy || 0));
            this.stats.cleanliness = Math.min(100, this.stats.cleanliness + (food.cleanliness || 0));
            
            // –ë–æ–ª—å—à–∏–π –±–æ–Ω—É—Å —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç –µ–¥—ã
            if (!food.energy) {
                this.stats.energy = Math.min(100, this.stats.energy + 10); // –£–≤–µ–ª–∏—á–µ–Ω –±–æ–Ω—É—Å —ç–Ω–µ—Ä–≥–∏–∏
            }
            
            this.experience += 10;
            
            this.playSound(800, 150);
            this.showMessage(`${this.petName} —Å—ä–µ–ª ${food.name}! ${food.emoji}`);
            this.checkLevelUp();
            this.saveData();
            this.updateDisplay();
        } else {
            this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
        }
    }
    
    washPet() {
        if (this.isSleeping) {
            this.showMessage(`–ù–µ –±—É–¥–∏ —Å–ø—è—â–µ–≥–æ ${this.petName}! üò¥`);
            return;
        }
        
        this.stats.cleanliness = 100;
        this.stats.happiness = Math.min(100, this.stats.happiness + 10);
        this.experience += 8;
        
        this.playSound(400, 200);
        this.showMessage(`${this.petName} —á–∏—Å—Ç—ã–π –∏ —Å—á–∞—Å—Ç–ª–∏–≤—ã–π! üõÅ`);
        this.checkLevelUp();
        this.saveData();
        this.updateDisplay();
    }
    
    healPet() {
        if (this.money >= 30) {
            this.money -= 30;
            this.stats.health = 100;
            this.stats.happiness = Math.min(100, this.stats.happiness + 5);
            this.experience += 12;
            
            this.showMessage(`${this.petName} –∑–¥–æ—Ä–æ–≤! üíä`);
            this.checkLevelUp();
            this.saveData();
            this.updateDisplay();
        } else {
            this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ª–µ—á–µ–Ω–∏—è!');
        }
    }
    
    toggleSleep() {
        this.isSleeping = !this.isSleeping;
        
        if (this.isSleeping) {
            this.playSound(300, 500);
            this.showMessage(`üò¥ ${this.petName} –ª–æ–∂–∏—Ç—Å—è —Å–ø–∞—Ç—å... –≠–Ω–µ—Ä–≥–∏—è –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ!`);
        } else {
            this.playHappySound();
            this.showMessage(`üòä ${this.petName} –ø—Ä–æ—Å–Ω—É–ª—Å—è! –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–µ–µ.`);
        }
        
        this.saveData();
        this.updateDisplay();
        this.switchTab('care');
    }
    
    startMiniGame(gameIndex) {
        if (this.isSleeping) {
            this.showMessage(`${this.petName} —Å–ø–∏—Ç! –†–∞–∑–±—É–¥–∏ –µ–≥–æ —Å–Ω–∞—á–∞–ª–∞! üò¥`);
            return;
        }
        if (this.stats.energy < 15) {
            this.showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏! –ù—É–∂–Ω–æ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å.');
            return;
        }
        
        this.currentMiniGame = this.miniGames[gameIndex];
        this.showMiniGameModal();
    }
    
    showMiniGameModal() {
        document.getElementById('gameTitle').textContent = `${this.currentMiniGame.name} ${this.currentMiniGame.emoji}`;
        document.getElementById('gameContent').innerHTML = this.getMiniGameContent();
        document.getElementById('miniGameModal').classList.remove('hidden');
    }
    
    closeMiniGame() {
        document.getElementById('miniGameModal').classList.add('hidden');
        this.currentMiniGame = null;
    }
    
    getMiniGameContent() {
        // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä
        return `
            <div class="text-center">
                <p class="mb-4">${this.currentMiniGame.description}</p>
                <p class="text-sm text-gray-600 mb-4">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å!</p>
                <button onclick="game.completeMiniGame(${Math.random() > 0.3})" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold transition-colors">
                    –ò–≥—Ä–∞—Ç—å!
                </button>
            </div>
        `;
    }
    
    completeMiniGame(success = null) {
        if (success === null) {
            success = Math.random() > 0.3; // 70% —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞
        }
        
        if (success && this.currentMiniGame) {
            const reward = this.currentMiniGame.reward;
            this.stats.happiness = Math.min(100, this.stats.happiness + (reward.happiness || 0));
            this.stats.energy = Math.max(0, this.stats.energy - 15);
            this.experience += reward.experience || 0;
            this.money += reward.money || 0;
            
            this.playHappySound();
            this.showMessage(`–û—Ç–ª–∏—á–Ω–æ! +${reward.experience} –æ–ø—ã—Ç–∞, +${reward.money} –º–æ–Ω–µ—Ç!`);
        } else {
            this.stats.energy = Math.max(0, this.stats.energy - 10);
            this.playSound(200, 300);
            this.showMessage('–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!');
        }
        
        this.checkLevelUp();
        this.saveData();
        this.updateDisplay();
        this.closeMiniGame();
    }
    
    checkLevelUp() {
        const newLevel = Math.floor(this.experience / 100) + 1;
        if (newLevel > this.level) {
            this.level = newLevel;
            this.money += 50;
            this.playHappySound();
            this.showMessage('üéâ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! +50 –º–æ–Ω–µ—Ç!');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–Ω–¥—É–∫–æ–≤ –∑–∞ —É—Ä–æ–≤–Ω–∏
            this.checkChestReward();
        }
    }
    
    checkChestReward() {
        const chestsEarned = Math.floor(this.level / 10);
        const chestsToAdd = chestsEarned - Math.floor(this.lastChestLevel / 10);
        
        if (chestsToAdd > 0) {
            this.chestCount += chestsToAdd;
            this.lastChestLevel = this.level;
            this.showMessage(`üéÅ –ü–æ–ª—É—á–µ–Ω${chestsToAdd > 1 ? '–æ' : ''} ${chestsToAdd} —Å—É–Ω–¥—É–∫${chestsToAdd > 1 ? '–∞' : ''}!`);
            this.saveData();
        }
    }
    
    checkNotifications() {
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ stats
        if (!this.stats || typeof this.stats !== 'object') {
            return;
        }
        
        if (this.stats.happiness < 50) {
            this.showNotification(`üò¢ ${this.petName}: –ú–Ω–µ —Å–∫—É—á–Ω–æ! –ü–æ–∏–≥—Ä–∞–π —Å–æ –º–Ω–æ–π!`, 'sad');
        }
        if (this.stats.sleep < 50) {
            this.showNotification(`üò¥ ${this.petName}: –Ø —Ö–æ—á—É —Å–ø–∞—Ç—å! –£–ª–æ–∂–∏ –º–µ–Ω—è –≤ –∫—Ä–æ–≤–∞—Ç–∫—É!`, 'sleepy');
        }
        if (this.stats.hunger < 50) {
            this.showNotification(`üçΩÔ∏è ${this.petName}: –Ø –≥–æ–ª–æ–¥–µ–Ω! –ü–æ–∫–æ—Ä–º–∏ –º–µ–Ω—è —á–µ–º-–Ω–∏–±—É–¥—å –≤–∫—É—Å–Ω—ã–º!`, 'hungry');
        }
        if (this.stats.cleanliness < 50) {
            this.showNotification(`üõÅ ${this.petName}: –Ø –≥—Ä—è–∑–Ω—ã–π! –ü–æ–º–æ–π –º–µ–Ω—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞!`, 'dirty');
        }
        if (this.stats.health < 50) {
            this.showNotification(`üíä ${this.petName}: –ú–Ω–µ –ø–ª–æ—Ö–æ! –í—ã–ª–µ—á–∏ –º–µ–Ω—è!`, 'sick');
        }
        if (this.stats.energy < 30) {
            this.showNotification(`‚ö° ${this.petName}: –£ –º–µ–Ω—è –º–∞–ª–æ —ç–Ω–µ—Ä–≥–∏–∏! –î–∞–π –º–Ω–µ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å!`, 'tired');
        }
    }
    
    checkEvolution() {
        const currentStage = Object.entries(this.evolutionStages)
            .reverse()
            .find(([_, stage]) => this.age >= stage.minAge)?.[0] || 'baby';
        
        if (currentStage !== this.evolutionStage) {
            this.evolutionStage = currentStage;
            this.playHappySound();
            this.showMessage(`üéâ –≠–≤–æ–ª—é—Ü–∏—è! –¢–µ–ø–µ—Ä—å ${this.evolutionStages[currentStage].name}!`);
        }
    }
    
    startGameLoop() {
        setInterval(() => {
            const now = Date.now();
            const timeDiff = Math.floor((now - this.lastUpdate) / 1000);
            
            // –°—Ç–∞—Ä–µ–Ω–∏–µ: 1 —Ä–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å = 1 –¥–µ–Ω—å –ø–∏—Ç–æ–º—Ü–∞ (86400 —Å–µ–∫—É–Ω–¥ = 1 –¥–µ–Ω—å)
            if (timeDiff >= 86400) {
                const daysToAdd = Math.floor(timeDiff / 86400);
                this.age += daysToAdd;
                this.checkEvolution();
                this.lastUpdate = now;
                this.saveData();
                this.updateDisplay();
            }
        }, 60000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
    }
    
    startNotificationTimer() {
        setInterval(() => {
            const now = Date.now();
            const timeSinceLastNotification = now - this.lastNotification;
            
            // 30 –º–∏–Ω—É—Ç = 1800000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
            if (timeSinceLastNotification >= 1800000) {
                this.showNotification(`üí≠ ${this.petName}: –¢—ã –Ω–µ –∑–∞–±—ã–ª –æ–±–æ –º–Ω–µ? –Ø —Å–∫—É—á–∞—é!`, 'reminder');
                this.lastNotification = now;
                localStorage.setItem('shared_labubu_last_notification', now.toString());
            }
        }, 60000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
    }
    
    showNotification(message, type) {
        const notification = {
            id: Date.now(),
            message,
            type,
            timestamp: Date.now()
        };
        
        this.notifications.push(notification);
        
        const notificationEl = document.createElement('div');
        notificationEl.className = `p-3 rounded-lg shadow-lg text-white text-sm max-w-xs notification-enter ${this.getNotificationColor(type)}`;
        notificationEl.textContent = message;
        
        document.getElementById('notifications').appendChild(notificationEl);
        
        setTimeout(() => {
            notificationEl.classList.add('notification-exit');
            setTimeout(() => {
                if (notificationEl.parentNode) {
                    notificationEl.parentNode.removeChild(notificationEl);
                }
            }, 300);
            this.notifications = this.notifications.filter(n => n.id !== notification.id);
        }, 5000);
    }
    
    getNotificationColor(type) {
        const colors = {
            reminder: 'bg-blue-500',
            sad: 'bg-red-500',
            sleepy: 'bg-purple-500',
            hungry: 'bg-orange-500',
            dirty: 'bg-blue-600',
            sick: 'bg-red-600',
            tired: 'bg-yellow-500'
        };
        return colors[type] || 'bg-gray-500';
    }
    
    generateUserId() {
        return 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
    }
    
    async saveToDatabaseAsync() {
        try {
            // –ï—Å–ª–∏ Telegram –ø–æ–¥–∫–ª—é—á–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î
            if (this.telegramConnected && this.telegramChatId) {
                const gameData = {
                    gameUserId: this.gameUserId,
                    petName: this.petName,
                    stats: this.stats,
                    level: this.level,
                    experience: this.experience,
                    money: this.money,
                    age: this.age,
                    outfit: this.outfit,
                    currentSkin: this.currentSkin,
                    unlockedSkins: this.unlockedSkins,
                    evolutionStage: this.evolutionStage,
                    chestCount: this.chestCount,
                    friendsInvited: this.friendsInvited,
                    lastChestLevel: this.lastChestLevel,
                    isSleeping: this.isSleeping,
                    lastUpdate: this.lastUpdate,
                    lastStatDecay: this.lastStatDecay
                };
                
                const response = await fetch('https://labubu-server.onrender.com/api/save-game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(gameData)
                });
                
                if (response.ok) {
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î');
                    return true;
                } else {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î:', response.status);
                    return false;
                }
            }
            return false;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:', error);
            return false;
        }
    }
    
    async loadFromDatabaseSync() {
        try {
            // –ï—Å–ª–∏ Telegram –ø–æ–¥–∫–ª—é—á–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –ë–î
            if (this.telegramConnected && this.telegramChatId) {
                const response = await fetch(`https://labubu-server.onrender.com/api/load-game/${this.gameUserId}`);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.gameData) {
                        const gameData = data.gameData;
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
                        this.petName = gameData.petName || 'Labubu';
                        this.stats = gameData.stats || {
                            hunger: 100, happiness: 100, cleanliness: 100,
                            health: 100, energy: 100, sleep: 100
                        };
                        this.level = gameData.level || 1;
                        this.experience = gameData.experience || 0;
                        this.money = gameData.money || 100;
                        this.age = gameData.age || 0;
                        this.outfit = gameData.outfit || 'default';
                        this.currentSkin = gameData.currentSkin || 'default';
                        this.unlockedSkins = gameData.unlockedSkins || ['default'];
                        this.evolutionStage = gameData.evolutionStage || 'baby';
                        this.chestCount = gameData.chestCount || 0;
                        this.friendsInvited = gameData.friendsInvited || 0;
                        this.lastChestLevel = gameData.lastChestLevel || 0;
                        this.isSleeping = gameData.isSleeping || false;
                        this.lastUpdate = gameData.lastUpdate || Date.now();
                        this.lastStatDecay = gameData.lastStatDecay || Date.now();
                        
                        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –ë–î');
                        return true;
                    }
                }
            }
            return false;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ –ë–î:', error);
            return false;
        }
    }
    
    async loadFromDatabaseAsync() {
        // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î
        return await this.loadFromDatabaseSync();
    }
}

// –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
let game;
document.addEventListener('DOMContentLoaded', () => {
    console.log('üöÄ DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...');
    game = new LabubuCareGame();
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        if (game) {
            console.log('üîÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è...');
            game.updateDisplay();
        }
    }, 2000);
});
</script>

</body>
</html>
